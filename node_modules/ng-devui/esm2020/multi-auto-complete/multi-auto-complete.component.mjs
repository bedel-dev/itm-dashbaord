import { __decorate, __metadata } from "tslib";
import { ChangeDetectorRef, Component, ElementRef, EventEmitter, forwardRef, Input, Output, TemplateRef, ViewChild } from '@angular/core';
import { NG_VALUE_ACCESSOR } from '@angular/forms';
import { AutoCompleteDirective } from 'ng-devui/auto-complete';
import { addClassToOrigin, DevConfigService, removeClassFromOrigin, WithConfig } from 'ng-devui/utils';
import { of } from 'rxjs';
import * as i0 from "@angular/core";
import * as i1 from "ng-devui/utils";
import * as i2 from "ng-devui/tags";
import * as i3 from "@angular/common";
import * as i4 from "@angular/forms";
import * as i5 from "ng-devui/auto-complete";
export class MultiAutoCompleteComponent {
    constructor(changeDetectorRef, devConfigService) {
        this.changeDetectorRef = changeDetectorRef;
        this.devConfigService = devConfigService;
        this.appendToBody = false;
        this.appendToBodyDirections = ['rightDown', 'leftDown', 'rightUp', 'leftUp'];
        /**
         * @deprecated
         * overview: border none multiline single
         */
        this.overview = 'border';
        this.placeholder = ''; // placeholder
        this.disabled = false;
        this.showAnimation = true;
        this.autoSubmit = new EventEmitter(); // 失焦自动提交
        this.multiItems = [];
        this.multipleLabelClassNameSuffix = this.overview;
        this.inputEdit = false;
        this.multipleLabelClassNameConfig = {
            border: {
                focus: 'border',
                blur: 'border',
            },
            none: {
                focus: 'border',
                blur: 'none',
            },
            multiline: {
                focus: 'multiline',
                blur: 'multiline',
            },
            single: {
                focus: 'single-focus',
                blur: 'single',
            },
        };
        this.clonePlaceholder = this.placeholder;
        this.placement = 'bottom-left';
        this.onChange = (_) => null;
        this.onTouched = () => null;
        this.formatter = (item) => (item ? item.label || item.toString() : '');
        this.valueParser = (item) => item;
        this.id = MultiAutoCompleteComponent.ID_SEED++;
    }
    get placeholderView() {
        if (this.multiItems.length > 0) {
            return '';
        }
        else {
            return this.placeholder;
        }
    }
    writeValue(obj) {
        const value = obj || [];
        this.multiItems = value;
        if (this.overview === 'single') {
            this.inputEdit = this.multiItems.length === 0;
        }
        this.setSinglePlaceholder();
        this.changeDetectorRef.markForCheck();
    }
    ngOnInit() {
        if (this.source && !this.searchFn) {
            this.searchFn = (term) => {
                return of(this.source.filter((lang) => this.multiItems.indexOf(lang) === -1 && lang.toLowerCase().indexOf(term.toLowerCase()) !== -1));
            };
        }
    }
    ngOnChanges(changes) {
        if (changes && changes['overview']) {
            this.multipleLabelClassNameSuffix = changes['overview'].currentValue;
        }
        if (changes && changes['placeholder']) {
            this.clonePlaceholder = changes['placeholder'].currentValue;
        }
    }
    registerOnChange(fn) {
        this.onChange = fn;
    }
    registerOnTouched(fn) {
        this.onTouched = fn;
    }
    singleClick($event) {
        this.inputEdit = true;
    }
    onMultipleSearch(item) {
        if (this.overview !== 'single' && item) {
            let inArray = false;
            for (let i = 0; i < this.multiItems.length; i++) {
                if (item.label) {
                    if (item.label === this.multiItems[i].label) {
                        inArray = true;
                        break;
                    }
                }
                else {
                    if (item === this.multiItems[i]) {
                        inArray = true;
                        break;
                    }
                }
            }
            if (!inArray) {
                this.multiItems.push(item);
            }
            else {
                this.multiItems = this.multiItems.filter((data) => {
                    if (data.label) {
                        return data.label !== item.label;
                    }
                    else {
                        return data !== item;
                    }
                });
            }
        }
        else if (this.overview === 'single' && item) {
            this.multiItems = [];
            this.multiItems.push(item);
            this.inputEdit = false;
            this.multipleLabelClassNameSuffix = this.multipleLabelClassNameConfig[this.overview]['blur'];
        }
        this.setSinglePlaceholder();
        this.autoSubmit.emit(this.multiItems);
        this.onChange(this.multiItems);
        this.inputValue = null;
        this.multiAutoCompleteInputElement.nativeElement.value = '';
    }
    removeLabel(label) {
        if (this.multiItems.indexOf(label) !== -1) {
            this.multiItems = this.multiItems.filter((item) => item !== label);
        }
        this.setSinglePlaceholder();
        this.autoSubmit.emit(this.multiItems);
        this.onChange(this.multiItems);
    }
    getInputFocusFlag($event) {
        this.inputEdit = this.multiItems.length === 0 || $event.focus;
        this.popupRef = $event.popupRef;
        this.setSinglePlaceholder();
        if ($event.focus) {
            this.multipleLabelClassNameSuffix = this.multipleLabelClassNameConfig[this.overview]['focus'];
            setTimeout(() => {
                // 这里需要等待一会才能聚焦
                this.multiAutoCompleteInputElement.nativeElement.focus();
            }, 0);
        }
        else {
            this.multipleLabelClassNameSuffix = this.multipleLabelClassNameConfig[this.overview]['blur'];
            this.inputValue = null;
            this.multiAutoCompleteInputElement.nativeElement.value = '';
            this.autoSubmit.emit(this.multiItems);
        }
    }
    onBackspaceKeyUp($event, inputValue) {
        if (this.multiItems.length > 0 && !inputValue) {
            this.multiItems.pop();
        }
        this.setSinglePlaceholder();
        this.autoSubmit.emit(this.multiItems);
        this.onChange(this.multiItems);
    }
    setSinglePlaceholder() {
        if (this.overview === 'single') {
            if (this.multiItems && this.multiItems.length > 0) {
                this.placeholder = '';
            }
            else {
                this.placeholder = this.clonePlaceholder;
            }
        }
    }
    changePopUp(open) {
        if (open) {
            addClassToOrigin(this.multiAutoCompleteWrapperElement);
        }
        else {
            removeClassFromOrigin(this.multiAutoCompleteWrapperElement);
        }
    }
    inputBlur() {
        this.onTouched();
    }
}
MultiAutoCompleteComponent.ID_SEED = 0;
MultiAutoCompleteComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "13.1.3", ngImport: i0, type: MultiAutoCompleteComponent, deps: [{ token: i0.ChangeDetectorRef }, { token: i1.DevConfigService }], target: i0.ɵɵFactoryTarget.Component });
MultiAutoCompleteComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "13.1.3", type: MultiAutoCompleteComponent, selector: "d-multi-auto-complete", inputs: { appendToBody: "appendToBody", appendToBodyDirections: "appendToBodyDirections", cssClass: "cssClass", overview: "overview", tipsText: "tipsText", placeholder: "placeholder", disabled: "disabled", source: "source", latestSource: "latestSource", disabledKey: "disabledKey", width: "width", itemTemplate: "itemTemplate", noResultItemTemplate: "noResultItemTemplate", delay: "delay", searchFn: "searchFn", formatter: "formatter", valueParser: "valueParser", showAnimation: "showAnimation" }, outputs: { autoSubmit: "autoSubmit" }, providers: [
        {
            provide: NG_VALUE_ACCESSOR,
            useExisting: forwardRef(() => MultiAutoCompleteComponent),
            multi: true,
        },
    ], viewQueries: [{ propertyName: "multiAutoCompleteInputElement", first: true, predicate: ["multiAutoCompleteInput"], descendants: true }, { propertyName: "multiAutoCompleteWrapperElement", first: true, predicate: ["multiAutoCompleteWrapper"], descendants: true }, { propertyName: "autoCompleteDirective", first: true, predicate: AutoCompleteDirective, descendants: true }], usesOnChanges: true, ngImport: i0, template: "<div class=\"form-group multi-auto-complete\">\n  <label\n    for=\"multiple-label-auto-complete-{{ id }}\"\n    class=\"multiple-label-auto-complete multiple-label-auto-complete-{{ multipleLabelClassNameSuffix }}\"\n    [ngClass]=\"{ 'multiple-label-auto-complete-disabled': disabled }\"\n  >\n    <ul *ngIf=\"overview !== 'single'\" class=\"devui-dropdown-origin\" #multiAutoCompleteWrapper>\n      <li *ngFor=\"let item of multiItems\">\n        <ng-template\n          [ngTemplateOutlet]=\"disabled || (overview === 'none' && !inputEdit) ? transparentTemplate : defaultTemplate\"\n          [ngTemplateOutletContext]=\"{\n            item: item,\n            formatter: formatter,\n            parent: multiItems\n          }\"\n        ></ng-template>\n      </li>\n      <li *ngIf=\"!disabled\">\n        <input\n          #multiAutoCompleteInput\n          id=\"multiple-label-auto-complete-{{ id }}\"\n          type=\"text\"\n          name=\"autoCompleteControl\"\n          class=\"auto-complete-control\"\n          [placeholder]=\"placeholderView\"\n          [tipsText]=\"tipsText\"\n          [latestSource]=\"latestSource\"\n          (selectValue)=\"onMultipleSearch($event)\"\n          (transInputFocusEmit)=\"getInputFocusFlag($event)\"\n          (keydown.backspace)=\"onBackspaceKeyUp($event, inputValue)\"\n          [formatter]=\"formatter\"\n          [valueParser]=\"valueParser\"\n          [itemTemplate]=\"itemTemplate\"\n          [noResultItemTemplate]=\"noResultItemTemplate\"\n          [cssClass]=\"cssClass\"\n          [overview]=\"overview\"\n          [disabled]=\"disabled\"\n          [(ngModel)]=\"inputValue\"\n          [delay]=\"delay\"\n          [dAutoCompleteWidth]=\"width\"\n          dAutoComplete\n          [showAnimation]=\"showAnimation\"\n          [searchFn]=\"searchFn\"\n          [appendToBody]=\"appendToBody\"\n          [appendToBodyDirections]=\"appendToBodyDirections\"\n          [cdkOverlayOffsetY]=\"3\"\n          [disabledKey]=\"disabledKey\"\n          (blur)=\"inputBlur()\"\n          (changeDropDownStatus)=\"changePopUp($event)\"\n        />\n      </li>\n    </ul>\n\n    <!--\u5355\u9009\u6A21\u677F-->\n    <ul *ngIf=\"overview === 'single'\" title=\"{{ formatter(multiItems[0]) }}\" (click)=\"singleClick($event)\">\n      <li *ngFor=\"let item of multiItems\">\n        <ng-template\n          [ngTemplateOutlet]=\"transparentTemplate\"\n          [ngTemplateOutletContext]=\"{\n            item: item,\n            formatter: formatter,\n            parent: multiItems\n          }\"\n        ></ng-template>\n      </li>\n      <li *ngIf=\"!disabled && inputEdit\">\n        <input\n          #multiAutoCompleteInput\n          id=\"multiple-label-auto-complete-{{ id }}\"\n          type=\"text\"\n          name=\"autoCompleteControl\"\n          class=\"auto-complete-control\"\n          [placeholder]=\"placeholder\"\n          [tipsText]=\"tipsText\"\n          [latestSource]=\"latestSource\"\n          (selectValue)=\"onMultipleSearch($event)\"\n          (transInputFocusEmit)=\"getInputFocusFlag($event)\"\n          (keydown.backspace)=\"onBackspaceKeyUp($event, inputValue)\"\n          [formatter]=\"formatter\"\n          [valueParser]=\"valueParser\"\n          [itemTemplate]=\"itemTemplate\"\n          [noResultItemTemplate]=\"noResultItemTemplate\"\n          [cssClass]=\"cssClass\"\n          [overview]=\"overview\"\n          [disabled]=\"disabled\"\n          [(ngModel)]=\"inputValue\"\n          [delay]=\"delay\"\n          [dAutoCompleteWidth]=\"width\"\n          dAutoComplete\n          [searchFn]=\"searchFn\"\n          (blur)=\"inputBlur()\"\n          (changeDropDownStatus)=\"changePopUp($event)\"\n        />\n      </li>\n    </ul>\n  </label>\n</div>\n\n<!--\u9EC4\u5E95\u6A21\u677F-->\n<ng-template #defaultTemplate let-item=\"item\" let-formatter=\"formatter\">\n  <d-tag [deletable]=\"true\" [tag]=\"formatter(item)\" (tagDelete)=\"removeLabel(item)\"></d-tag>\n</ng-template>\n\n<!--\u65E0\u5E95\u8272\u6A21\u677F-->\n<ng-template #transparentTemplate let-item=\"item\" let-formatter=\"formatter\" let-parent=\"parent\">\n  <d-tag [tag]=\"formatter(item)\"></d-tag>\n</ng-template>\n", styles: [".devui-font-size-base{font-size:12px;font-size:var(--devui-font-size, 12px)}.devui-font-base{font-size:12px;font-size:var(--devui-font-size, 12px);font-weight:400;line-height:1.5}.devui-font-size-modal-title{font-size:18px;font-size:var(--devui-font-size-modal-title, 18px)}.devui-font-modal-title{font-size:18px;font-size:var(--devui-font-size-modal-title, 18px);font-weight:700;line-height:1.5}.devui-font-size-page-title{font-size:16px;font-size:var(--devui-font-size-page-title, 16px)}.devui-font-page-title{font-size:16px;font-size:var(--devui-font-size-page-title, 16px);font-weight:700;line-height:1.5}.devui-font-size-secondary-title{font-size:14px;font-size:var(--devui-font-size-card-title, 14px)}.devui-font-secondary-title{font-size:14px;font-size:var(--devui-font-size-card-title, 14px);font-weight:700;line-height:1.5}.form-group label{cursor:pointer;font-size:12px;font-size:var(--devui-font-size, 12px);margin-bottom:0;width:100%}.multiple-label-auto-complete{padding:0;font-weight:400}.multiple-label-auto-complete ul{display:flex;flex-wrap:wrap;align-items:center;list-style:none;background:#ffffff;background:var(--devui-base-bg, #ffffff);border-radius:2px;border-radius:var(--devui-border-radius, 2px);padding:4px 4px 0}.multiple-label-auto-complete-single ul,.multiple-label-auto-complete-single-focus ul,.multiple-label-auto-complete-border ul,.multiple-label-auto-complete-multiline ul{border:1px solid #d7d8da;border:1px solid var(--devui-line, #d7d8da)}.multiple-label-auto-complete-single ul:hover,.multiple-label-auto-complete-single-focus ul:hover,.multiple-label-auto-complete-border ul:hover,.multiple-label-auto-complete-multiline ul:hover{border-color:#9b9fa8;border-color:var(--devui-form-control-line-hover, #9b9fa8)}.multiple-label-auto-complete-single ul:active,.multiple-label-auto-complete-single-focus ul:active,.multiple-label-auto-complete-border ul:active,.multiple-label-auto-complete-multiline ul:active{border-color:#5e7ce0;border-color:var(--devui-form-control-line-active, #5e7ce0)}.multiple-label-auto-complete-single ul,.multiple-label-auto-complete-single-focus ul{overflow:hidden}.multiple-label-auto-complete-multiline ul{height:60px;overflow:auto}.multiple-label-auto-complete-none ul{border:1px solid transparent}.multiple-label-auto-complete-none ul:hover,.multiple-label-auto-complete-none ul:active{border-color:transparent}.multiple-label-auto-complete:not(.multiple-label-auto-complete-disabled) ul li:last-child{border-color:transparent}.multiple-label-auto-complete.multiple-label-auto-complete-disabled ul{cursor:not-allowed}.multiple-label-auto-complete.multiple-label-auto-complete-disabled ul,.multiple-label-auto-complete.multiple-label-auto-complete-disabled ul:hover{border-color:#dfe1e6;border-color:var(--devui-disabled-line, #dfe1e6);background-color:#f5f5f5;background-color:var(--devui-disabled-bg, #f5f5f5)}.multiple-label-auto-complete.multiple-label-auto-complete-disabled ul li{border-color:#dfe1e6;border-color:var(--devui-disabled-line, #dfe1e6)}.multiple-label-auto-complete.multiple-label-auto-complete-disabled ul li .label-text,.multiple-label-auto-complete.multiple-label-auto-complete-disabled ul li .label-text:hover{background-color:#f5f5f5;background-color:var(--devui-disabled-bg, #f5f5f5);color:#cfd0d3;color:var(--devui-disabled-text, #cfd0d3)}.multiple-label-auto-complete ul::-ms-expand{border:0;background-color:transparent}::-ms-clear,::-ms-reveal{display:none}.multiple-label-auto-complete ul li{position:relative;display:inline-block;line-height:1;margin:0 4px 4px 0}.multiple-label-auto-complete-none ul li{margin-right:0}.multiple-label-auto-complete-single ul li,.multiple-label-auto-complete-single-focus ul li,.multiple-label-auto-complete-multiline ul li{position:static}.multiple-label-auto-complete-single ul li,.multiple-label-auto-complete-single-focus ul li{float:left;width:100%}.multiple-label-auto-complete-single-focus ul li:first-child{max-width:calc(100% - 5px);margin-right:0;width:auto}.multiple-label-auto-complete-single-focus ul li:last-child{width:5px;margin-right:0;margin-left:0}.multiple-label-auto-complete ul li .label-close,.multiple-label-auto-complete ul li .label-text{font-size:12px;font-size:var(--devui-font-size, 12px);line-height:20px;padding:0 8px;color:#575d6c;color:var(--devui-text-weak, #575d6c);font-weight:400;background-color:#e9edfa;background-color:var(--devui-label-bg, #e9edfa)}.multiple-label-auto-complete ul li .label-close{padding-left:4px;display:flex;align-items:center}.multiple-label-auto-complete ul li .label-close svg rect{fill:#d7d8da;fill:var(--devui-line, #d7d8da)}.multiple-label-auto-complete ul li .label-close svg path{fill:#fff;fill:var(--devui-light-text, #ffffff)}.multiple-label-auto-complete ul li .label-close:hover svg rect{fill:#252b3a;fill:var(--devui-icon-fill-active-hover, #252b3a)}.multiple-label-auto-complete ul li .label-text:hover{color:#252b3a;color:var(--devui-icon-fill-active-hover, #252b3a)}.multiple-label-auto-complete ul li .label-text{border-radius:2px 0 0 2px;border-radius:var(--devui-border-radius, 2px) 0 0 var(--devui-border-radius, 2px)}.multiple-label-auto-complete ul li .label-close{cursor:pointer;border-radius:0 2px 2px 0;border-radius:0 var(--devui-border-radius, 2px) var(--devui-border-radius, 2px) 0}.multiple-label-auto-complete-single ul li .label-text,.multiple-label-auto-complete-single-focus ul li .label-text,.multiple-label-auto-complete-none ul li .label-text{background-color:transparent}.multiple-label-auto-complete-single ul li .label-text{width:100%;text-align:left;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;display:block;height:20px;line-height:20px}.multiple-label-auto-complete-single-focus ul li .label-text{width:100%;text-align:left;display:block;height:20px;line-height:20px}.multiple-label-auto-complete .auto-complete-control{min-width:160px;height:20px;border:none;outline:none;background:#ffffff;background:var(--devui-base-bg, #ffffff);color:#252b3a;color:var(--devui-text, #252b3a)}.multiple-label-auto-complete .auto-complete-control:focus,.multiple-label-auto-complete .auto-complete-control:hover{border:none;outline:none}.multiple-label-auto-complete-none .auto-complete-control{width:0}:host label{color:inherit}:host ::ng-deep .multiple-label-auto-complete-disabled li{border:solid 1px #dfe1e6;border:solid 1px var(--devui-disabled-line, #dfe1e6);border-radius:2px;border-radius:var(--devui-border-radius, 2px)}:host ::ng-deep .multiple-label-auto-complete-disabled li d-tag .devui-tag-item{background-color:#f5f5f5;background-color:var(--devui-disabled-bg, #f5f5f5);color:#cfd0d3;color:var(--devui-disabled-text, #cfd0d3);cursor:not-allowed}:host ::ng-deep .multiple-label-auto-complete-border ul li .devui-dropdown-menu{margin-top:8px}:host ::ng-deep .multiple-label-auto-complete-multiline ul li .devui-dropdown-menu{margin-top:0;width:170px}:host-context(d-data-table) .multiple-label-auto-complete-single ul,:host-context(d-data-table) .multiple-label-auto-complete-single ul li .auto-complete-control{border-color:transparent;background-color:transparent}:host-context(d-data-table) .multiple-label-auto-complete-single ul{padding-left:0}\n"], components: [{ type: i2.TagComponent, selector: "d-tag", inputs: ["tag", "labelStyle", "customColor", "deletable", "titleContent", "mode", "checked", "maxWidth", "customViewTemplate"], outputs: ["tagDelete", "checkedChange"], exportAs: ["Tag"] }], directives: [{ type: i3.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { type: i3.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { type: i3.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { type: i3.NgTemplateOutlet, selector: "[ngTemplateOutlet]", inputs: ["ngTemplateOutletContext", "ngTemplateOutlet"] }, { type: i4.DefaultValueAccessor, selector: "input:not([type=checkbox])[formControlName],textarea[formControlName],input:not([type=checkbox])[formControl],textarea[formControl],input:not([type=checkbox])[ngModel],textarea[ngModel],[ngDefaultControl]" }, { type: i5.AutoCompleteDirective, selector: "[dAutoComplete]", inputs: ["disabled", "cssClass", "delay", "minLength", "itemTemplate", "noResultItemTemplate", "searchingTemplate", "isSearching", "appendToBody", "appendToBodyDirections", "cdkOverlayOffsetY", "dAutoCompleteWidth", "formatter", "sceneType", "tipsText", "overview", "latestSource", "source", "valueParser", "searchFn", "dropdown", "maxHeight", "disabledKey", "showAnimation", "enableLazyLoad", "allowEmptyValueSearch"], outputs: ["loadMore", "selectValue", "transInputFocusEmit", "changeDropDownStatus", "toggleChange"], exportAs: ["autoComplete"] }, { type: i4.NgControlStatus, selector: "[formControlName],[ngModel],[formControl]" }, { type: i4.NgModel, selector: "[ngModel]:not([formControlName]):not([formControl])", inputs: ["name", "disabled", "ngModel", "ngModelOptions"], outputs: ["ngModelChange"], exportAs: ["ngModel"] }] });
__decorate([
    WithConfig(),
    __metadata("design:type", Object)
], MultiAutoCompleteComponent.prototype, "showAnimation", void 0);
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "13.1.3", ngImport: i0, type: MultiAutoCompleteComponent, decorators: [{
            type: Component,
            args: [{ selector: 'd-multi-auto-complete', providers: [
                        {
                            provide: NG_VALUE_ACCESSOR,
                            useExisting: forwardRef(() => MultiAutoCompleteComponent),
                            multi: true,
                        },
                    ], preserveWhitespaces: false, template: "<div class=\"form-group multi-auto-complete\">\n  <label\n    for=\"multiple-label-auto-complete-{{ id }}\"\n    class=\"multiple-label-auto-complete multiple-label-auto-complete-{{ multipleLabelClassNameSuffix }}\"\n    [ngClass]=\"{ 'multiple-label-auto-complete-disabled': disabled }\"\n  >\n    <ul *ngIf=\"overview !== 'single'\" class=\"devui-dropdown-origin\" #multiAutoCompleteWrapper>\n      <li *ngFor=\"let item of multiItems\">\n        <ng-template\n          [ngTemplateOutlet]=\"disabled || (overview === 'none' && !inputEdit) ? transparentTemplate : defaultTemplate\"\n          [ngTemplateOutletContext]=\"{\n            item: item,\n            formatter: formatter,\n            parent: multiItems\n          }\"\n        ></ng-template>\n      </li>\n      <li *ngIf=\"!disabled\">\n        <input\n          #multiAutoCompleteInput\n          id=\"multiple-label-auto-complete-{{ id }}\"\n          type=\"text\"\n          name=\"autoCompleteControl\"\n          class=\"auto-complete-control\"\n          [placeholder]=\"placeholderView\"\n          [tipsText]=\"tipsText\"\n          [latestSource]=\"latestSource\"\n          (selectValue)=\"onMultipleSearch($event)\"\n          (transInputFocusEmit)=\"getInputFocusFlag($event)\"\n          (keydown.backspace)=\"onBackspaceKeyUp($event, inputValue)\"\n          [formatter]=\"formatter\"\n          [valueParser]=\"valueParser\"\n          [itemTemplate]=\"itemTemplate\"\n          [noResultItemTemplate]=\"noResultItemTemplate\"\n          [cssClass]=\"cssClass\"\n          [overview]=\"overview\"\n          [disabled]=\"disabled\"\n          [(ngModel)]=\"inputValue\"\n          [delay]=\"delay\"\n          [dAutoCompleteWidth]=\"width\"\n          dAutoComplete\n          [showAnimation]=\"showAnimation\"\n          [searchFn]=\"searchFn\"\n          [appendToBody]=\"appendToBody\"\n          [appendToBodyDirections]=\"appendToBodyDirections\"\n          [cdkOverlayOffsetY]=\"3\"\n          [disabledKey]=\"disabledKey\"\n          (blur)=\"inputBlur()\"\n          (changeDropDownStatus)=\"changePopUp($event)\"\n        />\n      </li>\n    </ul>\n\n    <!--\u5355\u9009\u6A21\u677F-->\n    <ul *ngIf=\"overview === 'single'\" title=\"{{ formatter(multiItems[0]) }}\" (click)=\"singleClick($event)\">\n      <li *ngFor=\"let item of multiItems\">\n        <ng-template\n          [ngTemplateOutlet]=\"transparentTemplate\"\n          [ngTemplateOutletContext]=\"{\n            item: item,\n            formatter: formatter,\n            parent: multiItems\n          }\"\n        ></ng-template>\n      </li>\n      <li *ngIf=\"!disabled && inputEdit\">\n        <input\n          #multiAutoCompleteInput\n          id=\"multiple-label-auto-complete-{{ id }}\"\n          type=\"text\"\n          name=\"autoCompleteControl\"\n          class=\"auto-complete-control\"\n          [placeholder]=\"placeholder\"\n          [tipsText]=\"tipsText\"\n          [latestSource]=\"latestSource\"\n          (selectValue)=\"onMultipleSearch($event)\"\n          (transInputFocusEmit)=\"getInputFocusFlag($event)\"\n          (keydown.backspace)=\"onBackspaceKeyUp($event, inputValue)\"\n          [formatter]=\"formatter\"\n          [valueParser]=\"valueParser\"\n          [itemTemplate]=\"itemTemplate\"\n          [noResultItemTemplate]=\"noResultItemTemplate\"\n          [cssClass]=\"cssClass\"\n          [overview]=\"overview\"\n          [disabled]=\"disabled\"\n          [(ngModel)]=\"inputValue\"\n          [delay]=\"delay\"\n          [dAutoCompleteWidth]=\"width\"\n          dAutoComplete\n          [searchFn]=\"searchFn\"\n          (blur)=\"inputBlur()\"\n          (changeDropDownStatus)=\"changePopUp($event)\"\n        />\n      </li>\n    </ul>\n  </label>\n</div>\n\n<!--\u9EC4\u5E95\u6A21\u677F-->\n<ng-template #defaultTemplate let-item=\"item\" let-formatter=\"formatter\">\n  <d-tag [deletable]=\"true\" [tag]=\"formatter(item)\" (tagDelete)=\"removeLabel(item)\"></d-tag>\n</ng-template>\n\n<!--\u65E0\u5E95\u8272\u6A21\u677F-->\n<ng-template #transparentTemplate let-item=\"item\" let-formatter=\"formatter\" let-parent=\"parent\">\n  <d-tag [tag]=\"formatter(item)\"></d-tag>\n</ng-template>\n", styles: [".devui-font-size-base{font-size:12px;font-size:var(--devui-font-size, 12px)}.devui-font-base{font-size:12px;font-size:var(--devui-font-size, 12px);font-weight:400;line-height:1.5}.devui-font-size-modal-title{font-size:18px;font-size:var(--devui-font-size-modal-title, 18px)}.devui-font-modal-title{font-size:18px;font-size:var(--devui-font-size-modal-title, 18px);font-weight:700;line-height:1.5}.devui-font-size-page-title{font-size:16px;font-size:var(--devui-font-size-page-title, 16px)}.devui-font-page-title{font-size:16px;font-size:var(--devui-font-size-page-title, 16px);font-weight:700;line-height:1.5}.devui-font-size-secondary-title{font-size:14px;font-size:var(--devui-font-size-card-title, 14px)}.devui-font-secondary-title{font-size:14px;font-size:var(--devui-font-size-card-title, 14px);font-weight:700;line-height:1.5}.form-group label{cursor:pointer;font-size:12px;font-size:var(--devui-font-size, 12px);margin-bottom:0;width:100%}.multiple-label-auto-complete{padding:0;font-weight:400}.multiple-label-auto-complete ul{display:flex;flex-wrap:wrap;align-items:center;list-style:none;background:#ffffff;background:var(--devui-base-bg, #ffffff);border-radius:2px;border-radius:var(--devui-border-radius, 2px);padding:4px 4px 0}.multiple-label-auto-complete-single ul,.multiple-label-auto-complete-single-focus ul,.multiple-label-auto-complete-border ul,.multiple-label-auto-complete-multiline ul{border:1px solid #d7d8da;border:1px solid var(--devui-line, #d7d8da)}.multiple-label-auto-complete-single ul:hover,.multiple-label-auto-complete-single-focus ul:hover,.multiple-label-auto-complete-border ul:hover,.multiple-label-auto-complete-multiline ul:hover{border-color:#9b9fa8;border-color:var(--devui-form-control-line-hover, #9b9fa8)}.multiple-label-auto-complete-single ul:active,.multiple-label-auto-complete-single-focus ul:active,.multiple-label-auto-complete-border ul:active,.multiple-label-auto-complete-multiline ul:active{border-color:#5e7ce0;border-color:var(--devui-form-control-line-active, #5e7ce0)}.multiple-label-auto-complete-single ul,.multiple-label-auto-complete-single-focus ul{overflow:hidden}.multiple-label-auto-complete-multiline ul{height:60px;overflow:auto}.multiple-label-auto-complete-none ul{border:1px solid transparent}.multiple-label-auto-complete-none ul:hover,.multiple-label-auto-complete-none ul:active{border-color:transparent}.multiple-label-auto-complete:not(.multiple-label-auto-complete-disabled) ul li:last-child{border-color:transparent}.multiple-label-auto-complete.multiple-label-auto-complete-disabled ul{cursor:not-allowed}.multiple-label-auto-complete.multiple-label-auto-complete-disabled ul,.multiple-label-auto-complete.multiple-label-auto-complete-disabled ul:hover{border-color:#dfe1e6;border-color:var(--devui-disabled-line, #dfe1e6);background-color:#f5f5f5;background-color:var(--devui-disabled-bg, #f5f5f5)}.multiple-label-auto-complete.multiple-label-auto-complete-disabled ul li{border-color:#dfe1e6;border-color:var(--devui-disabled-line, #dfe1e6)}.multiple-label-auto-complete.multiple-label-auto-complete-disabled ul li .label-text,.multiple-label-auto-complete.multiple-label-auto-complete-disabled ul li .label-text:hover{background-color:#f5f5f5;background-color:var(--devui-disabled-bg, #f5f5f5);color:#cfd0d3;color:var(--devui-disabled-text, #cfd0d3)}.multiple-label-auto-complete ul::-ms-expand{border:0;background-color:transparent}::-ms-clear,::-ms-reveal{display:none}.multiple-label-auto-complete ul li{position:relative;display:inline-block;line-height:1;margin:0 4px 4px 0}.multiple-label-auto-complete-none ul li{margin-right:0}.multiple-label-auto-complete-single ul li,.multiple-label-auto-complete-single-focus ul li,.multiple-label-auto-complete-multiline ul li{position:static}.multiple-label-auto-complete-single ul li,.multiple-label-auto-complete-single-focus ul li{float:left;width:100%}.multiple-label-auto-complete-single-focus ul li:first-child{max-width:calc(100% - 5px);margin-right:0;width:auto}.multiple-label-auto-complete-single-focus ul li:last-child{width:5px;margin-right:0;margin-left:0}.multiple-label-auto-complete ul li .label-close,.multiple-label-auto-complete ul li .label-text{font-size:12px;font-size:var(--devui-font-size, 12px);line-height:20px;padding:0 8px;color:#575d6c;color:var(--devui-text-weak, #575d6c);font-weight:400;background-color:#e9edfa;background-color:var(--devui-label-bg, #e9edfa)}.multiple-label-auto-complete ul li .label-close{padding-left:4px;display:flex;align-items:center}.multiple-label-auto-complete ul li .label-close svg rect{fill:#d7d8da;fill:var(--devui-line, #d7d8da)}.multiple-label-auto-complete ul li .label-close svg path{fill:#fff;fill:var(--devui-light-text, #ffffff)}.multiple-label-auto-complete ul li .label-close:hover svg rect{fill:#252b3a;fill:var(--devui-icon-fill-active-hover, #252b3a)}.multiple-label-auto-complete ul li .label-text:hover{color:#252b3a;color:var(--devui-icon-fill-active-hover, #252b3a)}.multiple-label-auto-complete ul li .label-text{border-radius:2px 0 0 2px;border-radius:var(--devui-border-radius, 2px) 0 0 var(--devui-border-radius, 2px)}.multiple-label-auto-complete ul li .label-close{cursor:pointer;border-radius:0 2px 2px 0;border-radius:0 var(--devui-border-radius, 2px) var(--devui-border-radius, 2px) 0}.multiple-label-auto-complete-single ul li .label-text,.multiple-label-auto-complete-single-focus ul li .label-text,.multiple-label-auto-complete-none ul li .label-text{background-color:transparent}.multiple-label-auto-complete-single ul li .label-text{width:100%;text-align:left;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;display:block;height:20px;line-height:20px}.multiple-label-auto-complete-single-focus ul li .label-text{width:100%;text-align:left;display:block;height:20px;line-height:20px}.multiple-label-auto-complete .auto-complete-control{min-width:160px;height:20px;border:none;outline:none;background:#ffffff;background:var(--devui-base-bg, #ffffff);color:#252b3a;color:var(--devui-text, #252b3a)}.multiple-label-auto-complete .auto-complete-control:focus,.multiple-label-auto-complete .auto-complete-control:hover{border:none;outline:none}.multiple-label-auto-complete-none .auto-complete-control{width:0}:host label{color:inherit}:host ::ng-deep .multiple-label-auto-complete-disabled li{border:solid 1px #dfe1e6;border:solid 1px var(--devui-disabled-line, #dfe1e6);border-radius:2px;border-radius:var(--devui-border-radius, 2px)}:host ::ng-deep .multiple-label-auto-complete-disabled li d-tag .devui-tag-item{background-color:#f5f5f5;background-color:var(--devui-disabled-bg, #f5f5f5);color:#cfd0d3;color:var(--devui-disabled-text, #cfd0d3);cursor:not-allowed}:host ::ng-deep .multiple-label-auto-complete-border ul li .devui-dropdown-menu{margin-top:8px}:host ::ng-deep .multiple-label-auto-complete-multiline ul li .devui-dropdown-menu{margin-top:0;width:170px}:host-context(d-data-table) .multiple-label-auto-complete-single ul,:host-context(d-data-table) .multiple-label-auto-complete-single ul li .auto-complete-control{border-color:transparent;background-color:transparent}:host-context(d-data-table) .multiple-label-auto-complete-single ul{padding-left:0}\n"] }]
        }], ctorParameters: function () { return [{ type: i0.ChangeDetectorRef }, { type: i1.DevConfigService }]; }, propDecorators: { appendToBody: [{
                type: Input
            }], appendToBodyDirections: [{
                type: Input
            }], cssClass: [{
                type: Input
            }], overview: [{
                type: Input
            }], tipsText: [{
                type: Input
            }], placeholder: [{
                type: Input
            }], disabled: [{
                type: Input
            }], source: [{
                type: Input
            }], latestSource: [{
                type: Input
            }], disabledKey: [{
                type: Input
            }], width: [{
                type: Input
            }], itemTemplate: [{
                type: Input
            }], noResultItemTemplate: [{
                type: Input
            }], delay: [{
                type: Input
            }], searchFn: [{
                type: Input
            }], formatter: [{
                type: Input
            }], valueParser: [{
                type: Input
            }], showAnimation: [{
                type: Input
            }], autoSubmit: [{
                type: Output
            }], multiAutoCompleteInputElement: [{
                type: ViewChild,
                args: ['multiAutoCompleteInput']
            }], multiAutoCompleteWrapperElement: [{
                type: ViewChild,
                args: ['multiAutoCompleteWrapper']
            }], autoCompleteDirective: [{
                type: ViewChild,
                args: [AutoCompleteDirective]
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibXVsdGktYXV0by1jb21wbGV0ZS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9kZXZ1aS9tdWx0aS1hdXRvLWNvbXBsZXRlL211bHRpLWF1dG8tY29tcGxldGUuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vZGV2dWkvbXVsdGktYXV0by1jb21wbGV0ZS9tdWx0aS1hdXRvLWNvbXBsZXRlLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFDQSxPQUFPLEVBQ0wsaUJBQWlCLEVBQ2pCLFNBQVMsRUFFVCxVQUFVLEVBQ1YsWUFBWSxFQUNaLFVBQVUsRUFDVixLQUFLLEVBR0wsTUFBTSxFQUVOLFdBQVcsRUFDWCxTQUFTLEVBQ1YsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUF3QixpQkFBaUIsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ3pFLE9BQU8sRUFBRSxxQkFBcUIsRUFBOEIsTUFBTSx3QkFBd0IsQ0FBQztBQUMzRixPQUFPLEVBQUUsZ0JBQWdCLEVBQXlCLGdCQUFnQixFQUFFLHFCQUFxQixFQUFFLFVBQVUsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQzlILE9BQU8sRUFBYyxFQUFFLEVBQUUsTUFBTSxNQUFNLENBQUM7Ozs7Ozs7QUFldEMsTUFBTSxPQUFPLDBCQUEwQjtJQTJFckMsWUFBb0IsaUJBQW9DLEVBQVUsZ0JBQWtDO1FBQWhGLHNCQUFpQixHQUFqQixpQkFBaUIsQ0FBbUI7UUFBVSxxQkFBZ0IsR0FBaEIsZ0JBQWdCLENBQWtCO1FBekUzRixpQkFBWSxHQUFHLEtBQUssQ0FBQztRQUNyQiwyQkFBc0IsR0FBcUQsQ0FBQyxXQUFXLEVBQUUsVUFBVSxFQUFFLFNBQVMsRUFBRSxRQUFRLENBQUMsQ0FBQztRQUtuSTs7O1dBR0c7UUFDTSxhQUFRLEdBQUcsUUFBUSxDQUFDO1FBRXBCLGdCQUFXLEdBQUcsRUFBRSxDQUFDLENBQUMsY0FBYztRQUNoQyxhQUFRLEdBQUcsS0FB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QywwQkFBMEIsQ0FBQztZQUN6RCxLQUFLLEVBQUUsSUFBSTtTQUNaO0tBQ0YseVVBc0NVLHFCQUFxQixxRUNyRWxDLGtuSUEyR0E7QUQzQ3lCO0lBQWIsVUFBVSxFQUFFOztpRUFBc0I7MkZBOUJqQywwQkFBMEI7a0JBYnRDLFNBQVM7K0JBQ0UsdUJBQXVCLGFBR3RCO3dCQUNUOzRCQUNFLE9BQU8sRUFBRSxpQkFBaUI7NEJBQzFCLFdBQVcsRUFBRSxVQUFVLENBQUMsR0FBRyxFQUFFLDJCQUEyQixDQUFDOzRCQUN6RCxLQUFLLEVBQUUsSUFBSTt5QkFDWjtxQkFDRix1QkFDb0IsS0FBSzt1SUFJakIsWUFBWTtzQkFBcEIsS0FBSztnQkFDRyxzQkFBc0I7c0JBQTlCLEtBQUs7Z0JBSUcsUUFBUTtzQkFBaEIsS0FBSztnQkFLRyxRQUFRO3NCQUFoQixLQUFLO2dCQUNHLFFBQVE7c0JBQWhCLEtBQUs7Z0JBQ0csV0FBVztzQkFBbkIsS0FBSztnQkFDRyxRQUFRO3NCQUFoQixLQUFLO2dCQUNHLE1BQU07c0JBQWQsS0FBSztnQkFDRyxZQUFZO3NCQUFwQixLQUFLO2dCQUNHLFdBQVc7c0JBQW5CLEtBQUs7Z0JBQ0csS0FBSztzQkFBYixLQUFLO2dCQUdHLFlBQVk7c0JBQXBCLEtBQUs7Z0JBQ0csb0JBQW9CO3NCQUE1QixLQUFLO2dCQUdHLEtBQUs7c0JBQWIsS0FBSztnQkFDRyxRQUFRO3NCQUFoQixLQUFLO2dCQUNHLFNBQVM7c0JBQWpCLEtBQUs7Z0JBQ0csV0FBVztzQkFBbkIsS0FBSztnQkFDaUIsYUFBYTtzQkFBbkMsS0FBSztnQkFDSSxVQUFVO3NCQUFuQixNQUFNO2dCQUU4Qiw2QkFBNkI7c0JBQWpFLFNBQVM7dUJBQUMsd0JBQXdCO2dCQUNJLCtCQUErQjtzQkFBckUsU0FBUzt1QkFBQywwQkFBMEI7Z0JBQ0gscUJBQXFCO3NCQUF0RCxTQUFTO3VCQUFDLHFCQUFxQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbm5lY3RlZFBvc2l0aW9uIH0gZnJvbSAnQGFuZ3VsYXIvY2RrL292ZXJsYXknO1xuaW1wb3J0IHtcbiAgQ2hhbmdlRGV0ZWN0b3JSZWYsXG4gIENvbXBvbmVudCxcbiAgQ29tcG9uZW50UmVmLFxuICBFbGVtZW50UmVmLFxuICBFdmVudEVtaXR0ZXIsXG4gIGZvcndhcmRSZWYsXG4gIElucHV0LFxuICBPbkNoYW5nZXMsXG4gIE9uSW5pdCxcbiAgT3V0cHV0LFxuICBTaW1wbGVDaGFuZ2VzLFxuICBUZW1wbGF0ZVJlZixcbiAgVmlld0NoaWxkXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQ29udHJvbFZhbHVlQWNjZXNzb3IsIE5HX1ZBTFVFX0FDQ0VTU09SIH0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xuaW1wb3J0IHsgQXV0b0NvbXBsZXRlRGlyZWN0aXZlLCBBdXRvQ29tcGxldGVQb3B1cENvbXBvbmVudCB9IGZyb20gJ25nLWRldnVpL2F1dG8tY29tcGxldGUnO1xuaW1wb3J0IHsgYWRkQ2xhc3NUb09yaWdpbiwgQXBwZW5kVG9Cb2R5RGlyZWN0aW9uLCBEZXZDb25maWdTZXJ2aWNlLCByZW1vdmVDbGFzc0Zyb21PcmlnaW4sIFdpdGhDb25maWcgfSBmcm9tICduZy1kZXZ1aS91dGlscyc7XG5pbXBvcnQgeyBPYnNlcnZhYmxlLCBvZiB9IGZyb20gJ3J4anMnO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdkLW11bHRpLWF1dG8tY29tcGxldGUnLFxuICB0ZW1wbGF0ZVVybDogJy4vbXVsdGktYXV0by1jb21wbGV0ZS5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWydtdWx0aS1hdXRvLWNvbXBsZXRlLmNvbXBvbmVudC5zY3NzJ10sXG4gIHByb3ZpZGVyczogW1xuICAgIHtcbiAgICAgIHByb3ZpZGU6IE5HX1ZBTFVFX0FDQ0VTU09SLFxuICAgICAgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gTXVsdGlBdXRvQ29tcGxldGVDb21wb25lbnQpLFxuICAgICAgbXVsdGk6IHRydWUsXG4gICAgfSxcbiAgXSxcbiAgcHJlc2VydmVXaGl0ZXNwYWNlczogZmFsc2UsXG59KVxuZXhwb3J0IGNsYXNzIE11bHRpQXV0b0NvbXBsZXRlQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkNoYW5nZXMsIENvbnRyb2xWYWx1ZUFjY2Vzc29yIHtcbiAgc3RhdGljIElEX1NFRUQgPSAwO1xuICBASW5wdXQoKSBhcHBlbmRUb0JvZHkgPSBmYWxzZTtcbiAgQElucHV0KCkgYXBwZW5kVG9Cb2R5RGlyZWN0aW9uczogQXJyYXk8QXBwZW5kVG9Cb2R5RGlyZWN0aW9uIHwgQ29ubmVjdGVkUG9zaXRpb24+ID0gWydyaWdodERvd24nLCAnbGVmdERvd24nLCAncmlnaHRVcCcsICdsZWZ0VXAnXTtcbiAgLyoqXG4gICAqIEBkZXByZWNhdGVkXG4gICAqL1xuICBASW5wdXQoKSBjc3NDbGFzczogc3RyaW5nO1xuICAvKipcbiAgICogQGRlcHJlY2F0ZWRcbiAgICogb3ZlcnZpZXc6IGJvcmRlciBub25lIG11bHRpbGluZSBzaW5nbGVcbiAgICovXG4gIEBJbnB1dCgpIG92ZXJ2aWV3ID0gJ2JvcmRlcic7XG4gIEBJbnB1dCgpIHRpcHNUZXh0OiBzdHJpbmc7IC8vIOaPkOekuuaWh+Wtl1xuICBASW5wdXQoKSBwbGFjZWhvbGRlciA9ICcnOyAvLyBwbGFjZWhvbGRlclxuICBASW5wdXQoKSBkaXNhYmxlZCA9IGZhbHNlO1xuICBASW5wdXQoKSBzb3VyY2U6IGFueVtdO1xuICBASW5wdXQoKSBsYXRlc3RTb3VyY2U6IGFueVtdOyAvLyDmnIDov5HovpPlhaVcbiAgQElucHV0KCkgZGlzYWJsZWRLZXk6IHN0cmluZzsgLy8g5Y2V5Liq6YCJ6aG556aB55SoXG4gIEBJbnB1dCgpIHdpZHRoOiBudW1iZXI7XG4gIC8vIEBJbnB1dCgpIGlzT3BlbjogYm9vbGVhbjsgICAvLyDmnKrkvb/nlKhcbiAgLy8gQElucHV0KCkgdGVybTogc3RyaW5nOyAvLyDmnKrkvb/nlKhcbiAgQElucHV0KCkgaXRlbVRlbXBsYXRlOiBUZW1wbGF0ZVJlZjxhbnk+O1xuICBASW5wdXQoKSBub1Jlc3VsdEl0ZW1UZW1wbGF0ZTogVGVtcGxhdGVSZWY8YW55PjtcbiAgLy8gQElucHV0KCkgZHJvcGRvd246IGJvb2xlYW47IC8vIOacquS9v+eUqFxuICAvLyBASW5wdXQoKSBtaW5MZW5ndGg6IG51bWJlcjsgLy8g5pyq5L2/55SoXG4gIEBJbnB1dCgpIGRlbGF5OiBudW1iZXI7XG4gIEBJbnB1dCgpIHNlYXJjaEZuOiAodGVybTogc3RyaW5nKSA9PiBPYnNlcnZhYmxlPGFueVtdPjtcbiAgQElucHV0KCkgZm9ybWF0dGVyOiAoaXRlbTogYW55KSA9PiBzdHJpbmc7XG4gIEBJbnB1dCgpIHZhbHVlUGFyc2VyOiAoaXRlbTogYW55KSA9PiBhbnk7XG4gIEBJbnB1dCgpIEBXaXRoQ29uZmlnKCkgc2hvd0FuaW1hdGlvbiA9IHRydWU7XG4gIEBPdXRwdXQoKSBhdXRvU3VibWl0ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7IC8vIOWkseeEpuiHquWKqOaPkOS6pFxuXG4gIEBWaWV3Q2hpbGQoJ211bHRpQXV0b0NvbXBsZXRlSW5wdXQnKSBtdWx0aUF1dG9Db21wbGV0ZUlucHV0RWxlbWVudDogRWxlbWVudFJlZjtcbiAgQFZpZXdDaGlsZCgnbXVsdGlBdXRvQ29tcGxldGVXcmFwcGVyJykgbXVsdGlBdXRvQ29tcGxldGVXcmFwcGVyRWxlbWVudDogRWxlbWVudFJlZjtcbiAgQFZpZXdDaGlsZChBdXRvQ29tcGxldGVEaXJlY3RpdmUpIGF1dG9Db21wbGV0ZURpcmVjdGl2ZTogQXV0b0NvbXBsZXRlRGlyZWN0aXZlO1xuICBtdWx0aUl0ZW1zOiBhbnlbXSA9IFtdO1xuICBpbnB1dFZhbHVlOiBhbnk7XG4gIG11bHRpcGxlTGFiZWxDbGFzc05hbWVTdWZmaXg6IHN0cmluZyA9IHRoaXMub3ZlcnZpZXc7XG4gIGlucHV0RWRpdCA9IGZhbHNlO1xuICBtdWx0aXBsZUxhYmVsQ2xhc3NOYW1lQ29uZmlnOiBhbnkgPSB7XG4gICAgYm9yZGVyOiB7XG4gICAgICBmb2N1czogJ2JvcmRlcicsXG4gICAgICBibHVyOiAnYm9yZGVyJyxcbiAgICB9LFxuICAgIG5vbmU6IHtcbiAgICAgIGZvY3VzOiAnYm9yZGVyJyxcbiAgICAgIGJsdXI6ICdub25lJyxcbiAgICB9LFxuICAgIG11bHRpbGluZToge1xuICAgICAgZm9jdXM6ICdtdWx0aWxpbmUnLFxuICAgICAgYmx1cjogJ211bHRpbGluZScsXG4gICAgfSxcbiAgICBzaW5nbGU6IHtcbiAgICAgIGZvY3VzOiAnc2luZ2xlLWZvY3VzJyxcbiAgICAgIGJsdXI6ICdzaW5nbGUnLFxuICAgIH0sXG4gIH07XG4gIGlkOiBudW1iZXI7XG4gIGNsb25lUGxhY2Vob2xkZXI6IHN0cmluZyA9IHRoaXMucGxhY2Vob2xkZXI7XG4gIGdldCBwbGFjZWhvbGRlclZpZXcoKSB7XG4gICAgaWYgKHRoaXMubXVsdGlJdGVtcy5sZW5ndGggPiAwKSB7XG4gICAgICByZXR1cm4gJyc7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLnBsYWNlaG9sZGVyO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgcG9wdXBSZWY6IENvbXBvbmVudFJlZjxBdXRvQ29tcGxldGVQb3B1cENvbXBvbmVudD47XG4gIHByaXZhdGUgdmFsdWU6IGFueTtcbiAgcHJpdmF0ZSBwbGFjZW1lbnQgPSAnYm90dG9tLWxlZnQnO1xuXG4gIHByaXZhdGUgb25DaGFuZ2UgPSAoXzogYW55KSA9PiBudWxsO1xuICBwcml2YXRlIG9uVG91Y2hlZCA9ICgpID0+IG51bGw7XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSBjaGFuZ2VEZXRlY3RvclJlZjogQ2hhbmdlRGV0ZWN0b3JSZWYsIHByaXZhdGUgZGV2Q29uZmlnU2VydmljZTogRGV2Q29uZmlnU2VydmljZSkge1xuICAgIHRoaXMuZm9ybWF0dGVyID0gKGl0ZW0pID0+IChpdGVtID8gaXRlbS5sYWJlbCB8fCBpdGVtLnRvU3RyaW5nKCkgOiAnJyk7XG4gICAgdGhpcy52YWx1ZVBhcnNlciA9IChpdGVtKSA9PiBpdGVtO1xuICAgIHRoaXMuaWQgPSBNdWx0aUF1dG9Db21wbGV0ZUNvbXBvbmVudC5JRF9TRUVEKys7XG4gIH1cblxuICB3cml0ZVZhbHVlKG9iajogYW55KTogdm9pZCB7XG4gICAgY29uc3QgdmFsdWUgPSBvYmogfHwgW107XG4gICAgdGhpcy5tdWx0aUl0ZW1zID0gdmFsdWU7XG4gICAgaWYgKHRoaXMub3ZlcnZpZXcgPT09ICdzaW5nbGUnKSB7XG4gICAgICB0aGlzLmlucHV0RWRpdCA9IHRoaXMubXVsdGlJdGVtcy5sZW5ndGggPT09IDA7XG4gICAgfVxuICAgIHRoaXMuc2V0U2luZ2xlUGxhY2Vob2xkZXIoKTtcbiAgICB0aGlzLmNoYW5nZURldGVjdG9yUmVmLm1hcmtGb3JDaGVjaygpO1xuICB9XG5cbiAgbmdPbkluaXQoKSB7XG4gICAgaWYgKHRoaXMuc291cmNlICYmICF0aGlzLnNlYXJjaEZuKSB7XG4gICAgICB0aGlzLnNlYXJjaEZuID0gKHRlcm0pID0+IHtcbiAgICAgICAgcmV0dXJuIG9mKFxuICAgICAgICAgIHRoaXMuc291cmNlLmZpbHRlcigobGFuZykgPT4gdGhpcy5tdWx0aUl0ZW1zLmluZGV4T2YobGFuZykgPT09IC0xICYmIGxhbmcudG9Mb3dlckNhc2UoKS5pbmRleE9mKHRlcm0udG9Mb3dlckNhc2UoKSkgIT09IC0xKVxuICAgICAgICApO1xuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKSB7XG4gICAgaWYgKGNoYW5nZXMgJiYgY2hhbmdlc1snb3ZlcnZpZXcnXSkge1xuICAgICAgdGhpcy5tdWx0aXBsZUxhYmVsQ2xhc3NOYW1lU3VmZml4ID0gY2hhbmdlc1snb3ZlcnZpZXcnXS5jdXJyZW50VmFsdWU7XG4gICAgfVxuICAgIGlmIChjaGFuZ2VzICYmIGNoYW5nZXNbJ3BsYWNlaG9sZGVyJ10pIHtcbiAgICAgIHRoaXMuY2xvbmVQbGFjZWhvbGRlciA9IGNoYW5nZXNbJ3BsYWNlaG9sZGVyJ10uY3VycmVudFZhbHVlO1xuICAgIH1cbiAgfVxuXG4gIHJlZ2lzdGVyT25DaGFuZ2UoZm46IGFueSk6IHZvaWQge1xuICAgIHRoaXMub25DaGFuZ2UgPSBmbjtcbiAgfVxuXG4gIHJlZ2lzdGVyT25Ub3VjaGVkKGZuOiBhbnkpOiB2b2lkIHtcbiAgICB0aGlzLm9uVG91Y2hlZCA9IGZuO1xuICB9XG5cbiAgc2luZ2xlQ2xpY2soJGV2ZW50OiBhbnkpIHtcbiAgICB0aGlzLmlucHV0RWRpdCA9IHRydWU7XG4gIH1cblxuICBvbk11bHRpcGxlU2VhcmNoKGl0ZW0/OiBhbnkpIHtcbiAgICBpZiAodGhpcy5vdmVydmlldyAhPT0gJ3NpbmdsZScgJiYgaXRlbSkge1xuICAgICAgbGV0IGluQXJyYXkgPSBmYWxzZTtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5tdWx0aUl0ZW1zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChpdGVtLmxhYmVsKSB7XG4gICAgICAgICAgaWYgKGl0ZW0ubGFiZWwgPT09IHRoaXMubXVsdGlJdGVtc1tpXS5sYWJlbCkge1xuICAgICAgICAgICAgaW5BcnJheSA9IHRydWU7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKGl0ZW0gPT09IHRoaXMubXVsdGlJdGVtc1tpXSkge1xuICAgICAgICAgICAgaW5BcnJheSA9IHRydWU7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICghaW5BcnJheSkge1xuICAgICAgICB0aGlzLm11bHRpSXRlbXMucHVzaChpdGVtKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMubXVsdGlJdGVtcyA9IHRoaXMubXVsdGlJdGVtcy5maWx0ZXIoKGRhdGEpID0+IHtcbiAgICAgICAgICBpZiAoZGF0YS5sYWJlbCkge1xuICAgICAgICAgICAgcmV0dXJuIGRhdGEubGFiZWwgIT09IGl0ZW0ubGFiZWw7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBkYXRhICE9PSBpdGVtO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICh0aGlzLm92ZXJ2aWV3ID09PSAnc2luZ2xlJyAmJiBpdGVtKSB7XG4gICAgICB0aGlzLm11bHRpSXRlbXMgPSBbXTtcbiAgICAgIHRoaXMubXVsdGlJdGVtcy5wdXNoKGl0ZW0pO1xuICAgICAgdGhpcy5pbnB1dEVkaXQgPSBmYWxzZTtcbiAgICAgIHRoaXMubXVsdGlwbGVMYWJlbENsYXNzTmFtZVN1ZmZpeCA9IHRoaXMubXVsdGlwbGVMYWJlbENsYXNzTmFtZUNvbmZpZ1t0aGlzLm92ZXJ2aWV3XVsnYmx1ciddO1xuICAgIH1cbiAgICB0aGlzLnNldFNpbmdsZVBsYWNlaG9sZGVyKCk7XG4gICAgdGhpcy5hdXRvU3VibWl0LmVtaXQodGhpcy5tdWx0aUl0ZW1zKTtcbiAgICB0aGlzLm9uQ2hhbmdlKHRoaXMubXVsdGlJdGVtcyk7XG4gICAgdGhpcy5pbnB1dFZhbHVlID0gbnVsbDtcbiAgICB0aGlzLm11bHRpQXV0b0NvbXBsZXRlSW5wdXRFbGVtZW50Lm5hdGl2ZUVsZW1lbnQudmFsdWUgPSAnJztcbiAgfVxuXG4gIHB1YmxpYyByZW1vdmVMYWJlbChsYWJlbDogYW55KSB7XG4gICAgaWYgKHRoaXMubXVsdGlJdGVtcy5pbmRleE9mKGxhYmVsKSAhPT0gLTEpIHtcbiAgICAgIHRoaXMubXVsdGlJdGVtcyA9IHRoaXMubXVsdGlJdGVtcy5maWx0ZXIoKGl0ZW0pID0+IGl0ZW0gIT09IGxhYmVsKTtcbiAgICB9XG4gICAgdGhpcy5zZXRTaW5nbGVQbGFjZWhvbGRlcigpO1xuICAgIHRoaXMuYXV0b1N1Ym1pdC5lbWl0KHRoaXMubXVsdGlJdGVtcyk7XG4gICAgdGhpcy5vbkNoYW5nZSh0aGlzLm11bHRpSXRlbXMpO1xuICB9XG5cbiAgZ2V0SW5wdXRGb2N1c0ZsYWcoJGV2ZW50OiBhbnkpIHtcbiAgICB0aGlzLmlucHV0RWRpdCA9IHRoaXMubXVsdGlJdGVtcy5sZW5ndGggPT09IDAgfHwgJGV2ZW50LmZvY3VzO1xuICAgIHRoaXMucG9wdXBSZWYgPSAkZXZlbnQucG9wdXBSZWY7XG4gICAgdGhpcy5zZXRTaW5nbGVQbGFjZWhvbGRlcigpO1xuICAgIGlmICgkZXZlbnQuZm9jdXMpIHtcbiAgICAgIHRoaXMubXVsdGlwbGVMYWJlbENsYXNzTmFtZVN1ZmZpeCA9IHRoaXMubXVsdGlwbGVMYWJlbENsYXNzTmFtZUNvbmZpZ1t0aGlzLm92ZXJ2aWV3XVsnZm9jdXMnXTtcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAvLyDov5nph4zpnIDopoHnrYnlvoXkuIDkvJrmiY3og73ogZrnhKZcbiAgICAgICAgdGhpcy5tdWx0aUF1dG9Db21wbGV0ZUlucHV0RWxlbWVudC5uYXRpdmVFbGVtZW50LmZvY3VzKCk7XG4gICAgICB9LCAwKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5tdWx0aXBsZUxhYmVsQ2xhc3NOYW1lU3VmZml4ID0gdGhpcy5tdWx0aXBsZUxhYmVsQ2xhc3NOYW1lQ29uZmlnW3RoaXMub3ZlcnZpZXddWydibHVyJ107XG4gICAgICB0aGlzLmlucHV0VmFsdWUgPSBudWxsO1xuICAgICAgdGhpcy5tdWx0aUF1dG9Db21wbGV0ZUlucHV0RWxlbWVudC5uYXRpdmVFbGVtZW50LnZhbHVlID0gJyc7XG4gICAgICB0aGlzLmF1dG9TdWJtaXQuZW1pdCh0aGlzLm11bHRpSXRlbXMpO1xuICAgIH1cbiAgfVxuXG4gIG9uQmFja3NwYWNlS2V5VXAoJGV2ZW50OiBhbnksIGlucHV0VmFsdWU6IGFueSkge1xuICAgIGlmICh0aGlzLm11bHRpSXRlbXMubGVuZ3RoID4gMCAmJiAhaW5wdXRWYWx1ZSkge1xuICAgICAgdGhpcy5tdWx0aUl0ZW1zLnBvcCgpO1xuICAgIH1cbiAgICB0aGlzLnNldFNpbmdsZVBsYWNlaG9sZGVyKCk7XG4gICAgdGhpcy5hdXRvU3VibWl0LmVtaXQodGhpcy5tdWx0aUl0ZW1zKTtcbiAgICB0aGlzLm9uQ2hhbmdlKHRoaXMubXVsdGlJdGVtcyk7XG4gIH1cblxuICBzZXRTaW5nbGVQbGFjZWhvbGRlcigpIHtcbiAgICBpZiAodGhpcy5vdmVydmlldyA9PT0gJ3NpbmdsZScpIHtcbiAgICAgIGlmICh0aGlzLm11bHRpSXRlbXMgJiYgdGhpcy5tdWx0aUl0ZW1zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgdGhpcy5wbGFjZWhvbGRlciA9ICcnO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5wbGFjZWhvbGRlciA9IHRoaXMuY2xvbmVQbGFjZWhvbGRlcjtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBjaGFuZ2VQb3BVcChvcGVuKSB7XG4gICAgaWYgKG9wZW4pIHtcbiAgICAgIGFkZENsYXNzVG9PcmlnaW4odGhpcy5tdWx0aUF1dG9Db21wbGV0ZVdyYXBwZXJFbGVtZW50KTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVtb3ZlQ2xhc3NGcm9tT3JpZ2luKHRoaXMubXVsdGlBdXRvQ29tcGxldGVXcmFwcGVyRWxlbWVudCk7XG4gICAgfVxuICB9XG5cbiAgaW5wdXRCbHVyKCkge1xuICAgIHRoaXMub25Ub3VjaGVkKCk7XG4gIH1cbn1cbiIsIjxkaXYgY2xhc3M9XCJmb3JtLWdyb3VwIG11bHRpLWF1dG8tY29tcGxldGVcIj5cbiAgPGxhYmVsXG4gICAgZm9yPVwibXVsdGlwbGUtbGFiZWwtYXV0by1jb21wbGV0ZS17eyBpZCB9fVwiXG4gICAgY2xhc3M9XCJtdWx0aXBsZS1sYWJlbC1hdXRvLWNvbXBsZXRlIG11bHRpcGxlLWxhYmVsLWF1dG8tY29tcGxldGUte3sgbXVsdGlwbGVMYWJlbENsYXNzTmFtZVN1ZmZpeCB9fVwiXG4gICAgW25nQ2xhc3NdPVwieyAnbXVsdGlwbGUtbGFiZWwtYXV0by1jb21wbGV0ZS1kaXNhYmxlZCc6IGRpc2FibGVkIH1cIlxuICA+XG4gICAgPHVsICpuZ0lmPVwib3ZlcnZpZXcgIT09ICdzaW5nbGUnXCIgY2xhc3M9XCJkZXZ1aS1kcm9wZG93bi1vcmlnaW5cIiAjbXVsdGlBdXRvQ29tcGxldGVXcmFwcGVyPlxuICAgICAgPGxpICpuZ0Zvcj1cImxldCBpdGVtIG9mIG11bHRpSXRlbXNcIj5cbiAgICAgICAgPG5nLXRlbXBsYXRlXG4gICAgICAgICAgW25nVGVtcGxhdGVPdXRsZXRdPVwiZGlzYWJsZWQgfHwgKG92ZXJ2aWV3ID09PSAnbm9uZScgJiYgIWlucHV0RWRpdCkgPyB0cmFuc3BhcmVudFRlbXBsYXRlIDogZGVmYXVsdFRlbXBsYXRlXCJcbiAgICAgICAgICBbbmdUZW1wbGF0ZU91dGxldENvbnRleHRdPVwie1xuICAgICAgICAgICAgaXRlbTogaXRlbSxcbiAgICAgICAgICAgIGZvcm1hdHRlcjogZm9ybWF0dGVyLFxuICAgICAgICAgICAgcGFyZW50OiBtdWx0aUl0ZW1zXG4gICAgICAgICAgfVwiXG4gICAgICAgID48L25nLXRlbXBsYXRlPlxuICAgICAgPC9saT5cbiAgICAgIDxsaSAqbmdJZj1cIiFkaXNhYmxlZFwiPlxuICAgICAgICA8aW5wdXRcbiAgICAgICAgICAjbXVsdGlBdXRvQ29tcGxldGVJbnB1dFxuICAgICAgICAgIGlkPVwibXVsdGlwbGUtbGFiZWwtYXV0by1jb21wbGV0ZS17eyBpZCB9fVwiXG4gICAgICAgICAgdHlwZT1cInRleHRcIlxuICAgICAgICAgIG5hbWU9XCJhdXRvQ29tcGxldGVDb250cm9sXCJcbiAgICAgICAgICBjbGFzcz1cImF1dG8tY29tcGxldGUtY29udHJvbFwiXG4gICAgICAgICAgW3BsYWNlaG9sZGVyXT1cInBsYWNlaG9sZGVyVmlld1wiXG4gICAgICAgICAgW3RpcHNUZXh0XT1cInRpcHNUZXh0XCJcbiAgICAgICAgICBbbGF0ZXN0U291cmNlXT1cImxhdGVzdFNvdXJjZVwiXG4gICAgICAgICAgKHNlbGVjdFZhbHVlKT1cIm9uTXVsdGlwbGVTZWFyY2goJGV2ZW50KVwiXG4gICAgICAgICAgKHRyYW5zSW5wdXRGb2N1c0VtaXQpPVwiZ2V0SW5wdXRGb2N1c0ZsYWcoJGV2ZW50KVwiXG4gICAgICAgICAgKGtleWRvd24uYmFja3NwYWNlKT1cIm9uQmFja3NwYWNlS2V5VXAoJGV2ZW50LCBpbnB1dFZhbHVlKVwiXG4gICAgICAgICAgW2Zvcm1hdHRlcl09XCJmb3JtYXR0ZXJcIlxuICAgICAgICAgIFt2YWx1ZVBhcnNlcl09XCJ2YWx1ZVBhcnNlclwiXG4gICAgICAgICAgW2l0ZW1UZW1wbGF0ZV09XCJpdGVtVGVtcGxhdGVcIlxuICAgICAgICAgIFtub1Jlc3VsdEl0ZW1UZW1wbGF0ZV09XCJub1Jlc3VsdEl0ZW1UZW1wbGF0ZVwiXG4gICAgICAgICAgW2Nzc0NsYXNzXT1cImNzc0NsYXNzXCJcbiAgICAgICAgICBbb3ZlcnZpZXddPVwib3ZlcnZpZXdcIlxuICAgICAgICAgIFtkaXNhYmxlZF09XCJkaXNhYmxlZFwiXG4gICAgICAgICAgWyhuZ01vZGVsKV09XCJpbnB1dFZhbHVlXCJcbiAgICAgICAgICBbZGVsYXldPVwiZGVsYXlcIlxuICAgICAgICAgIFtkQXV0b0NvbXBsZXRlV2lkdGhdPVwid2lkdGhcIlxuICAgICAgICAgIGRBdXRvQ29tcGxldGVcbiAgICAgICAgICBbc2hvd0FuaW1hdGlvbl09XCJzaG93QW5pbWF0aW9uXCJcbiAgICAgICAgICBbc2VhcmNoRm5dPVwic2VhcmNoRm5cIlxuICAgICAgICAgIFthcHBlbmRUb0JvZHldPVwiYXBwZW5kVG9Cb2R5XCJcbiAgICAgICAgICBbYXBwZW5kVG9Cb2R5RGlyZWN0aW9uc109XCJhcHBlbmRUb0JvZHlEaXJlY3Rpb25zXCJcbiAgICAgICAgICBbY2RrT3ZlcmxheU9mZnNldFldPVwiM1wiXG4gICAgICAgICAgW2Rpc2FibGVkS2V5XT1cImRpc2FibGVkS2V5XCJcbiAgICAgICAgICAoYmx1cik9XCJpbnB1dEJsdXIoKVwiXG4gICAgICAgICAgKGNoYW5nZURyb3BEb3duU3RhdHVzKT1cImNoYW5nZVBvcFVwKCRldmVudClcIlxuICAgICAgICAvPlxuICAgICAgPC9saT5cbiAgICA8L3VsPlxuXG4gICAgPCEtLeWNlemAieaooeadvy0tPlxuICAgIDx1bCAqbmdJZj1cIm92ZXJ2aWV3ID09PSAnc2luZ2xlJ1wiIHRpdGxlPVwie3sgZm9ybWF0dGVyKG11bHRpSXRlbXNbMF0pIH19XCIgKGNsaWNrKT1cInNpbmdsZUNsaWNrKCRldmVudClcIj5cbiAgICAgIDxsaSAqbmdGb3I9XCJsZXQgaXRlbSBvZiBtdWx0aUl0ZW1zXCI+XG4gICAgICAgIDxuZy10ZW1wbGF0ZVxuICAgICAgICAgIFtuZ1RlbXBsYXRlT3V0bGV0XT1cInRyYW5zcGFyZW50VGVtcGxhdGVcIlxuICAgICAgICAgIFtuZ1RlbXBsYXRlT3V0bGV0Q29udGV4dF09XCJ7XG4gICAgICAgICAgICBpdGVtOiBpdGVtLFxuICAgICAgICAgICAgZm9ybWF0dGVyOiBmb3JtYXR0ZXIsXG4gICAgICAgICAgICBwYXJlbnQ6IG11bHRpSXRlbXNcbiAgICAgICAgICB9XCJcbiAgICAgICAgPjwvbmctdGVtcGxhdGU+XG4gICAgICA8L2xpPlxuICAgICAgPGxpICpuZ0lmPVwiIWRpc2FibGVkICYmIGlucHV0RWRpdFwiPlxuICAgICAgICA8aW5wdXRcbiAgICAgICAgICAjbXVsdGlBdXRvQ29tcGxldGVJbnB1dFxuICAgICAgICAgIGlkPVwibXVsdGlwbGUtbGFiZWwtYXV0by1jb21wbGV0ZS17eyBpZCB9fVwiXG4gICAgICAgICAgdHlwZT1cInRleHRcIlxuICAgICAgICAgIG5hbWU9XCJhdXRvQ29tcGxldGVDb250cm9sXCJcbiAgICAgICAgICBjbGFzcz1cImF1dG8tY29tcGxldGUtY29udHJvbFwiXG4gICAgICAgICAgW3BsYWNlaG9sZGVyXT1cInBsYWNlaG9sZGVyXCJcbiAgICAgICAgICBbdGlwc1RleHRdPVwidGlwc1RleHRcIlxuICAgICAgICAgIFtsYXRlc3RTb3VyY2VdPVwibGF0ZXN0U291cmNlXCJcbiAgICAgICAgICAoc2VsZWN0VmFsdWUpPVwib25NdWx0aXBsZVNlYXJjaCgkZXZlbnQpXCJcbiAgICAgICAgICAodHJhbnNJbnB1dEZvY3VzRW1pdCk9XCJnZXRJbnB1dEZvY3VzRmxhZygkZXZlbnQpXCJcbiAgICAgICAgICAoa2V5ZG93bi5iYWNrc3BhY2UpPVwib25CYWNrc3BhY2VLZXlVcCgkZXZlbnQsIGlucHV0VmFsdWUpXCJcbiAgICAgICAgICBbZm9ybWF0dGVyXT1cImZvcm1hdHRlclwiXG4gICAgICAgICAgW3ZhbHVlUGFyc2VyXT1cInZhbHVlUGFyc2VyXCJcbiAgICAgICAgICBbaXRlbVRlbXBsYXRlXT1cIml0ZW1UZW1wbGF0ZVwiXG4gICAgICAgICAgW25vUmVzdWx0SXRlbVRlbXBsYXRlXT1cIm5vUmVzdWx0SXRlbVRlbXBsYXRlXCJcbiAgICAgICAgICBbY3NzQ2xhc3NdPVwiY3NzQ2xhc3NcIlxuICAgICAgICAgIFtvdmVydmlld109XCJvdmVydmlld1wiXG4gICAgICAgICAgW2Rpc2FibGVkXT1cImRpc2FibGVkXCJcbiAgICAgICAgICBbKG5nTW9kZWwpXT1cImlucHV0VmFsdWVcIlxuICAgICAgICAgIFtkZWxheV09XCJkZWxheVwiXG4gICAgICAgICAgW2RBdXRvQ29tcGxldGVXaWR0aF09XCJ3aWR0aFwiXG4gICAgICAgICAgZEF1dG9Db21wbGV0ZVxuICAgICAgICAgIFtzZWFyY2hGbl09XCJzZWFyY2hGblwiXG4gICAgICAgICAgKGJsdXIpPVwiaW5wdXRCbHVyKClcIlxuICAgICAgICAgIChjaGFuZ2VEcm9wRG93blN0YXR1cyk9XCJjaGFuZ2VQb3BVcCgkZXZlbnQpXCJcbiAgICAgICAgLz5cbiAgICAgIDwvbGk+XG4gICAgPC91bD5cbiAgPC9sYWJlbD5cbjwvZGl2PlxuXG48IS0t6buE5bqV5qih5p2/LS0+XG48bmctdGVtcGxhdGUgI2RlZmF1bHRUZW1wbGF0ZSBsZXQtaXRlbT1cIml0ZW1cIiBsZXQtZm9ybWF0dGVyPVwiZm9ybWF0dGVyXCI+XG4gIDxkLXRhZyBbZGVsZXRhYmxlXT1cInRydWVcIiBbdGFnXT1cImZvcm1hdHRlcihpdGVtKVwiICh0YWdEZWxldGUpPVwicmVtb3ZlTGFiZWwoaXRlbSlcIj48L2QtdGFnPlxuPC9uZy10ZW1wbGF0ZT5cblxuPCEtLeaXoOW6leiJsuaooeadvy0tPlxuPG5nLXRlbXBsYXRlICN0cmFuc3BhcmVudFRlbXBsYXRlIGxldC1pdGVtPVwiaXRlbVwiIGxldC1mb3JtYXR0ZXI9XCJmb3JtYXR0ZXJcIiBsZXQtcGFyZW50PVwicGFyZW50XCI+XG4gIDxkLXRhZyBbdGFnXT1cImZvcm1hdHRlcihpdGVtKVwiPjwvZC10YWc+XG48L25nLXRlbXBsYXRlPlxuIl19