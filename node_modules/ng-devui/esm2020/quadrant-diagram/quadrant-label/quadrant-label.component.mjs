import { Component, Input, TemplateRef } from '@angular/core';
import { QuadrantDiagramService } from '../quadrant-diagram.service';
import { LARGE_LABEL_SIZE_CENTER_POINT, NORMAL_LABEL_SIZE_CENTER_POINT, SMALL_LABEL_SIZE_CENTER_POINT } from '../quadrant.config';
import * as i0 from "@angular/core";
import * as i1 from "../quadrant-diagram.service";
import * as i2 from "ng-devui/progress";
import * as i3 from "@angular/common";
import * as i4 from "ng-devui/dragdrop";
import * as i5 from "ng-devui/popover";
export class QuadrantLabelComponent {
    constructor(quadrantDiagramService) {
        this.quadrantDiagramService = quadrantDiagramService;
    }
    ngOnChanges(changes) {
        if (changes && changes['currentLabelSize']) {
            switch (this.currentLabelSize) {
                case 'small':
                    this.currentCenterPoint = SMALL_LABEL_SIZE_CENTER_POINT;
                    this.currentLabelTemplate = this.smallLabelTemplate;
                    break;
                case 'normal':
                    this.currentCenterPoint = NORMAL_LABEL_SIZE_CENTER_POINT;
                    this.currentLabelTemplate = this.normalLabelTemplate;
                    break;
                default:
                    this.currentCenterPoint = LARGE_LABEL_SIZE_CENTER_POINT;
                    this.currentLabelTemplate = this.largeLabelTemplate;
            }
        }
    }
    /**
    * @param offsetY the half height of label
    */
    getLabelTopValue(yAxisValue, offsetY) {
        return this.view.height - yAxisValue * this.axisConfigs.yTickSpacing - this.axisConfigs.originPosition.bottom - offsetY;
    }
    /**
    * @param offsetX the half width of label
    */
    getLabelLeftValue(xAxisValue, offsetX) {
        return xAxisValue * this.axisConfigs.xTickSpacing + this.axisConfigs.originPosition.left - offsetX;
    }
    showAxisLine(x, y) {
        const top = this.getLabelTopValue(y, 0);
        const left = this.getLabelLeftValue(x, 0);
        this.quadrantDiagramService.showAxisLine(left, top, this.diagramId, this.view, this.axisConfigs);
    }
    hideAxisLine() {
        this.quadrantDiagramService.hideAxisLine(this.diagramId);
    }
    handleDropOutRegion(event) {
        this.hideAxisLine();
        this.quadrantDiagramService.setListPointerEvents(this.diagramId, '');
    }
}
QuadrantLabelComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "13.1.3", ngImport: i0, type: QuadrantLabelComponent, deps: [{ token: i1.QuadrantDiagramService }], target: i0.ɵɵFactoryTarget.Component });
QuadrantLabelComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "13.1.3", type: QuadrantLabelComponent, selector: "d-quadrant-label", inputs: { currentLabelSize: "currentLabelSize", labelData: "labelData", axisConfigs: "axisConfigs", view: "view", normalLabelTemplate: "normalLabelTemplate", largeLabelTemplate: "largeLabelTemplate", smallLabelTemplate: "smallLabelTemplate", dropScope: "dropScope", diagramId: "diagramId" }, usesOnChanges: true, ngImport: i0, template: "<ng-template\n  [ngTemplateOutlet]=\"currentLabelTemplate ? currentLabelTemplate : defaultLabel\"\n  [ngTemplateOutletContext]=\"{\n    $implicit: this,\n    labelData: labelData\n  }\"\n>\n</ng-template>\n<ng-template #defaultLabel let-labelData=\"labelData\">\n  <div\n    dDraggable\n    [dragScope]=\"dropScope\"\n    [dragData]=\"{ item: item, parent: labelData }\"\n    (dragEndEvent)=\"handleDropOutRegion($event)\"\n    *ngFor=\"let item of labelData\"\n    class=\"devui-list-style devui-{{ currentLabelSize }}-size\"\n    [style.position]=\"'absolute'\"\n    [style.top.px]=\"getLabelTopValue(item?.y, currentCenterPoint?.y)\"\n    [style.left.px]=\"getLabelLeftValue(item?.x, currentCenterPoint?.x)\"\n    dPopover\n    [content]=\"item?.content\"\n    [position]=\"'bottom'\"\n    [controlled]=\"true\"\n    [trigger]=\"'hover'\"\n    (mouseover)=\"showAxisLine(item?.x, item?.y)\"\n    (mouseout)=\"hideAxisLine()\"\n  >\n    <div *ngIf=\"currentLabelSize !== 'small'\" class=\"devui-label-style\">{{ item?.title }}</div>\n    <ng-container *ngIf=\"currentLabelSize === 'large'\">\n      <d-progress style=\"margin-top: -4px\" [percentage]=\"item?.progress\" [percentageText]=\"''\" [strokeColor]=\"'#3ECCA6'\" [height]=\"'4px'\">\n      </d-progress>\n    </ng-container>\n  </div>\n  <div\n    class=\"devui-horizontal-line\"\n    [style.width.px]=\"view.width - axisConfigs.originPosition.left - axisConfigs.axisMargin\"\n    [style.left.px]=\"axisConfigs.originPosition.left\"\n    [style.display]=\"'none'\"\n  >\n    <span class=\"devui-axis-value\" id=\"devui-label-y-axis-value\"></span>\n  </div>\n  <div\n    class=\"devui-vertical-line\"\n    [style.height.px]=\"view.height - axisConfigs.originPosition.bottom - axisConfigs.axisMargin\"\n    [style.top.px]=\"axisConfigs.axisMargin\"\n    [style.display]=\"'none'\"\n  >\n    <span class=\"devui-axis-value\" id=\"devui-label-x-axis-value\"></span>\n  </div>\n</ng-template>\n", styles: [".devui-font-size-base{font-size:12px;font-size:var(--devui-font-size, 12px)}.devui-font-base{font-size:12px;font-size:var(--devui-font-size, 12px);font-weight:400;line-height:1.5}.devui-font-size-modal-title{font-size:18px;font-size:var(--devui-font-size-modal-title, 18px)}.devui-font-modal-title{font-size:18px;font-size:var(--devui-font-size-modal-title, 18px);font-weight:700;line-height:1.5}.devui-font-size-page-title{font-size:16px;font-size:var(--devui-font-size-page-title, 16px)}.devui-font-page-title{font-size:16px;font-size:var(--devui-font-size-page-title, 16px);font-weight:700;line-height:1.5}.devui-font-size-secondary-title{font-size:14px;font-size:var(--devui-font-size-card-title, 14px)}.devui-font-secondary-title{font-size:14px;font-size:var(--devui-font-size-card-title, 14px);font-weight:700;line-height:1.5}.devui-list-style{font-size:14px;font-size:var(--devui-font-size-card-title, 14px);color:#252b3a;color:var(--devui-text, #252b3a);background:#ffffff;background:var(--devui-base-bg, #ffffff);box-shadow:0 1px 4px rgba(37,43,58,.2);box-shadow:var(--devui-shadow-length-base, 0 1px 4px 0) var(--devui-shadow, rgba(37, 43, 58, .2));border-radius:2px;border-radius:var(--devui-border-radius, 2px);z-index:10;cursor:-webkit-grabbing;cursor:grabbing}.devui-list-style:hover{color:#5e7ce0;color:var(--devui-brand, #5e7ce0);box-shadow:0 4px 16px rgba(37,43,58,.2);box-shadow:var(--devui-shadow-length-hover, 0 4px 16px 0) var(--devui-shadow, rgba(37, 43, 58, .2))}.devui-large-size{height:36px;line-height:36px;width:120px}.devui-normal-size{height:28px;line-height:28px;width:90px}.devui-small-size{background:#50d4ab;background:var(--devui-success, #50d4ab);border-radius:100%;height:12px;width:12px}.devui-label-style{padding:0 12px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:center}:host ::ng-deep .devui-progress{background:#f2f2f3!important;background:var(--devui-dividing-line, #f2f2f3)!important}.devui-horizontal-line{position:absolute;height:1px;border-bottom:1px dashed #f2f2f3;border-bottom:1px dashed var(--devui-dividing-line, #f2f2f3)}.devui-vertical-line{position:absolute;width:1px;border-left:1px dashed #f2f2f3;border-left:1px dashed var(--devui-dividing-line, #f2f2f3)}.devui-axis-value{color:#71757f;color:var(--devui-aide-text, #71757f);line-height:20px;padding:4px;font-size:12px;font-size:var(--devui-font-size, 12px)}\n"], components: [{ type: i2.ProgressComponent, selector: "d-progress", inputs: ["percentage", "percentageText", "barbgcolor", "strokeColor", "height", "strokeWidth", "isCircle", "type", "showContent"] }], directives: [{ type: i3.NgTemplateOutlet, selector: "[ngTemplateOutlet]", inputs: ["ngTemplateOutletContext", "ngTemplateOutlet"] }, { type: i3.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { type: i4.DraggableDirective, selector: "[dDraggable]", inputs: ["dragData", "dragHandle", "dragEffect", "dragScope", "dragHandleClass", "dragOverClass", "disabled", "enableDragFollow", "dragFollowOptions", "originPlaceholder", "dragIdentity", "dragItemParentName", "dragItemChildrenName"], outputs: ["dragStartEvent", "dragEvent", "dragEndEvent", "dropEndEvent"] }, { type: i5.PopoverDirective, selector: "[dPopover]", inputs: ["content", "controlled", "position", "showAnimation", "showAnimate", "scrollElement", "appendToBody", "zIndex", "popType", "popMaxWidth", "trigger", "hoverToContent", "hoverDelayTime", "popoverStyle", "mouseEnterDelay", "mouseLeaveDelay", "visible"], exportAs: ["dPopover"] }, { type: i3.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "13.1.3", ngImport: i0, type: QuadrantLabelComponent, decorators: [{
            type: Component,
            args: [{ selector: 'd-quadrant-label', template: "<ng-template\n  [ngTemplateOutlet]=\"currentLabelTemplate ? currentLabelTemplate : defaultLabel\"\n  [ngTemplateOutletContext]=\"{\n    $implicit: this,\n    labelData: labelData\n  }\"\n>\n</ng-template>\n<ng-template #defaultLabel let-labelData=\"labelData\">\n  <div\n    dDraggable\n    [dragScope]=\"dropScope\"\n    [dragData]=\"{ item: item, parent: labelData }\"\n    (dragEndEvent)=\"handleDropOutRegion($event)\"\n    *ngFor=\"let item of labelData\"\n    class=\"devui-list-style devui-{{ currentLabelSize }}-size\"\n    [style.position]=\"'absolute'\"\n    [style.top.px]=\"getLabelTopValue(item?.y, currentCenterPoint?.y)\"\n    [style.left.px]=\"getLabelLeftValue(item?.x, currentCenterPoint?.x)\"\n    dPopover\n    [content]=\"item?.content\"\n    [position]=\"'bottom'\"\n    [controlled]=\"true\"\n    [trigger]=\"'hover'\"\n    (mouseover)=\"showAxisLine(item?.x, item?.y)\"\n    (mouseout)=\"hideAxisLine()\"\n  >\n    <div *ngIf=\"currentLabelSize !== 'small'\" class=\"devui-label-style\">{{ item?.title }}</div>\n    <ng-container *ngIf=\"currentLabelSize === 'large'\">\n      <d-progress style=\"margin-top: -4px\" [percentage]=\"item?.progress\" [percentageText]=\"''\" [strokeColor]=\"'#3ECCA6'\" [height]=\"'4px'\">\n      </d-progress>\n    </ng-container>\n  </div>\n  <div\n    class=\"devui-horizontal-line\"\n    [style.width.px]=\"view.width - axisConfigs.originPosition.left - axisConfigs.axisMargin\"\n    [style.left.px]=\"axisConfigs.originPosition.left\"\n    [style.display]=\"'none'\"\n  >\n    <span class=\"devui-axis-value\" id=\"devui-label-y-axis-value\"></span>\n  </div>\n  <div\n    class=\"devui-vertical-line\"\n    [style.height.px]=\"view.height - axisConfigs.originPosition.bottom - axisConfigs.axisMargin\"\n    [style.top.px]=\"axisConfigs.axisMargin\"\n    [style.display]=\"'none'\"\n  >\n    <span class=\"devui-axis-value\" id=\"devui-label-x-axis-value\"></span>\n  </div>\n</ng-template>\n", styles: [".devui-font-size-base{font-size:12px;font-size:var(--devui-font-size, 12px)}.devui-font-base{font-size:12px;font-size:var(--devui-font-size, 12px);font-weight:400;line-height:1.5}.devui-font-size-modal-title{font-size:18px;font-size:var(--devui-font-size-modal-title, 18px)}.devui-font-modal-title{font-size:18px;font-size:var(--devui-font-size-modal-title, 18px);font-weight:700;line-height:1.5}.devui-font-size-page-title{font-size:16px;font-size:var(--devui-font-size-page-title, 16px)}.devui-font-page-title{font-size:16px;font-size:var(--devui-font-size-page-title, 16px);font-weight:700;line-height:1.5}.devui-font-size-secondary-title{font-size:14px;font-size:var(--devui-font-size-card-title, 14px)}.devui-font-secondary-title{font-size:14px;font-size:var(--devui-font-size-card-title, 14px);font-weight:700;line-height:1.5}.devui-list-style{font-size:14px;font-size:var(--devui-font-size-card-title, 14px);color:#252b3a;color:var(--devui-text, #252b3a);background:#ffffff;background:var(--devui-base-bg, #ffffff);box-shadow:0 1px 4px rgba(37,43,58,.2);box-shadow:var(--devui-shadow-length-base, 0 1px 4px 0) var(--devui-shadow, rgba(37, 43, 58, .2));border-radius:2px;border-radius:var(--devui-border-radius, 2px);z-index:10;cursor:-webkit-grabbing;cursor:grabbing}.devui-list-style:hover{color:#5e7ce0;color:var(--devui-brand, #5e7ce0);box-shadow:0 4px 16px rgba(37,43,58,.2);box-shadow:var(--devui-shadow-length-hover, 0 4px 16px 0) var(--devui-shadow, rgba(37, 43, 58, .2))}.devui-large-size{height:36px;line-height:36px;width:120px}.devui-normal-size{height:28px;line-height:28px;width:90px}.devui-small-size{background:#50d4ab;background:var(--devui-success, #50d4ab);border-radius:100%;height:12px;width:12px}.devui-label-style{padding:0 12px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:center}:host ::ng-deep .devui-progress{background:#f2f2f3!important;background:var(--devui-dividing-line, #f2f2f3)!important}.devui-horizontal-line{position:absolute;height:1px;border-bottom:1px dashed #f2f2f3;border-bottom:1px dashed var(--devui-dividing-line, #f2f2f3)}.devui-vertical-line{position:absolute;width:1px;border-left:1px dashed #f2f2f3;border-left:1px dashed var(--devui-dividing-line, #f2f2f3)}.devui-axis-value{color:#71757f;color:var(--devui-aide-text, #71757f);line-height:20px;padding:4px;font-size:12px;font-size:var(--devui-font-size, 12px)}\n"] }]
        }], ctorParameters: function () { return [{ type: i1.QuadrantDiagramService }]; }, propDecorators: { currentLabelSize: [{
                type: Input
            }], labelData: [{
                type: Input
            }], axisConfigs: [{
                type: Input
            }], view: [{
                type: Input
            }], normalLabelTemplate: [{
                type: Input
            }], largeLabelTemplate: [{
                type: Input
            }], smallLabelTemplate: [{
                type: Input
            }], dropScope: [{
                type: Input
            }], diagramId: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicXVhZHJhbnQtbGFiZWwuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vZGV2dWkvcXVhZHJhbnQtZGlhZ3JhbS9xdWFkcmFudC1sYWJlbC9xdWFkcmFudC1sYWJlbC5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi9kZXZ1aS9xdWFkcmFudC1kaWFncmFtL3F1YWRyYW50LWxhYmVsL3F1YWRyYW50LWxhYmVsLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUE0QixXQUFXLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDeEYsT0FBTyxFQUFFLHNCQUFzQixFQUFFLE1BQU0sNkJBQTZCLENBQUM7QUFFckUsT0FBTyxFQUFFLDZCQUE2QixFQUFFLDhCQUE4QixFQUFFLDZCQUE2QixFQUFFLE1BQU0sb0JBQW9CLENBQUM7Ozs7Ozs7QUFNbEksTUFBTSxPQUFPLHNCQUFzQjtJQVlqQyxZQUFvQixzQkFBOEM7UUFBOUMsMkJBQXNCLEdBQXRCLHNCQUFzQixDQUF3QjtJQUFJLENBQUM7SUFDdkUsV0FBVyxDQUFDLE9BQXNCO1FBQ2hDLElBQUksT0FBTyxJQUFJLE9BQU8sQ0FBQyxrQkFBa0IsQ0FBQyxFQUFFO1lBQzFDLFFBQVEsSUFBSSxDQUFDLGdCQUFnQixFQUFFO2dCQUMvQixLQUFLLE9BQU87b0JBQ1YsSUFBSSxDQUFDLGtCQUFrQixHQUFHLDZCQUE2QixDQUFDO29CQUN4RCxJQUFJLENBQUMsb0JBQW9CLEdBQUcsSUFBSSxDQUFDLGtCQUFrQixDQUFDO29CQUNwRCxNQUFNO2dCQUNSLEtBQUssUUFBUTtvQkFDWCxJQUFJLENBQUMsa0JBQWtCLEdBQUcsOEJBQThCLENBQUM7b0JBQ3pELElBQUksQ0FBQyxvQkFBb0IsR0FBRyxJQUFJLENBQUMsbUJBQW1CLENBQUM7b0JBQ3JELE1BQU07Z0JBQ1I7b0JBQ0UsSUFBSSxDQUFDLGtCQUFrQixHQUFHLDZCQUE2QixDQUFDO29CQUN4RCxJQUFJLENBQUMsb0JBQW9CLEdBQUcsSUFBSSxDQUFDLGtCQUFrQixDQUFDO2FBQ3JEO1NBQ0Y7SUFDSCxDQUFDO0lBRUQ7O01BRUU7SUFDRixnQkFBZ0IsQ0FBQyxVQUFVLEVBQUUsT0FBTztRQUNsQyxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxHQUFHLFVBQVUsR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLFlBQVksR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLGNBQWMsQ0FBQyxNQUFNLEdBQUcsT0FBTyxDQUFDO0lBQzFILENBQUM7SUFFRDs7TUFFRTtJQUNGLGlCQUFpQixDQUFDLFVBQVUsRUFBRSxPQUFPO1FBQ25DLE9BQU8sVUFBVSxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUMsWUFBWSxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUMsY0FBYyxDQUFDLElBQUksR0FBRyxPQUFPLENBQUM7SUFDckcsQ0FBQztJQUNELFlBQVksQ0FBQyxDQUFDLEVBQUUsQ0FBQztRQUNmLE1BQU0sR0FBRyxHQUFHLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDeEMsTUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDLGlCQUFpQixDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztRQUMxQyxJQUFJLENBQUMsc0JBQXNCLENBQUMsWUFBWSxDQUFDLElBQUksRUFBRSxHQUFHLEVBQUUsSUFBSSxDQUFDLFNBQVMsRUFBRSxJQUFJLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQztJQUNuRyxDQUFDO0lBQ0QsWUFBWTtRQUNWLElBQUksQ0FBQyxzQkFBc0IsQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO0lBQzNELENBQUM7SUFDRCxtQkFBbUIsQ0FBQyxLQUFLO1FBQ3ZCLElBQUksQ0FBQyxZQUFZLEVBQUUsQ0FBQztRQUNwQixJQUFJLENBQUMsc0JBQXNCLENBQUMsb0JBQW9CLENBQUMsSUFBSSxDQUFDLFNBQVMsRUFBRSxFQUFFLENBQUMsQ0FBQztJQUN2RSxDQUFDOzttSEF2RFUsc0JBQXNCO3VHQUF0QixzQkFBc0IsaVhDVG5DLGk2REFrREE7MkZEekNhLHNCQUFzQjtrQkFMbEMsU0FBUzsrQkFDRSxrQkFBa0I7NkdBS25CLGdCQUFnQjtzQkFBeEIsS0FBSztnQkFDRyxTQUFTO3NCQUFqQixLQUFLO2dCQUNHLFdBQVc7c0JBQW5CLEtBQUs7Z0JBQ0csSUFBSTtzQkFBWixLQUFLO2dCQUNHLG1CQUFtQjtzQkFBM0IsS0FBSztnQkFDRyxrQkFBa0I7c0JBQTFCLEtBQUs7Z0JBQ0csa0JBQWtCO3NCQUExQixLQUFLO2dCQUNHLFNBQVM7c0JBQWpCLEtBQUs7Z0JBQ0csU0FBUztzQkFBakIsS0FBSyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgSW5wdXQsIE9uQ2hhbmdlcywgU2ltcGxlQ2hhbmdlcywgVGVtcGxhdGVSZWYgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IFF1YWRyYW50RGlhZ3JhbVNlcnZpY2UgfSBmcm9tICcuLi9xdWFkcmFudC1kaWFncmFtLnNlcnZpY2UnO1xuaW1wb3J0IHsgSUF4aXNDb25maWdzLCBJVmlld0NvbmZpZ3MgfSBmcm9tICcuLi9xdWFkcmFudC1kaWFncmFtLnR5cGUnO1xuaW1wb3J0IHsgTEFSR0VfTEFCRUxfU0laRV9DRU5URVJfUE9JTlQsIE5PUk1BTF9MQUJFTF9TSVpFX0NFTlRFUl9QT0lOVCwgU01BTExfTEFCRUxfU0laRV9DRU5URVJfUE9JTlQgfSBmcm9tICcuLi9xdWFkcmFudC5jb25maWcnO1xuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnZC1xdWFkcmFudC1sYWJlbCcsXG4gIHRlbXBsYXRlVXJsOiAnLi9xdWFkcmFudC1sYWJlbC5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWycuL3F1YWRyYW50LWxhYmVsLmNvbXBvbmVudC5zY3NzJ11cbn0pXG5leHBvcnQgY2xhc3MgUXVhZHJhbnRMYWJlbENvbXBvbmVudCBpbXBsZW1lbnRzIE9uQ2hhbmdlcyB7XG4gIEBJbnB1dCgpIGN1cnJlbnRMYWJlbFNpemU7XG4gIEBJbnB1dCgpIGxhYmVsRGF0YTtcbiAgQElucHV0KCkgYXhpc0NvbmZpZ3M6IElBeGlzQ29uZmlncztcbiAgQElucHV0KCkgdmlldzogSVZpZXdDb25maWdzO1xuICBASW5wdXQoKSBub3JtYWxMYWJlbFRlbXBsYXRlOiBUZW1wbGF0ZVJlZjxhbnk+O1xuICBASW5wdXQoKSBsYXJnZUxhYmVsVGVtcGxhdGU6IFRlbXBsYXRlUmVmPGFueT47XG4gIEBJbnB1dCgpIHNtYWxsTGFiZWxUZW1wbGF0ZTogVGVtcGxhdGVSZWY8YW55PjtcbiAgQElucHV0KCkgZHJvcFNjb3BlO1xuICBASW5wdXQoKSBkaWFncmFtSWQ7XG4gIGN1cnJlbnRDZW50ZXJQb2ludDtcbiAgY3VycmVudExhYmVsVGVtcGxhdGU7XG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgcXVhZHJhbnREaWFncmFtU2VydmljZTogUXVhZHJhbnREaWFncmFtU2VydmljZSkgeyB9XG4gIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpOiB2b2lkIHtcbiAgICBpZiAoY2hhbmdlcyAmJiBjaGFuZ2VzWydjdXJyZW50TGFiZWxTaXplJ10pIHtcbiAgICAgIHN3aXRjaCAodGhpcy5jdXJyZW50TGFiZWxTaXplKSB7XG4gICAgICBjYXNlICdzbWFsbCc6XG4gICAgICAgIHRoaXMuY3VycmVudENlbnRlclBvaW50ID0gU01BTExfTEFCRUxfU0laRV9DRU5URVJfUE9JTlQ7XG4gICAgICAgIHRoaXMuY3VycmVudExhYmVsVGVtcGxhdGUgPSB0aGlzLnNtYWxsTGFiZWxUZW1wbGF0ZTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdub3JtYWwnOlxuICAgICAgICB0aGlzLmN1cnJlbnRDZW50ZXJQb2ludCA9IE5PUk1BTF9MQUJFTF9TSVpFX0NFTlRFUl9QT0lOVDtcbiAgICAgICAgdGhpcy5jdXJyZW50TGFiZWxUZW1wbGF0ZSA9IHRoaXMubm9ybWFsTGFiZWxUZW1wbGF0ZTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICB0aGlzLmN1cnJlbnRDZW50ZXJQb2ludCA9IExBUkdFX0xBQkVMX1NJWkVfQ0VOVEVSX1BPSU5UO1xuICAgICAgICB0aGlzLmN1cnJlbnRMYWJlbFRlbXBsYXRlID0gdGhpcy5sYXJnZUxhYmVsVGVtcGxhdGU7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICogQHBhcmFtIG9mZnNldFkgdGhlIGhhbGYgaGVpZ2h0IG9mIGxhYmVsXG4gICovXG4gIGdldExhYmVsVG9wVmFsdWUoeUF4aXNWYWx1ZSwgb2Zmc2V0WSkge1xuICAgIHJldHVybiB0aGlzLnZpZXcuaGVpZ2h0IC0geUF4aXNWYWx1ZSAqIHRoaXMuYXhpc0NvbmZpZ3MueVRpY2tTcGFjaW5nIC0gdGhpcy5heGlzQ29uZmlncy5vcmlnaW5Qb3NpdGlvbi5ib3R0b20gLSBvZmZzZXRZO1xuICB9XG5cbiAgLyoqXG4gICogQHBhcmFtIG9mZnNldFggdGhlIGhhbGYgd2lkdGggb2YgbGFiZWxcbiAgKi9cbiAgZ2V0TGFiZWxMZWZ0VmFsdWUoeEF4aXNWYWx1ZSwgb2Zmc2V0WCkge1xuICAgIHJldHVybiB4QXhpc1ZhbHVlICogdGhpcy5heGlzQ29uZmlncy54VGlja1NwYWNpbmcgKyB0aGlzLmF4aXNDb25maWdzLm9yaWdpblBvc2l0aW9uLmxlZnQgLSBvZmZzZXRYO1xuICB9XG4gIHNob3dBeGlzTGluZSh4LCB5KSB7XG4gICAgY29uc3QgdG9wID0gdGhpcy5nZXRMYWJlbFRvcFZhbHVlKHksIDApO1xuICAgIGNvbnN0IGxlZnQgPSB0aGlzLmdldExhYmVsTGVmdFZhbHVlKHgsIDApO1xuICAgIHRoaXMucXVhZHJhbnREaWFncmFtU2VydmljZS5zaG93QXhpc0xpbmUobGVmdCwgdG9wLCB0aGlzLmRpYWdyYW1JZCwgdGhpcy52aWV3LCB0aGlzLmF4aXNDb25maWdzKTtcbiAgfVxuICBoaWRlQXhpc0xpbmUoKSB7XG4gICAgdGhpcy5xdWFkcmFudERpYWdyYW1TZXJ2aWNlLmhpZGVBeGlzTGluZSh0aGlzLmRpYWdyYW1JZCk7XG4gIH1cbiAgaGFuZGxlRHJvcE91dFJlZ2lvbihldmVudCkge1xuICAgIHRoaXMuaGlkZUF4aXNMaW5lKCk7XG4gICAgdGhpcy5xdWFkcmFudERpYWdyYW1TZXJ2aWNlLnNldExpc3RQb2ludGVyRXZlbnRzKHRoaXMuZGlhZ3JhbUlkLCAnJyk7XG4gIH1cbn1cbiIsIjxuZy10ZW1wbGF0ZVxuICBbbmdUZW1wbGF0ZU91dGxldF09XCJjdXJyZW50TGFiZWxUZW1wbGF0ZSA/IGN1cnJlbnRMYWJlbFRlbXBsYXRlIDogZGVmYXVsdExhYmVsXCJcbiAgW25nVGVtcGxhdGVPdXRsZXRDb250ZXh0XT1cIntcbiAgICAkaW1wbGljaXQ6IHRoaXMsXG4gICAgbGFiZWxEYXRhOiBsYWJlbERhdGFcbiAgfVwiXG4+XG48L25nLXRlbXBsYXRlPlxuPG5nLXRlbXBsYXRlICNkZWZhdWx0TGFiZWwgbGV0LWxhYmVsRGF0YT1cImxhYmVsRGF0YVwiPlxuICA8ZGl2XG4gICAgZERyYWdnYWJsZVxuICAgIFtkcmFnU2NvcGVdPVwiZHJvcFNjb3BlXCJcbiAgICBbZHJhZ0RhdGFdPVwieyBpdGVtOiBpdGVtLCBwYXJlbnQ6IGxhYmVsRGF0YSB9XCJcbiAgICAoZHJhZ0VuZEV2ZW50KT1cImhhbmRsZURyb3BPdXRSZWdpb24oJGV2ZW50KVwiXG4gICAgKm5nRm9yPVwibGV0IGl0ZW0gb2YgbGFiZWxEYXRhXCJcbiAgICBjbGFzcz1cImRldnVpLWxpc3Qtc3R5bGUgZGV2dWkte3sgY3VycmVudExhYmVsU2l6ZSB9fS1zaXplXCJcbiAgICBbc3R5bGUucG9zaXRpb25dPVwiJ2Fic29sdXRlJ1wiXG4gICAgW3N0eWxlLnRvcC5weF09XCJnZXRMYWJlbFRvcFZhbHVlKGl0ZW0/LnksIGN1cnJlbnRDZW50ZXJQb2ludD8ueSlcIlxuICAgIFtzdHlsZS5sZWZ0LnB4XT1cImdldExhYmVsTGVmdFZhbHVlKGl0ZW0/LngsIGN1cnJlbnRDZW50ZXJQb2ludD8ueClcIlxuICAgIGRQb3BvdmVyXG4gICAgW2NvbnRlbnRdPVwiaXRlbT8uY29udGVudFwiXG4gICAgW3Bvc2l0aW9uXT1cIidib3R0b20nXCJcbiAgICBbY29udHJvbGxlZF09XCJ0cnVlXCJcbiAgICBbdHJpZ2dlcl09XCInaG92ZXInXCJcbiAgICAobW91c2VvdmVyKT1cInNob3dBeGlzTGluZShpdGVtPy54LCBpdGVtPy55KVwiXG4gICAgKG1vdXNlb3V0KT1cImhpZGVBeGlzTGluZSgpXCJcbiAgPlxuICAgIDxkaXYgKm5nSWY9XCJjdXJyZW50TGFiZWxTaXplICE9PSAnc21hbGwnXCIgY2xhc3M9XCJkZXZ1aS1sYWJlbC1zdHlsZVwiPnt7IGl0ZW0/LnRpdGxlIH19PC9kaXY+XG4gICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cImN1cnJlbnRMYWJlbFNpemUgPT09ICdsYXJnZSdcIj5cbiAgICAgIDxkLXByb2dyZXNzIHN0eWxlPVwibWFyZ2luLXRvcDogLTRweFwiIFtwZXJjZW50YWdlXT1cIml0ZW0/LnByb2dyZXNzXCIgW3BlcmNlbnRhZ2VUZXh0XT1cIicnXCIgW3N0cm9rZUNvbG9yXT1cIicjM0VDQ0E2J1wiIFtoZWlnaHRdPVwiJzRweCdcIj5cbiAgICAgIDwvZC1wcm9ncmVzcz5cbiAgICA8L25nLWNvbnRhaW5lcj5cbiAgPC9kaXY+XG4gIDxkaXZcbiAgICBjbGFzcz1cImRldnVpLWhvcml6b250YWwtbGluZVwiXG4gICAgW3N0eWxlLndpZHRoLnB4XT1cInZpZXcud2lkdGggLSBheGlzQ29uZmlncy5vcmlnaW5Qb3NpdGlvbi5sZWZ0IC0gYXhpc0NvbmZpZ3MuYXhpc01hcmdpblwiXG4gICAgW3N0eWxlLmxlZnQucHhdPVwiYXhpc0NvbmZpZ3Mub3JpZ2luUG9zaXRpb24ubGVmdFwiXG4gICAgW3N0eWxlLmRpc3BsYXldPVwiJ25vbmUnXCJcbiAgPlxuICAgIDxzcGFuIGNsYXNzPVwiZGV2dWktYXhpcy12YWx1ZVwiIGlkPVwiZGV2dWktbGFiZWwteS1heGlzLXZhbHVlXCI+PC9zcGFuPlxuICA8L2Rpdj5cbiAgPGRpdlxuICAgIGNsYXNzPVwiZGV2dWktdmVydGljYWwtbGluZVwiXG4gICAgW3N0eWxlLmhlaWdodC5weF09XCJ2aWV3LmhlaWdodCAtIGF4aXNDb25maWdzLm9yaWdpblBvc2l0aW9uLmJvdHRvbSAtIGF4aXNDb25maWdzLmF4aXNNYXJnaW5cIlxuICAgIFtzdHlsZS50b3AucHhdPVwiYXhpc0NvbmZpZ3MuYXhpc01hcmdpblwiXG4gICAgW3N0eWxlLmRpc3BsYXldPVwiJ25vbmUnXCJcbiAgPlxuICAgIDxzcGFuIGNsYXNzPVwiZGV2dWktYXhpcy12YWx1ZVwiIGlkPVwiZGV2dWktbGFiZWwteC1heGlzLXZhbHVlXCI+PC9zcGFuPlxuICA8L2Rpdj5cbjwvbmctdGVtcGxhdGU+XG4iXX0=