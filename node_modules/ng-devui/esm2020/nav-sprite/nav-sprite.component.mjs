import { DOCUMENT } from '@angular/common';
import { ChangeDetectorRef, Component, ElementRef, EventEmitter, Inject, Input, Output, QueryList, Renderer2, TemplateRef, ViewChild, ViewChildren } from '@angular/core';
import { ActivatedRoute, Router } from '@angular/router';
import { scrollAnimate } from 'ng-devui/utils';
import { fromEvent } from 'rxjs';
import { debounceTime } from 'rxjs/operators';
import * as i0 from "@angular/core";
import * as i1 from "@angular/router";
import * as i2 from "ng-devui/button";
import * as i3 from "@angular/common";
import * as i4 from "@angular/cdk/drag-drop";
import * as i5 from "ng-devui/tooltip";
const DEFAULT_OPTIONS = {
    top: '30%',
    left: '80%',
    zIndex: 1,
};
export class NavSpriteComponent {
    constructor(render, element, router, activeRout, render2, cdr, doc) {
        this.render = render;
        this.element = element;
        this.router = router;
        this.activeRout = activeRout;
        this.render2 = render2;
        this.cdr = cdr;
        this.doc = doc;
        this.view = { top: 0, bottom: 0 }; // 矫正参数
        this.hashSupport = false; // 支持锚点
        this.mode = 'default'; // 模式
        this.maxLevel = 3; // 最大层级
        this.title = 'menu'; // 名称
        this.indent = 2; // 缩进
        this.width = 300; // 高度
        this.height = 400; // 高度
        this.isOpen = true; // sprite模式下的初始状态
        this.afterNavInit = new EventEmitter(); // 组件初始化后返回组件实例
        this.menus = [];
        this.activeIndex = -1;
        this.isToViewByNav = false; // 区分是页面滚动还是点击目录事件
        this.itemsInit = false;
        this.isDragging = false;
        this.timeGap = 60;
        this.document = this.doc;
    }
    get baseUrl() {
        if (typeof window === 'undefined') {
            return '';
        }
        return window.location.href.replace(window.location.hash, '');
    }
    ngOnInit() {
        this.currentTemp = this.mode === 'default' ? this.defaultTemp : this.spriteTemp; // 设置当前的模式
        this.navItemTemplate = this.navItemTemplate || this.defaultNavItemTemplate; // 设置当前的目录模板
        this.targetContainer = this.scrollTarget || this.target;
    }
    ngAfterViewInit() {
        setTimeout(() => {
            const container = this.targetContainer === this.document.documentElement ? window : this.targetContainer;
            this.scrollSub = fromEvent(container, 'scroll')
                .pipe(debounceTime(300))
                .subscribe(() => {
                this.scrollEventHandler();
            });
            this.itemsSub = this.items.changes.subscribe((items) => {
                if (!this.itemsInit) {
                    this.itemsInit = true;
                    this.setActiveMenu();
                }
            });
            this.initStyles();
        }, 0);
    }
    setActiveIndex() {
        if (this.hashSupport && this.activeRout.snapshot.fragment) {
            this.activeIndex = this.menus.findIndex((menu) => {
                return menu.label === this.activeRout.snapshot.fragment;
            });
            this.isToViewByNav = true;
            scrollAnimate(this.targetContainer, this.targetContainer.scrollTop, this.menus[this.activeIndex]?.scrollPosition?.startLine, undefined, undefined, () => {
                setTimeout(() => {
                    this.isToViewByNav = false;
                }, 160);
            });
        }
        else {
            this.activeIndex = this.menus.findIndex((i) => {
                const scrollTop = this.targetContainer.scrollTop;
                return scrollTop < i?.scrollPosition.top;
            });
        }
        this.cdr.detectChanges();
    }
    getNavData(setActive = true) {
        const search = [];
        for (let i = 0; i < this.maxLevel; i++) {
            search.push(`h${i + 1}`);
        }
        this.contents = Array.from(this.target.querySelectorAll(search.join(',')));
        this.menus = this.contents.map((i) => {
            return {
                originEle: i,
                level: i.tagName.match(/\d+/)[0],
                label: i.innerText,
                href: this.baseUrl + '#' + i.innerText,
                scrollPosition: this.getScrollPosition(i),
            };
        });
        if (setActive) {
            this.setActiveIndex();
        }
    }
    // 设定目录范围
    getScrollPosition(ele) {
        const containerTop = Math.max(this.targetContainer.getBoundingClientRect().top, 0);
        const containerScrollTop = this.targetContainer.scrollTop;
        const top = ele.getBoundingClientRect().bottom - containerTop + containerScrollTop - this.view.top + this.view.bottom;
        const startLine = ele.getBoundingClientRect().top - containerTop + containerScrollTop - this.view.top + this.view.bottom;
        return { top, startLine };
    }
    // 监听页面滚动
    scrollEventHandler() {
        if (!this.isToViewByNav) {
            const scrollTop = this.targetContainer.scrollTop;
            const index = this.menus.findIndex((ele, i) => {
                return scrollTop >= ele.scrollPosition.startLine && scrollTop < this.menus[i + 1]?.scrollPosition.startLine;
            });
            if (index !== -1 && this.activeIndex !== index) {
                this.activeIndex = index;
                this.menuScrollToTarget();
            }
        }
    }
    menuScrollToTarget() {
        const item = this.items.toArray()[this.activeIndex];
        const menuContainer = this.element.nativeElement.querySelector('.devui-nav-sprite-menus');
        const start = menuContainer?.scrollTop;
        const end = item?.nativeElement?.getBoundingClientRect().top + start - menuContainer?.getBoundingClientRect().top;
        scrollAnimate(menuContainer, start, end, undefined, undefined, () => {
            if (this.hashSupport) {
                this.setUrlHash();
            }
        });
    }
    setActiveMenu() {
        const item = this.items.toArray()[this.activeIndex];
        const menuContainer = this.element.nativeElement.querySelector('.devui-nav-sprite-menus');
        const top = item?.nativeElement.getBoundingClientRect().top - menuContainer.getBoundingClientRect().top;
        scrollAnimate(menuContainer, menuContainer.scrollTop, top, undefined, undefined);
    }
    initStyles() {
        if (this.mode === 'sprite') {
            const content = this.element.nativeElement.querySelector('.devui-nav-sprite-content');
            const spriteOptions = { ...DEFAULT_OPTIONS, ...this.spriteOption };
            this.render.addClass(content, 'devui-is-sprite');
            this.render.setStyle(content, 'position', 'fixed');
            this.render.setStyle(content, 'top', spriteOptions.top);
            this.render.setStyle(content, 'left', spriteOptions.left);
            this.render.setStyle(content, 'z-index', spriteOptions.zIndex);
            this.render.setStyle(content, 'height', this.height + 'px');
            this.render.setStyle(content, 'width', this.width + 'px');
        }
        this.render.setStyle(this.element.nativeElement, 'height', this.height + 'px');
        this.render.setStyle(this.element.nativeElement, 'width', this.width + 'px');
        this.afterNavInit.emit(this);
    }
    // 设置hash
    setUrlHash() {
        const activeMenu = this.menus[this.activeIndex];
        this.router.navigate([], { fragment: activeMenu.label, replaceUrl: true });
    }
    // addClass
    setTargetActive() {
        const target = this.menus[this.activeIndex];
        this.menus.forEach((i) => {
            if (i.originEle) {
                this.render2.removeClass(i.originEle, 'nav-active');
            }
        });
        this.render2.addClass(target?.originEle, 'nav-active');
    }
    navTo(index) {
        if (this.activeIndex !== index) {
            this.activeIndex = index;
            const target = this.menus[index];
            scrollAnimate(this.targetContainer, this.targetContainer.scrollTop, target?.scrollPosition.startLine, undefined, undefined, () => {
                this.setUrlHash();
                this.setTargetActive();
                setTimeout(() => {
                    this.isToViewByNav = false;
                }, this.timeGap);
            });
            this.isToViewByNav = true;
        }
    }
    cdkDragStarted() {
        this.isDragging = true;
    }
    cdkDragEnded() {
        setTimeout(() => {
            this.isDragging = false;
        }, 100);
    }
    hide() {
        this.isOpen = false;
    }
    open() {
        if (this.isDragging) {
            return;
        }
        this.isOpen = true;
    }
    ngOnDestroy() {
        if (this.scrollSub) {
            this.scrollSub.unsubscribe();
        }
        if (this.mouseenterSub) {
            this.mouseenterSub.unsubscribe();
        }
        if (this.itemsSub) {
            this.itemsSub.unsubscribe();
        }
    }
}
NavSpriteComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "13.1.3", ngImport: i0, type: NavSpriteComponent, deps: [{ token: i0.Renderer2 }, { token: i0.ElementRef }, { token: i1.Router }, { token: i1.ActivatedRoute }, { token: i0.Renderer2 }, { token: i0.ChangeDetectorRef }, { token: DOCUMENT }], target: i0.ɵɵFactoryTarget.Component });
NavSpriteComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "13.1.3", type: NavSpriteComponent, selector: "d-nav-sprite", inputs: { target: "target", scrollTarget: "scrollTarget", view: "view", hashSupport: "hashSupport", mode: "mode", maxLevel: "maxLevel", title: "title", indent: "indent", width: "width", height: "height", isOpen: "isOpen", spriteOption: "spriteOption", navItemTemplate: "navItemTemplate" }, outputs: { afterNavInit: "afterNavInit" }, viewQueries: [{ propertyName: "spriteTemp", first: true, predicate: ["spriteTemp"], descendants: true, static: true }, { propertyName: "defaultTemp", first: true, predicate: ["defaultTemp"], descendants: true, static: true }, { propertyName: "defaultNavItemTemplate", first: true, predicate: ["defaultNavItemTemplate"], descendants: true, static: true }, { propertyName: "items", predicate: ["items"], descendants: true, read: ElementRef }], ngImport: i0, template: "<ng-container [ngTemplateOutlet]=\"currentTemp\"></ng-container>\n\n<!-- \u7CBE\u7075\u6A21\u5F0F\u6A21\u677F -->\n<ng-template #spriteTemp>\n  <div\n    class=\"devui-nav-sprite-content\"\n    cdkDrag\n    [ngClass]=\"{ 'is-min': !isOpen }\"\n    (cdkDragStarted)=\"cdkDragStarted()\"\n    (cdkDragEnded)=\"cdkDragEnded()\"\n  >\n    <ng-container *ngIf=\"isOpen; else minTemp\">\n      <div class=\"devui-nav-sprite-header\">\n        <div class=\"devui-nav-sprite-header-title\">{{ title }}</div>\n        <d-button icon=\"icon-close\" bsStyle=\"text\" title=\"close\" (click)=\"hide()\"></d-button>\n      </div>\n      <ng-container [ngTemplateOutlet]=\"defaultItemsTemp\"></ng-container>\n    </ng-container>\n  </div>\n</ng-template>\n\n<!-- \u9ED8\u8BA4\u6A21\u677F -->\n<ng-template #defaultTemp>\n  <div class=\"devui-nav-sprite-content\">\n    <div class=\"devui-nav-sprite-header\">{{ title }}</div>\n    <ng-container [ngTemplateOutlet]=\"defaultItemsTemp\"></ng-container>\n  </div>\n</ng-template>\n\n<!-- \u76EE\u5F55\u5185\u5BB9\u6A21\u677F -->\n<ng-template #defaultItemsTemp let-data>\n  <ul class=\"devui-nav-sprite-menus\" *ngIf=\"menus?.length\">\n    <li\n      #items\n      *ngFor=\"let item of menus; let i = index\"\n      [style]=\"'text-indent:' + indent * (item?.level - 1) + 'em;'\"\n      [ngClass]=\"{ active: i === activeIndex }\"\n      (click)=\"navTo(i)\"\n    >\n      <ng-container [ngTemplateOutlet]=\"navItemTemplate\" [ngTemplateOutletContext]=\"{ item: item }\"></ng-container>\n    </li>\n  </ul>\n</ng-template>\n\n<!-- \u7CBE\u7075\u6A21\u5F0F\u6700\u5C0F\u5316\u6A21\u677F -->\n<ng-template #minTemp>\n  <div class=\"devui-sprite-min\" dTooltip [content]=\"title\">\n    <i class=\"icon-frame-contract\" (click)=\"open()\"></i>\n  </div>\n</ng-template>\n\n<!-- \u5355\u4E2A\u76EE\u5F55\u6A21\u677F -->\n<ng-template #defaultNavItemTemplate let-item=\"item\">\n  <div class=\"nav-item\" [title]=\"item?.label\">\n    <a [href]=\"item.href\" *ngIf=\"hashSupport\">{{ item?.label }}</a>\n    <span *ngIf=\"!hashSupport\">{{ item?.label }}</span>\n  </div>\n</ng-template>\n", styles: [".devui-font-size-base{font-size:12px;font-size:var(--devui-font-size, 12px)}.devui-font-base{font-size:12px;font-size:var(--devui-font-size, 12px);font-weight:400;line-height:1.5}.devui-font-size-modal-title{font-size:18px;font-size:var(--devui-font-size-modal-title, 18px)}.devui-font-modal-title{font-size:18px;font-size:var(--devui-font-size-modal-title, 18px);font-weight:700;line-height:1.5}.devui-font-size-page-title{font-size:16px;font-size:var(--devui-font-size-page-title, 16px)}.devui-font-page-title{font-size:16px;font-size:var(--devui-font-size-page-title, 16px);font-weight:700;line-height:1.5}.devui-font-size-secondary-title{font-size:14px;font-size:var(--devui-font-size-card-title, 14px)}.devui-font-secondary-title{font-size:14px;font-size:var(--devui-font-size-card-title, 14px);font-weight:700;line-height:1.5}.devui-is-sprite{background-color:#fff;background-color:var(--devui-connected-overlay-bg, #ffffff);box-shadow:0 2px 8px rgba(37,43,58,.2);box-shadow:var(--devui-shadow-connected-overlay, 0 2px 8px 0) var(--devui-shadow, rgba(37, 43, 58, .2));cursor:move;padding:0 16px 16px;max-width:300px}.devui-is-sprite.is-min{display:flex;align-items:center;justify-content:center;width:40px!important;height:40px!important;border-radius:100%;padding:0}.devui-is-sprite.is-min:hover{color:#fff;color:var(--devui-light-text, #ffffff);background-color:#5e7ce0;background-color:var(--devui-brand, #5e7ce0)}.devui-is-sprite.is-min i{cursor:pointer}.devui-is-sprite .devui-nav-sprite-menus{width:100%;height:100%;max-height:240px}.devui-nav-sprite-content{width:100%;height:100%;padding:0 12px 16px}.devui-nav-sprite-content .devui-nav-sprite-header{display:flex;align-items:center;justify-content:space-between;width:100%;color:#252b3a;color:var(--devui-text, #252b3a);line-height:32px;font-weight:700;font-size:14px;font-size:var(--devui-font-size-card-title, 14px);border-bottom:1px solid #f2f2f3;border-bottom:1px solid var(--devui-dividing-line, #f2f2f3)}.devui-nav-sprite-content .devui-nav-sprite-header .devui-nav-spiri-close{cursor:pointer}.devui-nav-sprite-menus{margin-top:10px;overflow-y:hidden;height:calc(100% - 80px)}.devui-nav-sprite-menus:hover{overflow-y:auto}.devui-nav-sprite-menus>li{list-style:none;cursor:pointer;height:30px;line-height:30px;font-size:12px;font-size:var(--devui-font-size, 12px);color:#252b3a;color:var(--devui-text, #252b3a);position:relative;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.devui-nav-sprite-menus>li a{color:#252b3a;color:var(--devui-text, #252b3a)}.devui-nav-sprite-menus>li.active{color:#526ecc;color:var(--devui-link, #526ecc)}.devui-nav-sprite-menus>li.active a{color:#526ecc;color:var(--devui-link, #526ecc)}.devui-nav-sprite-menus>li.active a:not(.open){font-weight:600}.devui-nav-sprite-menus>li.active:not(.open){font-weight:600}.devui-nav-sprite-menus>li:not(.disabled):hover{color:#526ecc;color:var(--devui-link, #526ecc)}.devui-nav-sprite-menus>li .nav-item a:hover,.devui-nav-sprite-menus>li .nav-item span:hover{color:#526ecc;color:var(--devui-link, #526ecc)}.devui-no-data{line-height:32px;color:#252b3a;color:var(--devui-text, #252b3a)}\n"], components: [{ type: i2.ButtonComponent, selector: "d-button", inputs: ["id", "type", "bsStyle", "shape", "bsSize", "bsPosition", "bordered", "icon", "disabled", "showLoading", "width", "autofocus", "loadingTemplateRef"], outputs: ["btnClick"] }], directives: [{ type: i3.NgTemplateOutlet, selector: "[ngTemplateOutlet]", inputs: ["ngTemplateOutletContext", "ngTemplateOutlet"] }, { type: i4.CdkDrag, selector: "[cdkDrag]", inputs: ["cdkDragData", "cdkDragLockAxis", "cdkDragRootElement", "cdkDragBoundary", "cdkDragStartDelay", "cdkDragFreeDragPosition", "cdkDragDisabled", "cdkDragConstrainPosition", "cdkDragPreviewClass", "cdkDragPreviewContainer"], outputs: ["cdkDragStarted", "cdkDragReleased", "cdkDragEnded", "cdkDragEntered", "cdkDragExited", "cdkDragDropped", "cdkDragMoved"], exportAs: ["cdkDrag"] }, { type: i3.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { type: i3.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { type: i3.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { type: i5.TooltipDirective, selector: "[dTooltip]", inputs: ["content", "position", "showAnimation", "showAnimate", "mouseEnterDelay", "mouseLeaveDelay"], exportAs: ["dTooltip"] }] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "13.1.3", ngImport: i0, type: NavSpriteComponent, decorators: [{
            type: Component,
            args: [{ selector: 'd-nav-sprite', template: "<ng-container [ngTemplateOutlet]=\"currentTemp\"></ng-container>\n\n<!-- \u7CBE\u7075\u6A21\u5F0F\u6A21\u677F -->\n<ng-template #spriteTemp>\n  <div\n    class=\"devui-nav-sprite-content\"\n    cdkDrag\n    [ngClass]=\"{ 'is-min': !isOpen }\"\n    (cdkDragStarted)=\"cdkDragStarted()\"\n    (cdkDragEnded)=\"cdkDragEnded()\"\n  >\n    <ng-container *ngIf=\"isOpen; else minTemp\">\n      <div class=\"devui-nav-sprite-header\">\n        <div class=\"devui-nav-sprite-header-title\">{{ title }}</div>\n        <d-button icon=\"icon-close\" bsStyle=\"text\" title=\"close\" (click)=\"hide()\"></d-button>\n      </div>\n      <ng-container [ngTemplateOutlet]=\"defaultItemsTemp\"></ng-container>\n    </ng-container>\n  </div>\n</ng-template>\n\n<!-- \u9ED8\u8BA4\u6A21\u677F -->\n<ng-template #defaultTemp>\n  <div class=\"devui-nav-sprite-content\">\n    <div class=\"devui-nav-sprite-header\">{{ title }}</div>\n    <ng-container [ngTemplateOutlet]=\"defaultItemsTemp\"></ng-container>\n  </div>\n</ng-template>\n\n<!-- \u76EE\u5F55\u5185\u5BB9\u6A21\u677F -->\n<ng-template #defaultItemsTemp let-data>\n  <ul class=\"devui-nav-sprite-menus\" *ngIf=\"menus?.length\">\n    <li\n      #items\n      *ngFor=\"let item of menus; let i = index\"\n      [style]=\"'text-indent:' + indent * (item?.level - 1) + 'em;'\"\n      [ngClass]=\"{ active: i === activeIndex }\"\n      (click)=\"navTo(i)\"\n    >\n      <ng-container [ngTemplateOutlet]=\"navItemTemplate\" [ngTemplateOutletContext]=\"{ item: item }\"></ng-container>\n    </li>\n  </ul>\n</ng-template>\n\n<!-- \u7CBE\u7075\u6A21\u5F0F\u6700\u5C0F\u5316\u6A21\u677F -->\n<ng-template #minTemp>\n  <div class=\"devui-sprite-min\" dTooltip [content]=\"title\">\n    <i class=\"icon-frame-contract\" (click)=\"open()\"></i>\n  </div>\n</ng-template>\n\n<!-- \u5355\u4E2A\u76EE\u5F55\u6A21\u677F -->\n<ng-template #defaultNavItemTemplate let-item=\"item\">\n  <div class=\"nav-item\" [title]=\"item?.label\">\n    <a [href]=\"item.href\" *ngIf=\"hashSupport\">{{ item?.label }}</a>\n    <span *ngIf=\"!hashSupport\">{{ item?.label }}</span>\n  </div>\n</ng-template>\n", styles: [".devui-font-size-base{font-size:12px;font-size:var(--devui-font-size, 12px)}.devui-font-base{font-size:12px;font-size:var(--devui-font-size, 12px);font-weight:400;line-height:1.5}.devui-font-size-modal-title{font-size:18px;font-size:var(--devui-font-size-modal-title, 18px)}.devui-font-modal-title{font-size:18px;font-size:var(--devui-font-size-modal-title, 18px);font-weight:700;line-height:1.5}.devui-font-size-page-title{font-size:16px;font-size:var(--devui-font-size-page-title, 16px)}.devui-font-page-title{font-size:16px;font-size:var(--devui-font-size-page-title, 16px);font-weight:700;line-height:1.5}.devui-font-size-secondary-title{font-size:14px;font-size:var(--devui-font-size-card-title, 14px)}.devui-font-secondary-title{font-size:14px;font-size:var(--devui-font-size-card-title, 14px);font-weight:700;line-height:1.5}.devui-is-sprite{background-color:#fff;background-color:var(--devui-connected-overlay-bg, #ffffff);box-shadow:0 2px 8px rgba(37,43,58,.2);box-shadow:var(--devui-shadow-connected-overlay, 0 2px 8px 0) var(--devui-shadow, rgba(37, 43, 58, .2));cursor:move;padding:0 16px 16px;max-width:300px}.devui-is-sprite.is-min{display:flex;align-items:center;justify-content:center;width:40px!important;height:40px!important;border-radius:100%;padding:0}.devui-is-sprite.is-min:hover{color:#fff;color:var(--devui-light-text, #ffffff);background-color:#5e7ce0;background-color:var(--devui-brand, #5e7ce0)}.devui-is-sprite.is-min i{cursor:pointer}.devui-is-sprite .devui-nav-sprite-menus{width:100%;height:100%;max-height:240px}.devui-nav-sprite-content{width:100%;height:100%;padding:0 12px 16px}.devui-nav-sprite-content .devui-nav-sprite-header{display:flex;align-items:center;justify-content:space-between;width:100%;color:#252b3a;color:var(--devui-text, #252b3a);line-height:32px;font-weight:700;font-size:14px;font-size:var(--devui-font-size-card-title, 14px);border-bottom:1px solid #f2f2f3;border-bottom:1px solid var(--devui-dividing-line, #f2f2f3)}.devui-nav-sprite-content .devui-nav-sprite-header .devui-nav-spiri-close{cursor:pointer}.devui-nav-sprite-menus{margin-top:10px;overflow-y:hidden;height:calc(100% - 80px)}.devui-nav-sprite-menus:hover{overflow-y:auto}.devui-nav-sprite-menus>li{list-style:none;cursor:pointer;height:30px;line-height:30px;font-size:12px;font-size:var(--devui-font-size, 12px);color:#252b3a;color:var(--devui-text, #252b3a);position:relative;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.devui-nav-sprite-menus>li a{color:#252b3a;color:var(--devui-text, #252b3a)}.devui-nav-sprite-menus>li.active{color:#526ecc;color:var(--devui-link, #526ecc)}.devui-nav-sprite-menus>li.active a{color:#526ecc;color:var(--devui-link, #526ecc)}.devui-nav-sprite-menus>li.active a:not(.open){font-weight:600}.devui-nav-sprite-menus>li.active:not(.open){font-weight:600}.devui-nav-sprite-menus>li:not(.disabled):hover{color:#526ecc;color:var(--devui-link, #526ecc)}.devui-nav-sprite-menus>li .nav-item a:hover,.devui-nav-sprite-menus>li .nav-item span:hover{color:#526ecc;color:var(--devui-link, #526ecc)}.devui-no-data{line-height:32px;color:#252b3a;color:var(--devui-text, #252b3a)}\n"] }]
        }], ctorParameters: function () { return [{ type: i0.Renderer2 }, { type: i0.ElementRef }, { type: i1.Router }, { type: i1.ActivatedRoute }, { type: i0.Renderer2 }, { type: i0.ChangeDetectorRef }, { type: undefined, decorators: [{
                    type: Inject,
                    args: [DOCUMENT]
                }] }]; }, propDecorators: { target: [{
                type: Input
            }], scrollTarget: [{
                type: Input
            }], view: [{
                type: Input
            }], hashSupport: [{
                type: Input
            }], mode: [{
                type: Input
            }], maxLevel: [{
                type: Input
            }], title: [{
                type: Input
            }], indent: [{
                type: Input
            }], width: [{
                type: Input
            }], height: [{
                type: Input
            }], isOpen: [{
                type: Input
            }], spriteOption: [{
                type: Input
            }], navItemTemplate: [{
                type: Input
            }], spriteTemp: [{
                type: ViewChild,
                args: ['spriteTemp', { static: true }]
            }], defaultTemp: [{
                type: ViewChild,
                args: ['defaultTemp', { static: true }]
            }], defaultNavItemTemplate: [{
                type: ViewChild,
                args: ['defaultNavItemTemplate', { static: true }]
            }], items: [{
                type: ViewChildren,
                args: ['items', { read: ElementRef }]
            }], afterNavInit: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmF2LXNwcml0ZS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9kZXZ1aS9uYXYtc3ByaXRlL25hdi1zcHJpdGUuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vZGV2dWkvbmF2LXNwcml0ZS9uYXYtc3ByaXRlLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUMzQyxPQUFPLEVBRUwsaUJBQWlCLEVBQ2pCLFNBQVMsRUFDVCxVQUFVLEVBQ1YsWUFBWSxFQUNaLE1BQU0sRUFDTixLQUFLLEVBR0wsTUFBTSxFQUNOLFNBQVMsRUFDVCxTQUFTLEVBQ1QsV0FBVyxFQUNYLFNBQVMsRUFDVCxZQUFZLEVBQ2IsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUN6RCxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDL0MsT0FBTyxFQUFFLFNBQVMsRUFBZ0IsTUFBTSxNQUFNLENBQUM7QUFDL0MsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLGdCQUFnQixDQUFDOzs7Ozs7O0FBRzlDLE1BQU0sZUFBZSxHQUFHO0lBQ3RCLEdBQUcsRUFBRSxLQUFLO0lBQ1YsSUFBSSxFQUFFLEtBQUs7SUFDWCxNQUFNLEVBQUUsQ0FBQztDQUNWLENBQUM7QUFPRixNQUFNLE9BQU8sa0JBQWtCO0lBMEU3QixZQUNVLE1BQWlCLEVBQ2pCLE9BQW1CLEVBQ25CLE1BQWMsRUFDZCxVQUEwQixFQUMxQixPQUFrQixFQUNsQixHQUFzQixFQUNKLEdBQVE7UUFOMUIsV0FBTSxHQUFOLE1BQU0sQ0FBVztRQUNqQixZQUFPLEdBQVAsT0FBTyxDQUFZO1FBQ25CLFdBQU0sR0FBTixNQUFNLENBQVE7UUFDZCxlQUFVLEdBQVYsVUFBVSxDQUFnQjtRQUMxQixZQUFP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QVE7NENBaEZULE1BQU07c0JBQWQsS0FBSztnQkFFRyxZQUFZO3NCQUFwQixLQUFLO2dCQUVHLElBQUk7c0JBQVosS0FBSztnQkFLRyxXQUFXO3NCQUFuQixLQUFLO2dCQUVHLElBQUk7c0JBQVosS0FBSztnQkFFRyxRQUFRO3NCQUFoQixLQUFLO2dCQUVHLEtBQUs7c0JBQWIsS0FBSztnQkFFRyxNQUFNO3NCQUFkLEtBQUs7Z0JBRUcsS0FBSztzQkFBYixLQUFLO2dCQUVHLE1BQU07c0JBQWQsS0FBSztnQkFFRyxNQUFNO3NCQUFkLEtBQUs7Z0JBRUcsWUFBWTtzQkFBcEIsS0FBSztnQkFFRyxlQUFlO3NCQUF2QixLQUFLO2dCQUVxQyxVQUFVO3NCQUFwRCxTQUFTO3VCQUFDLFlBQVksRUFBRSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUU7Z0JBRUcsV0FBVztzQkFBdEQsU0FBUzt1QkFBQyxhQUFhLEVBQUUsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFO2dCQUVhLHNCQUFzQjtzQkFBNUUsU0FBUzt1QkFBQyx3QkFBd0IsRUFBRSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUU7Z0JBR3JELEtBQUs7c0JBREosWUFBWTt1QkFBQyxPQUFPLEVBQUUsRUFBRSxJQUFJLEVBQUUsVUFBVSxFQUFFO2dCQUdqQyxZQUFZO3NCQUFyQixNQUFNIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRE9DVU1FTlQgfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xuaW1wb3J0IHtcbiAgQWZ0ZXJWaWV3SW5pdCxcbiAgQ2hhbmdlRGV0ZWN0b3JSZWYsXG4gIENvbXBvbmVudCxcbiAgRWxlbWVudFJlZixcbiAgRXZlbnRFbWl0dGVyLFxuICBJbmplY3QsXG4gIElucHV0LFxuICBPbkRlc3Ryb3ksXG4gIE9uSW5pdCxcbiAgT3V0cHV0LFxuICBRdWVyeUxpc3QsXG4gIFJlbmRlcmVyMixcbiAgVGVtcGxhdGVSZWYsXG4gIFZpZXdDaGlsZCxcbiAgVmlld0NoaWxkcmVuXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQWN0aXZhdGVkUm91dGUsIFJvdXRlciB9IGZyb20gJ0Bhbmd1bGFyL3JvdXRlcic7XG5pbXBvcnQgeyBzY3JvbGxBbmltYXRlIH0gZnJvbSAnbmctZGV2dWkvdXRpbHMnO1xuaW1wb3J0IHsgZnJvbUV2ZW50LCBTdWJzY3JpcHRpb24gfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IGRlYm91bmNlVGltZSB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7IE5hdk1lbnUsIFNwcml0ZU1vZGUsIFNwcml0ZU9wdGlvbiB9IGZyb20gJy4vbmF2LXNwcml0ZS50eXBlJztcblxuY29uc3QgREVGQVVMVF9PUFRJT05TID0ge1xuICB0b3A6ICczMCUnLFxuICBsZWZ0OiAnODAlJyxcbiAgekluZGV4OiAxLFxufTtcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnZC1uYXYtc3ByaXRlJyxcbiAgdGVtcGxhdGVVcmw6ICcuL25hdi1zcHJpdGUuY29tcG9uZW50Lmh0bWwnLFxuICBzdHlsZVVybHM6IFsnLi9uYXYtc3ByaXRlLmNvbXBvbmVudC5zY3NzJ10sXG59KVxuZXhwb3J0IGNsYXNzIE5hdlNwcml0ZUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgQWZ0ZXJWaWV3SW5pdCwgT25EZXN0cm95IHtcbiAgQElucHV0KCkgdGFyZ2V0OiBIVE1MRWxlbWVudDsgLy8g54is5Y+W55uu5b2V55qE5a655ZmoXG5cbiAgQElucHV0KCkgc2Nyb2xsVGFyZ2V0OiBIVE1MRWxlbWVudDsgLy8g5oyH5a6a5rua5Yqo55qERE9NXG5cbiAgQElucHV0KCkgdmlldzoge1xuICAgIHRvcD86IG51bWJlcjtcbiAgICBib3R0b20/OiBudW1iZXI7XG4gIH0gPSB7IHRvcDogMCwgYm90dG9tOiAwIH07IC8vIOefq+ato+WPguaVsFxuXG4gIEBJbnB1dCgpIGhhc2hTdXBwb3J0ID0gZmFsc2U7IC8vIOaUr+aMgemUmueCuVxuXG4gIEBJbnB1dCgpIG1vZGU6IFNwcml0ZU1vZGUgPSAnZGVmYXVsdCc7IC8vIOaooeW8j1xuXG4gIEBJbnB1dCgpIG1heExldmVsID0gMzsgLy8g5pyA5aSn5bGC57qnXG5cbiAgQElucHV0KCkgdGl0bGUgPSAnbWVudSc7IC8vIOWQjeensFxuXG4gIEBJbnB1dCgpIGluZGVudCA9IDI7IC8vIOe8qei/m1xuXG4gIEBJbnB1dCgpIHdpZHRoID0gMzAwOyAvLyDpq5jluqZcblxuICBASW5wdXQoKSBoZWlnaHQgPSA0MDA7IC8vIOmrmOW6plxuXG4gIEBJbnB1dCgpIGlzT3BlbiA9IHRydWU7IC8vIHNwcml0ZeaooeW8j+S4i+eahOWIneWni+eKtuaAgVxuXG4gIEBJbnB1dCgpIHNwcml0ZU9wdGlvbjogU3ByaXRlT3B0aW9uOyAvLyBzcHJpdGXmqKHlvI/kuIvnmoTliJ3lp4vkvY3nva5cblxuICBASW5wdXQoKSBuYXZJdGVtVGVtcGxhdGU6IFRlbXBsYXRlUmVmPGFueT47IC8vIOWvvOiIquebruW9leaooeadv1xuXG4gIEBWaWV3Q2hpbGQoJ3Nwcml0ZVRlbXAnLCB7IHN0YXRpYzogdHJ1ZSB9KSBzcHJpdGVUZW1wOiBUZW1wbGF0ZVJlZjxhbnk+O1xuXG4gIEBWaWV3Q2hpbGQoJ2RlZmF1bHRUZW1wJywgeyBzdGF0aWM6IHRydWUgfSkgZGVmYXVsdFRlbXA6IFRlbXBsYXRlUmVmPGFueT47XG5cbiAgQFZpZXdDaGlsZCgnZGVmYXVsdE5hdkl0ZW1UZW1wbGF0ZScsIHsgc3RhdGljOiB0cnVlIH0pIGRlZmF1bHROYXZJdGVtVGVtcGxhdGU6IFRlbXBsYXRlUmVmPGFueT47IC8vIOWNleadoeWvvOiIquebruW9leeahOm7mOiupOaooeadv1xuXG4gIEBWaWV3Q2hpbGRyZW4oJ2l0ZW1zJywgeyByZWFkOiBFbGVtZW50UmVmIH0pXG4gIGl0ZW1zITogUXVlcnlMaXN0PEVsZW1lbnRSZWY+O1xuXG4gIEBPdXRwdXQoKSBhZnRlck5hdkluaXQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7IC8vIOe7hOS7tuWIneWni+WMluWQjui/lOWbnue7hOS7tuWunuS+i1xuXG4gIGN1cnJlbnRUZW1wOiBUZW1wbGF0ZVJlZjxhbnk+O1xuXG4gIG1lbnVzOiBOYXZNZW51W10gPSBbXTtcblxuICBhY3RpdmVJbmRleCA9IC0xO1xuXG4gIGlzVG9WaWV3QnlOYXYgPSBmYWxzZTsgLy8g5Yy65YiG5piv6aG16Z2i5rua5Yqo6L+Y5piv54K55Ye755uu5b2V5LqL5Lu2XG5cbiAgaXRlbXNJbml0ID0gZmFsc2U7XG5cbiAgY29udGVudHM7XG5cbiAgdGFyZ2V0Q29udGFpbmVyOiBIVE1MRWxlbWVudDtcblxuICBzY3JvbGxTdWI6IFN1YnNjcmlwdGlvbjtcblxuICBpc0RyYWdnaW5nID0gZmFsc2U7XG5cbiAgbW91c2VlbnRlclN1YjogU3Vic2NyaXB0aW9uO1xuXG4gIGl0ZW1zU3ViOiBTdWJzY3JpcHRpb247XG5cbiAgdGltZUdhcCA9IDYwO1xuXG4gIGRvY3VtZW50OiBEb2N1bWVudDtcblxuICBnZXQgYmFzZVVybCgpIHtcbiAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIHJldHVybiAnJztcbiAgICB9XG4gICAgcmV0dXJuIHdpbmRvdy5sb2NhdGlvbi5ocmVmLnJlcGxhY2Uod2luZG93LmxvY2F0aW9uLmhhc2gsICcnKTtcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgcmVuZGVyOiBSZW5kZXJlcjIsXG4gICAgcHJpdmF0ZSBlbGVtZW50OiBFbGVtZW50UmVmLFxuICAgIHByaXZhdGUgcm91dGVyOiBSb3V0ZXIsXG4gICAgcHJpdmF0ZSBhY3RpdmVSb3V0OiBBY3RpdmF0ZWRSb3V0ZSxcbiAgICBwcml2YXRlIHJlbmRlcjI6IFJlbmRlcmVyMixcbiAgICBwcml2YXRlIGNkcjogQ2hhbmdlRGV0ZWN0b3JSZWYsXG4gICAgQEluamVjdChET0NVTUVOVCkgcHJpdmF0ZSBkb2M6IGFueVxuICApIHtcbiAgICB0aGlzLmRvY3VtZW50ID0gdGhpcy5kb2M7XG4gIH1cblxuICBuZ09uSW5pdCgpIHtcbiAgICB0aGlzLmN1cnJlbnRUZW1wID0gdGhpcy5tb2RlID09PSAnZGVmYXVsdCcgPyB0aGlzLmRlZmF1bHRUZW1wIDogdGhpcy5zcHJpdGVUZW1wOyAvLyDorr7nva7lvZPliY3nmoTmqKHlvI9cbiAgICB0aGlzLm5hdkl0ZW1UZW1wbGF0ZSA9IHRoaXMubmF2SXRlbVRlbXBsYXRlIHx8IHRoaXMuZGVmYXVsdE5hdkl0ZW1UZW1wbGF0ZTsgLy8g6K6+572u5b2T5YmN55qE55uu5b2V5qih5p2/XG4gICAgdGhpcy50YXJnZXRDb250YWluZXIgPSB0aGlzLnNjcm9sbFRhcmdldCB8fCB0aGlzLnRhcmdldDtcbiAgfVxuXG4gIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIGNvbnN0IGNvbnRhaW5lciA9IHRoaXMudGFyZ2V0Q29udGFpbmVyID09PSB0aGlzLmRvY3VtZW50LmRvY3VtZW50RWxlbWVudCA/IHdpbmRvdyA6IHRoaXMudGFyZ2V0Q29udGFpbmVyO1xuICAgICAgdGhpcy5zY3JvbGxTdWIgPSBmcm9tRXZlbnQoY29udGFpbmVyLCAnc2Nyb2xsJylcbiAgICAgICAgLnBpcGUoZGVib3VuY2VUaW1lKDMwMCkpXG4gICAgICAgIC5zdWJzY3JpYmUoKCkgPT4ge1xuICAgICAgICAgIHRoaXMuc2Nyb2xsRXZlbnRIYW5kbGVyKCk7XG4gICAgICAgIH0pO1xuICAgICAgdGhpcy5pdGVtc1N1YiA9IHRoaXMuaXRlbXMuY2hhbmdlcy5zdWJzY3JpYmUoKGl0ZW1zKSA9PiB7XG4gICAgICAgIGlmICghdGhpcy5pdGVtc0luaXQpIHtcbiAgICAgICAgICB0aGlzLml0ZW1zSW5pdCA9IHRydWU7XG4gICAgICAgICAgdGhpcy5zZXRBY3RpdmVNZW51KCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgdGhpcy5pbml0U3R5bGVzKCk7XG4gICAgfSwgMCk7XG4gIH1cblxuICBzZXRBY3RpdmVJbmRleCgpIHtcbiAgICBpZiAodGhpcy5oYXNoU3VwcG9ydCAmJiB0aGlzLmFjdGl2ZVJvdXQuc25hcHNob3QuZnJhZ21lbnQpIHtcbiAgICAgIHRoaXMuYWN0aXZlSW5kZXggPSB0aGlzLm1lbnVzLmZpbmRJbmRleCgobWVudSkgPT4ge1xuICAgICAgICByZXR1cm4gbWVudS5sYWJlbCA9PT0gdGhpcy5hY3RpdmVSb3V0LnNuYXBzaG90LmZyYWdtZW50O1xuICAgICAgfSk7XG4gICAgICB0aGlzLmlzVG9WaWV3QnlOYXYgPSB0cnVlO1xuICAgICAgc2Nyb2xsQW5pbWF0ZShcbiAgICAgICAgdGhpcy50YXJnZXRDb250YWluZXIsXG4gICAgICAgIHRoaXMudGFyZ2V0Q29udGFpbmVyLnNjcm9sbFRvcCxcbiAgICAgICAgdGhpcy5tZW51c1t0aGlzLmFjdGl2ZUluZGV4XT8uc2Nyb2xsUG9zaXRpb24/LnN0YXJ0TGluZSxcbiAgICAgICAgdW5kZWZpbmVkLFxuICAgICAgICB1bmRlZmluZWQsXG4gICAgICAgICgpID0+IHtcbiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuaXNUb1ZpZXdCeU5hdiA9IGZhbHNlO1xuICAgICAgICAgIH0sIDE2MCk7XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuYWN0aXZlSW5kZXggPSB0aGlzLm1lbnVzLmZpbmRJbmRleCgoaSkgPT4ge1xuICAgICAgICBjb25zdCBzY3JvbGxUb3AgPSB0aGlzLnRhcmdldENvbnRhaW5lci5zY3JvbGxUb3A7XG4gICAgICAgIHJldHVybiBzY3JvbGxUb3AgPCBpPy5zY3JvbGxQb3NpdGlvbi50b3A7XG4gICAgICB9KTtcbiAgICB9XG4gICAgdGhpcy5jZHIuZGV0ZWN0Q2hhbmdlcygpO1xuICB9XG5cbiAgZ2V0TmF2RGF0YShzZXRBY3RpdmUgPSB0cnVlKSB7XG4gICAgY29uc3Qgc2VhcmNoID0gW107XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm1heExldmVsOyBpKyspIHtcbiAgICAgIHNlYXJjaC5wdXNoKGBoJHtpICsgMX1gKTtcbiAgICB9XG4gICAgdGhpcy5jb250ZW50cyA9IEFycmF5LmZyb20odGhpcy50YXJnZXQucXVlcnlTZWxlY3RvckFsbChzZWFyY2guam9pbignLCcpKSk7XG4gICAgdGhpcy5tZW51cyA9IHRoaXMuY29udGVudHMubWFwKChpOiBIVE1MRWxlbWVudCkgPT4ge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgb3JpZ2luRWxlOiBpLFxuICAgICAgICBsZXZlbDogaS50YWdOYW1lLm1hdGNoKC9cXGQrLylbMF0sXG4gICAgICAgIGxhYmVsOiBpLmlubmVyVGV4dCxcbiAgICAgICAgaHJlZjogdGhpcy5iYXNlVXJsICsgJyMnICsgaS5pbm5lclRleHQsXG4gICAgICAgIHNjcm9sbFBvc2l0aW9uOiB0aGlzLmdldFNjcm9sbFBvc2l0aW9uKGkpLFxuICAgICAgfTtcbiAgICB9KTtcbiAgICBpZiAoc2V0QWN0aXZlKSB7XG4gICAgICB0aGlzLnNldEFjdGl2ZUluZGV4KCk7XG4gICAgfVxuICB9XG5cbiAgLy8g6K6+5a6a55uu5b2V6IyD5Zu0XG4gIGdldFNjcm9sbFBvc2l0aW9uKGVsZSkge1xuICAgIGNvbnN0IGNvbnRhaW5lclRvcCA9IE1hdGgubWF4KHRoaXMudGFyZ2V0Q29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcCwgMCk7XG4gICAgY29uc3QgY29udGFpbmVyU2Nyb2xsVG9wID0gdGhpcy50YXJnZXRDb250YWluZXIuc2Nyb2xsVG9wO1xuICAgIGNvbnN0IHRvcCA9IGVsZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5ib3R0b20gLSBjb250YWluZXJUb3AgKyBjb250YWluZXJTY3JvbGxUb3AgLSB0aGlzLnZpZXcudG9wICsgdGhpcy52aWV3LmJvdHRvbTtcbiAgICBjb25zdCBzdGFydExpbmUgPSBlbGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wIC0gY29udGFpbmVyVG9wICsgY29udGFpbmVyU2Nyb2xsVG9wIC0gdGhpcy52aWV3LnRvcCArIHRoaXMudmlldy5ib3R0b207XG4gICAgcmV0dXJuIHsgdG9wLCBzdGFydExpbmUgfTtcbiAgfVxuXG4gIC8vIOebkeWQrOmhtemdoua7muWKqFxuICBzY3JvbGxFdmVudEhhbmRsZXIoKSB7XG4gICAgaWYgKCF0aGlzLmlzVG9WaWV3QnlOYXYpIHtcbiAgICAgIGNvbnN0IHNjcm9sbFRvcCA9IHRoaXMudGFyZ2V0Q29udGFpbmVyLnNjcm9sbFRvcDtcbiAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5tZW51cy5maW5kSW5kZXgoKGVsZSwgaSkgPT4ge1xuICAgICAgICByZXR1cm4gc2Nyb2xsVG9wID49IGVsZS5zY3JvbGxQb3NpdGlvbi5zdGFydExpbmUgJiYgc2Nyb2xsVG9wIDwgdGhpcy5tZW51c1tpICsgMV0/LnNjcm9sbFBvc2l0aW9uLnN0YXJ0TGluZTtcbiAgICAgIH0pO1xuICAgICAgaWYgKGluZGV4ICE9PSAtMSAmJiB0aGlzLmFjdGl2ZUluZGV4ICE9PSBpbmRleCkge1xuICAgICAgICB0aGlzLmFjdGl2ZUluZGV4ID0gaW5kZXg7XG4gICAgICAgIHRoaXMubWVudVNjcm9sbFRvVGFyZ2V0KCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgbWVudVNjcm9sbFRvVGFyZ2V0KCkge1xuICAgIGNvbnN0IGl0ZW0gPSB0aGlzLml0ZW1zLnRvQXJyYXkoKVt0aGlzLmFjdGl2ZUluZGV4XTtcbiAgICBjb25zdCBtZW51Q29udGFpbmVyID0gdGhpcy5lbGVtZW50Lm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvcignLmRldnVpLW5hdi1zcHJpdGUtbWVudXMnKTtcbiAgICBjb25zdCBzdGFydCA9IG1lbnVDb250YWluZXI/LnNjcm9sbFRvcDtcbiAgICBjb25zdCBlbmQgPSBpdGVtPy5uYXRpdmVFbGVtZW50Py5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3AgKyBzdGFydCAtIG1lbnVDb250YWluZXI/LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcDtcbiAgICBzY3JvbGxBbmltYXRlKG1lbnVDb250YWluZXIsIHN0YXJ0LCBlbmQsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCAoKSA9PiB7XG4gICAgICBpZiAodGhpcy5oYXNoU3VwcG9ydCkge1xuICAgICAgICB0aGlzLnNldFVybEhhc2goKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHNldEFjdGl2ZU1lbnUoKSB7XG4gICAgY29uc3QgaXRlbSA9IHRoaXMuaXRlbXMudG9BcnJheSgpW3RoaXMuYWN0aXZlSW5kZXhdO1xuICAgIGNvbnN0IG1lbnVDb250YWluZXIgPSB0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZGV2dWktbmF2LXNwcml0ZS1tZW51cycpO1xuICAgIGNvbnN0IHRvcCA9IGl0ZW0/Lm5hdGl2ZUVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wIC0gbWVudUNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3A7XG4gICAgc2Nyb2xsQW5pbWF0ZShtZW51Q29udGFpbmVyLCBtZW51Q29udGFpbmVyLnNjcm9sbFRvcCwgdG9wLCB1bmRlZmluZWQsIHVuZGVmaW5lZCk7XG4gIH1cblxuICBpbml0U3R5bGVzKCkge1xuICAgIGlmICh0aGlzLm1vZGUgPT09ICdzcHJpdGUnKSB7XG4gICAgICBjb25zdCBjb250ZW50ID0gdGhpcy5lbGVtZW50Lm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvcignLmRldnVpLW5hdi1zcHJpdGUtY29udGVudCcpO1xuICAgICAgY29uc3Qgc3ByaXRlT3B0aW9ucyA9IHsgLi4uREVGQVVMVF9PUFRJT05TLCAuLi50aGlzLnNwcml0ZU9wdGlvbiB9O1xuICAgICAgdGhpcy5yZW5kZXIuYWRkQ2xhc3MoY29udGVudCwgJ2RldnVpLWlzLXNwcml0ZScpO1xuICAgICAgdGhpcy5yZW5kZXIuc2V0U3R5bGUoY29udGVudCwgJ3Bvc2l0aW9uJywgJ2ZpeGVkJyk7XG4gICAgICB0aGlzLnJlbmRlci5zZXRTdHlsZShjb250ZW50LCAndG9wJywgc3ByaXRlT3B0aW9ucy50b3ApO1xuICAgICAgdGhpcy5yZW5kZXIuc2V0U3R5bGUoY29udGVudCwgJ2xlZnQnLCBzcHJpdGVPcHRpb25zLmxlZnQpO1xuICAgICAgdGhpcy5yZW5kZXIuc2V0U3R5bGUoY29udGVudCwgJ3otaW5kZXgnLCBzcHJpdGVPcHRpb25zLnpJbmRleCk7XG4gICAgICB0aGlzLnJlbmRlci5zZXRTdHlsZShjb250ZW50LCAnaGVpZ2h0JywgdGhpcy5oZWlnaHQgKyAncHgnKTtcbiAgICAgIHRoaXMucmVuZGVyLnNldFN0eWxlKGNvbnRlbnQsICd3aWR0aCcsIHRoaXMud2lkdGggKyAncHgnKTtcbiAgICB9XG4gICAgdGhpcy5yZW5kZXIuc2V0U3R5bGUodGhpcy5lbGVtZW50Lm5hdGl2ZUVsZW1lbnQsICdoZWlnaHQnLCB0aGlzLmhlaWdodCArICdweCcpO1xuICAgIHRoaXMucmVuZGVyLnNldFN0eWxlKHRoaXMuZWxlbWVudC5uYXRpdmVFbGVtZW50LCAnd2lkdGgnLCB0aGlzLndpZHRoICsgJ3B4Jyk7XG4gICAgdGhpcy5hZnRlck5hdkluaXQuZW1pdCh0aGlzKTtcbiAgfVxuXG4gIC8vIOiuvue9rmhhc2hcbiAgc2V0VXJsSGFzaCgpIHtcbiAgICBjb25zdCBhY3RpdmVNZW51ID0gdGhpcy5tZW51c1t0aGlzLmFjdGl2ZUluZGV4XTtcbiAgICB0aGlzLnJvdXRlci5uYXZpZ2F0ZShbXSwgeyBmcmFnbWVudDogYWN0aXZlTWVudS5sYWJlbCwgcmVwbGFjZVVybDogdHJ1ZSB9KTtcbiAgfVxuXG4gIC8vIGFkZENsYXNzXG4gIHNldFRhcmdldEFjdGl2ZSgpIHtcbiAgICBjb25zdCB0YXJnZXQgPSB0aGlzLm1lbnVzW3RoaXMuYWN0aXZlSW5kZXhdO1xuICAgIHRoaXMubWVudXMuZm9yRWFjaCgoaSkgPT4ge1xuICAgICAgaWYgKGkub3JpZ2luRWxlKSB7XG4gICAgICAgIHRoaXMucmVuZGVyMi5yZW1vdmVDbGFzcyhpLm9yaWdpbkVsZSwgJ25hdi1hY3RpdmUnKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICB0aGlzLnJlbmRlcjIuYWRkQ2xhc3ModGFyZ2V0Py5vcmlnaW5FbGUsICduYXYtYWN0aXZlJyk7XG4gIH1cblxuICBuYXZUbyhpbmRleCkge1xuICAgIGlmICh0aGlzLmFjdGl2ZUluZGV4ICE9PSBpbmRleCkge1xuICAgICAgdGhpcy5hY3RpdmVJbmRleCA9IGluZGV4O1xuICAgICAgY29uc3QgdGFyZ2V0ID0gdGhpcy5tZW51c1tpbmRleF07XG4gICAgICBzY3JvbGxBbmltYXRlKHRoaXMudGFyZ2V0Q29udGFpbmVyLCB0aGlzLnRhcmdldENvbnRhaW5lci5zY3JvbGxUb3AsIHRhcmdldD8uc2Nyb2xsUG9zaXRpb24uc3RhcnRMaW5lLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgKCkgPT4ge1xuICAgICAgICB0aGlzLnNldFVybEhhc2goKTtcbiAgICAgICAgdGhpcy5zZXRUYXJnZXRBY3RpdmUoKTtcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgdGhpcy5pc1RvVmlld0J5TmF2ID0gZmFsc2U7XG4gICAgICAgIH0sIHRoaXMudGltZUdhcCk7XG4gICAgICB9KTtcbiAgICAgIHRoaXMuaXNUb1ZpZXdCeU5hdiA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgY2RrRHJhZ1N0YXJ0ZWQoKSB7XG4gICAgdGhpcy5pc0RyYWdnaW5nID0gdHJ1ZTtcbiAgfVxuXG4gIGNka0RyYWdFbmRlZCgpIHtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIHRoaXMuaXNEcmFnZ2luZyA9IGZhbHNlO1xuICAgIH0sIDEwMCk7XG4gIH1cblxuICBoaWRlKCkge1xuICAgIHRoaXMuaXNPcGVuID0gZmFsc2U7XG4gIH1cblxuICBvcGVuKCkge1xuICAgIGlmICh0aGlzLmlzRHJhZ2dpbmcpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5pc09wZW4gPSB0cnVlO1xuICB9XG5cbiAgbmdPbkRlc3Ryb3koKSB7XG4gICAgaWYgKHRoaXMuc2Nyb2xsU3ViKSB7XG4gICAgICB0aGlzLnNjcm9sbFN1Yi51bnN1YnNjcmliZSgpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLm1vdXNlZW50ZXJTdWIpIHtcbiAgICAgIHRoaXMubW91c2VlbnRlclN1Yi51bnN1YnNjcmliZSgpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLml0ZW1zU3ViKSB7XG4gICAgICB0aGlzLml0ZW1zU3ViLnVuc3Vic2NyaWJlKCk7XG4gICAgfVxuICB9XG59XG4iLCI8bmctY29udGFpbmVyIFtuZ1RlbXBsYXRlT3V0bGV0XT1cImN1cnJlbnRUZW1wXCI+PC9uZy1jb250YWluZXI+XG5cbjwhLS0g57K+54G15qih5byP5qih5p2/IC0tPlxuPG5nLXRlbXBsYXRlICNzcHJpdGVUZW1wPlxuICA8ZGl2XG4gICAgY2xhc3M9XCJkZXZ1aS1uYXYtc3ByaXRlLWNvbnRlbnRcIlxuICAgIGNka0RyYWdcbiAgICBbbmdDbGFzc109XCJ7ICdpcy1taW4nOiAhaXNPcGVuIH1cIlxuICAgIChjZGtEcmFnU3RhcnRlZCk9XCJjZGtEcmFnU3RhcnRlZCgpXCJcbiAgICAoY2RrRHJhZ0VuZGVkKT1cImNka0RyYWdFbmRlZCgpXCJcbiAgPlxuICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCJpc09wZW47IGVsc2UgbWluVGVtcFwiPlxuICAgICAgPGRpdiBjbGFzcz1cImRldnVpLW5hdi1zcHJpdGUtaGVhZGVyXCI+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJkZXZ1aS1uYXYtc3ByaXRlLWhlYWRlci10aXRsZVwiPnt7IHRpdGxlIH19PC9kaXY+XG4gICAgICAgIDxkLWJ1dHRvbiBpY29uPVwiaWNvbi1jbG9zZVwiIGJzU3R5bGU9XCJ0ZXh0XCIgdGl0bGU9XCJjbG9zZVwiIChjbGljayk9XCJoaWRlKClcIj48L2QtYnV0dG9uPlxuICAgICAgPC9kaXY+XG4gICAgICA8bmctY29udGFpbmVyIFtuZ1RlbXBsYXRlT3V0bGV0XT1cImRlZmF1bHRJdGVtc1RlbXBcIj48L25nLWNvbnRhaW5lcj5cbiAgICA8L25nLWNvbnRhaW5lcj5cbiAgPC9kaXY+XG48L25nLXRlbXBsYXRlPlxuXG48IS0tIOm7mOiupOaooeadvyAtLT5cbjxuZy10ZW1wbGF0ZSAjZGVmYXVsdFRlbXA+XG4gIDxkaXYgY2xhc3M9XCJkZXZ1aS1uYXYtc3ByaXRlLWNvbnRlbnRcIj5cbiAgICA8ZGl2IGNsYXNzPVwiZGV2dWktbmF2LXNwcml0ZS1oZWFkZXJcIj57eyB0aXRsZSB9fTwvZGl2PlxuICAgIDxuZy1jb250YWluZXIgW25nVGVtcGxhdGVPdXRsZXRdPVwiZGVmYXVsdEl0ZW1zVGVtcFwiPjwvbmctY29udGFpbmVyPlxuICA8L2Rpdj5cbjwvbmctdGVtcGxhdGU+XG5cbjwhLS0g55uu5b2V5YaF5a655qih5p2/IC0tPlxuPG5nLXRlbXBsYXRlICNkZWZhdWx0SXRlbXNUZW1wIGxldC1kYXRhPlxuICA8dWwgY2xhc3M9XCJkZXZ1aS1uYXYtc3ByaXRlLW1lbnVzXCIgKm5nSWY9XCJtZW51cz8ubGVuZ3RoXCI+XG4gICAgPGxpXG4gICAgICAjaXRlbXNcbiAgICAgICpuZ0Zvcj1cImxldCBpdGVtIG9mIG1lbnVzOyBsZXQgaSA9IGluZGV4XCJcbiAgICAgIFtzdHlsZV09XCIndGV4dC1pbmRlbnQ6JyArIGluZGVudCAqIChpdGVtPy5sZXZlbCAtIDEpICsgJ2VtOydcIlxuICAgICAgW25nQ2xhc3NdPVwieyBhY3RpdmU6IGkgPT09IGFjdGl2ZUluZGV4IH1cIlxuICAgICAgKGNsaWNrKT1cIm5hdlRvKGkpXCJcbiAgICA+XG4gICAgICA8bmctY29udGFpbmVyIFtuZ1RlbXBsYXRlT3V0bGV0XT1cIm5hdkl0ZW1UZW1wbGF0ZVwiIFtuZ1RlbXBsYXRlT3V0bGV0Q29udGV4dF09XCJ7IGl0ZW06IGl0ZW0gfVwiPjwvbmctY29udGFpbmVyPlxuICAgIDwvbGk+XG4gIDwvdWw+XG48L25nLXRlbXBsYXRlPlxuXG48IS0tIOeyvueBteaooeW8j+acgOWwj+WMluaooeadvyAtLT5cbjxuZy10ZW1wbGF0ZSAjbWluVGVtcD5cbiAgPGRpdiBjbGFzcz1cImRldnVpLXNwcml0ZS1taW5cIiBkVG9vbHRpcCBbY29udGVudF09XCJ0aXRsZVwiPlxuICAgIDxpIGNsYXNzPVwiaWNvbi1mcmFtZS1jb250cmFjdFwiIChjbGljayk9XCJvcGVuKClcIj48L2k+XG4gIDwvZGl2PlxuPC9uZy10ZW1wbGF0ZT5cblxuPCEtLSDljZXkuKrnm67lvZXmqKHmnb8gLS0+XG48bmctdGVtcGxhdGUgI2RlZmF1bHROYXZJdGVtVGVtcGxhdGUgbGV0LWl0ZW09XCJpdGVtXCI+XG4gIDxkaXYgY2xhc3M9XCJuYXYtaXRlbVwiIFt0aXRsZV09XCJpdGVtPy5sYWJlbFwiPlxuICAgIDxhIFtocmVmXT1cIml0ZW0uaHJlZlwiICpuZ0lmPVwiaGFzaFN1cHBvcnRcIj57eyBpdGVtPy5sYWJlbCB9fTwvYT5cbiAgICA8c3BhbiAqbmdJZj1cIiFoYXNoU3VwcG9ydFwiPnt7IGl0ZW0/LmxhYmVsIH19PC9zcGFuPlxuICA8L2Rpdj5cbjwvbmctdGVtcGxhdGU+XG4iXX0=