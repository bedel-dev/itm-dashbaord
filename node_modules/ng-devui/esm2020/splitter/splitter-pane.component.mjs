import { ChangeDetectionStrategy, Component, ElementRef, EventEmitter, HostBinding, Input, Output, Renderer2 } from '@angular/core';
import { SplitterService } from './splitter.service';
import * as i0 from "@angular/core";
import * as i1 from "./splitter.service";
export class SplitterPaneComponent {
    constructor(splitter, el, renderer) {
        this.splitter = splitter;
        this.el = el;
        this.renderer = renderer;
        // 当前panel是否可调整大小
        this.resizable = true;
        // 面板是否可折叠
        this.collapsible = false;
        // 是否折叠收缩
        this.shrink = false;
        // 折叠收缩后宽度
        this.shrinkWidth = 36;
        // 面板初始化是否折叠，默认不折叠
        this._collapsed = false;
        // 非边缘面板折叠方向，before只生成向前折叠的按钮，after生成向后折叠按钮，both生成两个
        this.collapseDirection = 'both';
        // 大小改变事件
        this.sizeChange = new EventEmitter();
        // 收起和展开事件
        this.collapsedChange = new EventEmitter();
        // 收缩和展开事件
        this.shrinkStatusChange = new EventEmitter();
        this.paneClass = true;
        this._order = 0; // flex布局下pane位置
        this.element = this.el.nativeElement;
    }
    set collapsed(newCollapsed) {
        if (this._collapsed !== newCollapsed) {
            this._collapsed = newCollapsed;
            this.splitter.paneChangeSubject.next(true);
        }
    }
    get collapsed() {
        return this._collapsed;
    }
    set size(newSize) {
        this._size = newSize;
        this.widthBeforeShrink = newSize;
        this.renderer.setStyle(this.element, 'flex-basis', newSize);
        const paneFixedClass = 'devui-splitter-pane-fixed';
        if (this.size) {
            // 设置 flex-grow 和 flex-shrink
            this.renderer.addClass(this.element, paneFixedClass);
        }
        else {
            this.renderer.removeClass(this.element, paneFixedClass);
        }
    }
    get size() {
        return this._size;
    }
    set order(paneOrder) {
        this._order = paneOrder;
        this.setOrderStyles();
    }
    get order() {
        return this._order;
    }
    ngOnChanges(changes) {
        if ((changes.collapsible && !changes.collapsible.isFirstChange()) || (changes.resizable && !changes.resizable.isFirstChange())) {
            this.splitter.paneChangeSubject.next(true);
        }
    }
    // 设置order
    setOrderStyles() {
        this.renderer.setStyle(this.element, 'order', this.order);
    }
    // 获取当前pane大小
    get computedSize() {
        if (this.orientation === 'vertical') {
            return this.element.offsetHeight;
        }
        else {
            return this.element.offsetWidth;
        }
    }
    // 收起时隐藏当前pane
    toggleCollapseClass() {
        const paneHiddenClass = 'devui-splitter-pane-hidden';
        if (!this._collapsed) {
            this.renderer.removeClass(this.element, paneHiddenClass);
        }
        else {
            this.renderer.addClass(this.element, paneHiddenClass);
        }
        if (this._collapsed && this.shrink) {
            this.renderer.removeClass(this.element, paneHiddenClass);
            this.renderer.setStyle(this.element, 'flex-basis', `${this.shrinkWidth}px`);
            this.shrinkStatusChange.emit(true);
        }
        else {
            this.renderer.setStyle(this.element, 'flex-basis', this.widthBeforeShrink);
            this.shrinkStatusChange.emit(false);
        }
    }
    // 收起时用于改变相邻pane的flex-grow属性来改变非自适应pane的size
    toggleNearPaneFlexGrow(collapsed) {
        const flexGrowClass = 'devui-splitter-pane-grow';
        const hasFlexGrowClass = this.element.classList.contains(flexGrowClass);
        if (hasFlexGrowClass) {
            this.renderer.removeClass(this.element, flexGrowClass);
        }
        else if (collapsed) {
            this.renderer.addClass(this.element, flexGrowClass);
        }
    }
    ngAfterViewChecked() {
        // 视图检查完对resizeable pane设置flex属性
        if (!this.size && !this.resizable) {
            this.renderer.addClass(this.element, 'devui-splitter-pane-fixed');
        }
    }
}
SplitterPaneComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "13.1.3", ngImport: i0, type: SplitterPaneComponent, deps: [{ token: i1.SplitterService }, { token: i0.ElementRef }, { token: i0.Renderer2 }], target: i0.ɵɵFactoryTarget.Component });
SplitterPaneComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "13.1.3", type: SplitterPaneComponent, selector: "d-splitter-pane", inputs: { minSize: "minSize", maxSize: "maxSize", resizable: "resizable", collapsible: "collapsible", shrink: "shrink", shrinkWidth: "shrinkWidth", collapsed: "collapsed", collapseDirection: "collapseDirection", size: "size" }, outputs: { sizeChange: "sizeChange", collapsedChange: "collapsedChange", shrinkStatusChange: "shrinkStatusChange" }, host: { properties: { "class.devui-splitter-pane": "this.paneClass" } }, usesOnChanges: true, ngImport: i0, template: "<ng-content></ng-content>\n", styles: [":host.devui-splitter-pane{position:relative;flex:1 1 auto;display:block;min-width:0;max-width:100%;min-height:0;max-height:100%}:host.devui-splitter-pane-fixed{flex-grow:0;flex-shrink:0}:host.devui-splitter-pane-hidden{flex:0!important;overflow:hidden!important}:host.devui-splitter-pane-grow{flex-grow:1!important}\n"], changeDetection: i0.ChangeDetectionStrategy.OnPush });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "13.1.3", ngImport: i0, type: SplitterPaneComponent, decorators: [{
            type: Component,
            args: [{ selector: 'd-splitter-pane', changeDetection: ChangeDetectionStrategy.OnPush, preserveWhitespaces: false, template: "<ng-content></ng-content>\n", styles: [":host.devui-splitter-pane{position:relative;flex:1 1 auto;display:block;min-width:0;max-width:100%;min-height:0;max-height:100%}:host.devui-splitter-pane-fixed{flex-grow:0;flex-shrink:0}:host.devui-splitter-pane-hidden{flex:0!important;overflow:hidden!important}:host.devui-splitter-pane-grow{flex-grow:1!important}\n"] }]
        }], ctorParameters: function () { return [{ type: i1.SplitterService }, { type: i0.ElementRef }, { type: i0.Renderer2 }]; }, propDecorators: { minSize: [{
                type: Input
            }], maxSize: [{
                type: Input
            }], resizable: [{
                type: Input
            }], collapsible: [{
                type: Input
            }], shrink: [{
                type: Input
            }], shrinkWidth: [{
                type: Input
            }], collapsed: [{
                type: Input
            }], collapseDirection: [{
                type: Input
            }], size: [{
                type: Input
            }], sizeChange: [{
                type: Output
            }], collapsedChange: [{
                type: Output
            }], shrinkStatusChange: [{
                type: Output
            }], paneClass: [{
                type: HostBinding,
                args: ['class.devui-splitter-pane']
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3BsaXR0ZXItcGFuZS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9kZXZ1aS9zcGxpdHRlci9zcGxpdHRlci1wYW5lLmNvbXBvbmVudC50cyIsIi4uLy4uLy4uL2RldnVpL3NwbGl0dGVyL3NwbGl0dGVyLXBhbmUuY29tcG9uZW50Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUNhLHVCQUF1QixFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsWUFBWSxFQUM5RSxXQUFXLEVBQUUsS0FBSyxFQUFhLE1BQU0sRUFBRSxTQUFTLEVBQ2pELE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQzs7O0FBVXJELE1BQU0sT0FBTyxxQkFBcUI7SUFxRWhDLFlBQW9CLFFBQXlCLEVBQVUsRUFBYyxFQUFVLFFBQW1CO1FBQTlFLGFBQVEsR0FBUixRQUFRLENBQWlCO1FBQVUsT0FBRSxHQUFGLEVBQUUsQ0FBWTtRQUFVLGFBQVEsR0FBUixRQUFRLENBQVc7UUFoRWxHLGlCQUFpQjtRQUNSLGNBQVMsR0FBRyxJQUFJLENBQUM7UUFDMUIsVUFBVTtRQUNELGdCQUFXLEdBQUcsS0FBSyxDQUFDO1FBQzdCLFNBQVM7UUFDQSxXQUFNLEdBQUcsS0FBSyxDQUFDO1FBQ3hCLFVBQVU7UUFDRCxnQkFBVyxHQUFHLEVBQUUsQ0FBQztRQUMxQixrQkFBa0I7UUFDbEIsZUFBVSxHQUFHLEtBQUssQ0FBQztRQVduQixvREFBb0Q7UUFDM0Msc0JBQWlCLEdBQXNCLE1BQU0sQ0FBQztRQW9CdkQsU0FBUztRQUNDLGVBQVUsR0FBRyxJQUFJLFlBQVksRUFBTyxDQUFDO1FBRS9DLFVBQVU7UUFDQSxvQkFBZSxHQUFHLElBQUksWUFBWSxFQUFPLENBQUM7UUFFcEQsVUFBVTtRQUNBLHVCQUFrQixHQUFHLElBQUksWUFBWSxFQUFXLENBQUM7UUFFakIsY0FBUyxHQUFHLElBQUks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QUMsSUFBSSxDQUFDLE9BQU8sRUFBRSwyQkFBMkIsQ0FBQyxDQUFDO1NBQ25FO0lBQ0gsQ0FBQzs7a0hBaklVLHFCQUFxQjtzR0FBckIscUJBQXFCLDhlQ2RsQyw2QkFDQTsyRkRhYSxxQkFBcUI7a0JBUmpDLFNBQVM7K0JBQ0UsaUJBQWlCLG1CQUdWLHVCQUF1QixDQUFDLE1BQU0sdUJBQzFCLEtBQUs7dUpBS2pCLE9BQU87c0JBQWYsS0FBSztnQkFFRyxPQUFPO3NCQUFmLEtBQUs7Z0JBRUcsU0FBUztzQkFBakIsS0FBSztnQkFFRyxXQUFXO3NCQUFuQixLQUFLO2dCQUVHLE1BQU07c0JBQWQsS0FBSztnQkFFRyxXQUFXO3NCQUFuQixLQUFLO2dCQUlGLFNBQVM7c0JBRFosS0FBSztnQkFXRyxpQkFBaUI7c0JBQXpCLEtBQUs7Z0JBS0YsSUFBSTtzQkFEUCxLQUFLO2dCQWlCSSxVQUFVO3NCQUFuQixNQUFNO2dCQUdHLGVBQWU7c0JBQXhCLE1BQU07Z0JBR0csa0JBQWtCO3NCQUEzQixNQUFNO2dCQUVtQyxTQUFTO3NCQUFsRCxXQUFXO3VCQUFDLDJCQUEyQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIEFmdGVyVmlld0NoZWNrZWQsIENoYW5nZURldGVjdGlvblN0cmF0ZWd5LCBDb21wb25lbnQsIEVsZW1lbnRSZWYsIEV2ZW50RW1pdHRlcixcbiAgSG9zdEJpbmRpbmcsIElucHV0LCBPbkNoYW5nZXMsIE91dHB1dCwgUmVuZGVyZXIyLCBTaW1wbGVDaGFuZ2VzXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgU3BsaXR0ZXJTZXJ2aWNlIH0gZnJvbSAnLi9zcGxpdHRlci5zZXJ2aWNlJztcbmltcG9ydCB7IENvbGxhcHNlRGlyZWN0aW9uLCBTcGxpdHRlck9yaWVudGF0aW9uIH0gZnJvbSAnLi9zcGxpdHRlci50eXBlcyc7XG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdkLXNwbGl0dGVyLXBhbmUnLFxuICB0ZW1wbGF0ZVVybDogJy4vc3BsaXR0ZXItcGFuZS5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWycuL3NwbGl0dGVyLXBhbmUuY29tcG9uZW50LnNjc3MnXSxcbiAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2gsXG4gIHByZXNlcnZlV2hpdGVzcGFjZXM6IGZhbHNlLFxufSlcblxuZXhwb3J0IGNsYXNzIFNwbGl0dGVyUGFuZUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uQ2hhbmdlcywgQWZ0ZXJWaWV3Q2hlY2tlZCB7XG4gIC8vIHBhbmXnmoTmnIDlsI/lgLxcbiAgQElucHV0KCkgbWluU2l6ZTogc3RyaW5nO1xuICAvLyBwYW5l55qE5pyA5aSn5YC8XG4gIEBJbnB1dCgpIG1heFNpemU6IHN0cmluZztcbiAgLy8g5b2T5YmNcGFuZWzmmK/lkKblj6/osIPmlbTlpKflsI9cbiAgQElucHV0KCkgcmVzaXphYmxlID0gdHJ1ZTtcbiAgLy8g6Z2i5p2/5piv5ZCm5Y+v5oqY5Y+gXG4gIEBJbnB1dCgpIGNvbGxhcHNpYmxlID0gZmFsc2U7XG4gIC8vIOaYr+WQpuaKmOWPoOaUtue8qVxuICBASW5wdXQoKSBzaHJpbmsgPSBmYWxzZTtcbiAgLy8g5oqY5Y+g5pS257yp5ZCO5a695bqmXG4gIEBJbnB1dCgpIHNocmlua1dpZHRoID0gMzY7XG4gIC8vIOmdouadv+WIneWni+WMluaYr+WQpuaKmOWPoO+8jOm7mOiupOS4jeaKmOWPoFxuICBfY29sbGFwc2VkID0gZmFsc2U7XG4gIEBJbnB1dCgpXG4gIHNldCBjb2xsYXBzZWQobmV3Q29sbGFwc2VkKSB7XG4gICAgaWYgKHRoaXMuX2NvbGxhcHNlZCAhPT0gbmV3Q29sbGFwc2VkKSB7XG4gICAgICB0aGlzLl9jb2xsYXBzZWQgPSBuZXdDb2xsYXBzZWQ7XG4gICAgICB0aGlzLnNwbGl0dGVyLnBhbmVDaGFuZ2VTdWJqZWN0Lm5leHQodHJ1ZSk7XG4gICAgfVxuICB9XG4gIGdldCBjb2xsYXBzZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2NvbGxhcHNlZDtcbiAgfVxuICAvLyDpnZ7ovrnnvJjpnaLmnb/mipjlj6DmlrnlkJHvvIxiZWZvcmXlj6rnlJ/miJDlkJHliY3mipjlj6DnmoTmjInpkq7vvIxhZnRlcueUn+aIkOWQkeWQjuaKmOWPoOaMiemSru+8jGJvdGjnlJ/miJDkuKTkuKpcbiAgQElucHV0KCkgY29sbGFwc2VEaXJlY3Rpb246IENvbGxhcHNlRGlyZWN0aW9uID0gJ2JvdGgnO1xuICB3aWR0aEJlZm9yZVNocmluaztcbiAgLy8gcGFuZeWIneWni+WMluWkp+Wwj1xuICBfc2l6ZTtcbiAgQElucHV0KClcbiAgc2V0IHNpemUobmV3U2l6ZSkge1xuICAgIHRoaXMuX3NpemUgPSBuZXdTaXplO1xuICAgIHRoaXMud2lkdGhCZWZvcmVTaHJpbmsgPSBuZXdTaXplO1xuICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUodGhpcy5lbGVtZW50LCAnZmxleC1iYXNpcycsIG5ld1NpemUpO1xuICAgIGNvbnN0IHBhbmVGaXhlZENsYXNzID0gJ2RldnVpLXNwbGl0dGVyLXBhbmUtZml4ZWQnO1xuICAgIGlmICh0aGlzLnNpemUpIHtcbiAgICAgIC8vIOiuvue9riBmbGV4LWdyb3cg5ZKMIGZsZXgtc2hyaW5rXG4gICAgICB0aGlzLnJlbmRlcmVyLmFkZENsYXNzKHRoaXMuZWxlbWVudCwgcGFuZUZpeGVkQ2xhc3MpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnJlbmRlcmVyLnJlbW92ZUNsYXNzKHRoaXMuZWxlbWVudCwgcGFuZUZpeGVkQ2xhc3MpO1xuICAgIH1cbiAgfVxuICBnZXQgc2l6ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5fc2l6ZTtcbiAgfVxuICAvLyDlpKflsI/mlLnlj5jkuovku7ZcbiAgQE91dHB1dCgpIHNpemVDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcblxuICAvLyDmlLbotbflkozlsZXlvIDkuovku7ZcbiAgQE91dHB1dCgpIGNvbGxhcHNlZENoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuXG4gIC8vIOaUtue8qeWSjOWxleW8gOS6i+S7tlxuICBAT3V0cHV0KCkgc2hyaW5rU3RhdHVzQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcjxib29sZWFuPigpO1xuXG4gIEBIb3N0QmluZGluZygnY2xhc3MuZGV2dWktc3BsaXR0ZXItcGFuZScpIHBhbmVDbGFzcyA9IHRydWU7XG5cbiAgb3JpZW50YXRpb246IFNwbGl0dGVyT3JpZW50YXRpb247IC8vIOWIhuWJsuadoeaWueWQkVxuICBfb3JkZXIgPSAwOyAvLyBmbGV45biD5bGA5LiLcGFuZeS9jee9rlxuICBlbGVtZW50OyAvLyBuYXRpdmVFbGVtZW505Y+l5p+EXG5cbiAgc2V0IG9yZGVyKHBhbmVPcmRlcikge1xuICAgIHRoaXMuX29yZGVyID0gcGFuZU9yZGVyO1xuICAgIHRoaXMuc2V0T3JkZXJTdHlsZXMoKTtcbiAgfVxuICBnZXQgb3JkZXIoKSB7XG4gICAgcmV0dXJuIHRoaXMuX29yZGVyO1xuICB9XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSBzcGxpdHRlcjogU3BsaXR0ZXJTZXJ2aWNlLCBwcml2YXRlIGVsOiBFbGVtZW50UmVmLCBwcml2YXRlIHJlbmRlcmVyOiBSZW5kZXJlcjIpIHtcbiAgICB0aGlzLmVsZW1lbnQgPSB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQ7XG4gIH1cblxuICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKSB7XG4gICAgaWYgKChjaGFuZ2VzLmNvbGxhcHNpYmxlICYmICFjaGFuZ2VzLmNvbGxhcHNpYmxlLmlzRmlyc3RDaGFuZ2UoKSkgfHwgKGNoYW5nZXMucmVzaXphYmxlICYmICFjaGFuZ2VzLnJlc2l6YWJsZS5pc0ZpcnN0Q2hhbmdlKCkpKSB7XG4gICAgICB0aGlzLnNwbGl0dGVyLnBhbmVDaGFuZ2VTdWJqZWN0Lm5leHQodHJ1ZSk7XG4gICAgfVxuICB9XG5cbiAgLy8g6K6+572ub3JkZXJcbiAgc2V0T3JkZXJTdHlsZXMoKSB7XG4gICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZSh0aGlzLmVsZW1lbnQsICdvcmRlcicsIHRoaXMub3JkZXIpO1xuICB9XG5cbiAgLy8g6I635Y+W5b2T5YmNcGFuZeWkp+Wwj1xuICBnZXQgY29tcHV0ZWRTaXplKCkge1xuICAgIGlmICh0aGlzLm9yaWVudGF0aW9uID09PSAndmVydGljYWwnKSB7XG4gICAgICByZXR1cm4gdGhpcy5lbGVtZW50Lm9mZnNldEhlaWdodDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHRoaXMuZWxlbWVudC5vZmZzZXRXaWR0aDtcbiAgICB9XG4gIH1cblxuICAvLyDmlLbotbfml7bpmpDol4/lvZPliY1wYW5lXG4gIHRvZ2dsZUNvbGxhcHNlQ2xhc3MoKSB7XG4gICAgY29uc3QgcGFuZUhpZGRlbkNsYXNzID0gJ2RldnVpLXNwbGl0dGVyLXBhbmUtaGlkZGVuJztcblxuICAgIGlmICghdGhpcy5fY29sbGFwc2VkKSB7XG4gICAgICB0aGlzLnJlbmRlcmVyLnJlbW92ZUNsYXNzKHRoaXMuZWxlbWVudCwgcGFuZUhpZGRlbkNsYXNzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5yZW5kZXJlci5hZGRDbGFzcyh0aGlzLmVsZW1lbnQsIHBhbmVIaWRkZW5DbGFzcyk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuX2NvbGxhcHNlZCAmJiB0aGlzLnNocmluaykge1xuICAgICAgdGhpcy5yZW5kZXJlci5yZW1vdmVDbGFzcyh0aGlzLmVsZW1lbnQsIHBhbmVIaWRkZW5DbGFzcyk7XG4gICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKHRoaXMuZWxlbWVudCwgJ2ZsZXgtYmFzaXMnLCBgJHt0aGlzLnNocmlua1dpZHRofXB4YCk7XG4gICAgICB0aGlzLnNocmlua1N0YXR1c0NoYW5nZS5lbWl0KHRydWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKHRoaXMuZWxlbWVudCwgJ2ZsZXgtYmFzaXMnLCB0aGlzLndpZHRoQmVmb3JlU2hyaW5rKTtcbiAgICAgIHRoaXMuc2hyaW5rU3RhdHVzQ2hhbmdlLmVtaXQoZmFsc2UpO1xuICAgIH1cbiAgfVxuXG4gIC8vIOaUtui1t+aXtueUqOS6juaUueWPmOebuOmCu3BhbmXnmoRmbGV4LWdyb3flsZ7mgKfmnaXmlLnlj5jpnZ7oh6rpgILlupRwYW5l55qEc2l6ZVxuICB0b2dnbGVOZWFyUGFuZUZsZXhHcm93KGNvbGxhcHNlZCkge1xuICAgIGNvbnN0IGZsZXhHcm93Q2xhc3MgPSAnZGV2dWktc3BsaXR0ZXItcGFuZS1ncm93JztcbiAgICBjb25zdCBoYXNGbGV4R3Jvd0NsYXNzID0gdGhpcy5lbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhmbGV4R3Jvd0NsYXNzKTtcbiAgICBpZiAoaGFzRmxleEdyb3dDbGFzcykge1xuICAgICAgdGhpcy5yZW5kZXJlci5yZW1vdmVDbGFzcyh0aGlzLmVsZW1lbnQsIGZsZXhHcm93Q2xhc3MpO1xuICAgIH0gZWxzZSBpZiAoY29sbGFwc2VkKSB7XG4gICAgICB0aGlzLnJlbmRlcmVyLmFkZENsYXNzKHRoaXMuZWxlbWVudCwgZmxleEdyb3dDbGFzcyk7XG4gICAgfVxuICB9XG5cbiAgbmdBZnRlclZpZXdDaGVja2VkKCkge1xuICAgIC8vIOinhuWbvuajgOafpeWujOWvuXJlc2l6ZWFibGUgcGFuZeiuvue9rmZsZXjlsZ7mgKdcbiAgICBpZiAoIXRoaXMuc2l6ZSAmJiAhdGhpcy5yZXNpemFibGUpIHtcbiAgICAgIHRoaXMucmVuZGVyZXIuYWRkQ2xhc3ModGhpcy5lbGVtZW50LCAnZGV2dWktc3BsaXR0ZXItcGFuZS1maXhlZCcpO1xuICAgIH1cbiAgfVxufVxuIiwiPG5nLWNvbnRlbnQ+PC9uZy1jb250ZW50PlxuIl19