import { Component, ContentChildren, EventEmitter, forwardRef, HostListener, Input, Output, QueryList } from '@angular/core';
import { NG_VALUE_ACCESSOR } from '@angular/forms';
import { RadioComponent } from './radio.component';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common";
export class RadioGroupComponent {
    constructor() {
        this.change = new EventEmitter();
        this.radios = new QueryList();
    }
    /**
     * @deprecated Use direction to replace.
     */
    set cssStyle(direction) {
        this.direction = direction;
    }
    onRadioChange(event) {
        if (event.target.tagName.toLowerCase() === 'input') {
            if (this.disabled) {
                event.preventDefault();
            }
            this.canChange().then((change) => {
                if (!change) {
                    event.preventDefault();
                }
            });
        }
    }
    ngAfterViewInit() {
        this.radios.forEach((radio) => {
            this.registerRadio(radio);
        });
        this.radios.changes.subscribe((newRadios) => {
            newRadios.forEach((radio) => {
                this.registerRadio(radio);
                Promise.resolve(true).then(() => radio.writeValue(this._value));
            });
        });
        this.radios.notifyOnChanges();
    }
    ngOnChanges(changes) {
        if (changes && changes.name && this.radios) {
            this.radios.forEach((radio) => {
                radio.name = this.name;
            });
        }
        if (changes && changes.disabled && this.radios) {
            this.radios.forEach((radio) => {
                radio.disabled = this.disabled;
            });
        }
        if (changes && this.radios) {
            this.radios.forEach((radio) => {
                radio.disabled = this.disabled;
            });
        }
    }
    registerRadio(radio) {
        radio.registerOnChange((value) => {
            this.writeValue(value);
            this.onChange(value);
            Promise.resolve().then(() => this.onTouched());
            this.change.emit(value);
        });
    }
    canChange() {
        let changeResult = Promise.resolve(true);
        if (this.beforeChange) {
            const result = this.beforeChange(this.values);
            if (typeof result !== 'undefined') {
                if (result.then) {
                    changeResult = result;
                }
                else if (result.subscribe) {
                    changeResult = result.toPromise();
                }
                else {
                    changeResult = Promise.resolve(result);
                }
            }
        }
        return changeResult;
    }
    handleChange($event, value) {
        $event.stopPropagation();
        this.writeValue(value);
        this.onChange(value);
        this.change.emit(value);
    }
    writeValue(value) {
        this._value = value;
        if (this.radios && this.radios.length > 0) {
            this.radios.forEach((radio) => {
                radio.writeValue(this._value);
            });
        }
    }
    registerOnChange(fn) {
        this.onChange = fn;
    }
    registerOnTouched(fn) {
        this.onTouched = fn;
    }
}
RadioGroupComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "13.1.3", ngImport: i0, type: RadioGroupComponent, deps: [], target: i0.ɵɵFactoryTarget.Component });
RadioGroupComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "13.1.3", type: RadioGroupComponent, selector: "d-radio-group", inputs: { name: "name", values: "values", cssStyle: "cssStyle", direction: "direction", disabled: "disabled", beforeChange: "beforeChange" }, outputs: { change: "change" }, host: { listeners: { "click": "onRadioChange($event)" } }, providers: [
        {
            provide: NG_VALUE_ACCESSOR,
            useExisting: forwardRef(() => RadioGroupComponent),
            multi: true,
        },
    ], queries: [{ propertyName: "radios", predicate: RadioComponent }], usesOnChanges: true, ngImport: i0, template: "<div class=\"devui-radio-group\">\n  <ul [class.devui-radio-horizontal]=\"direction === 'row'\">\n    <ng-container *ngIf=\"radios.length === 0\">\n      <li *ngFor=\"let value of values\" class=\"devui-radio-list-item\">\n        <label class=\"devui-radio\" [class.active]=\"value == _value\" [class.disabled]=\"disabled\">\n          <input\n            type=\"radio\"\n            class=\"devui-radio-input\"\n            [disabled]=\"disabled\"\n            [name]=\"name\"\n            [id]=\"name + '-' + value\"\n            [value]=\"value\"\n            [checked]=\"value == _value\"\n            (change)=\"handleChange($event, value)\"\n          />\n          <span class=\"devui-radio-material\">\n            <svg height=\"100%\" width=\"100%\" viewBox=\"0 0 1024 1024\" xmlns=\"http://www.w3.org/2000/svg\">\n              <circle class=\"devui-outer\" [class.disabled]=\"disabled\" cx=\"512\" cy=\"512\" r=\"486.5\" stroke-width=\"51\" />\n              <circle class=\"devui-inner\" [class.disabled]=\"disabled\" cx=\"512\" fill-rule=\"nonzero\" cy=\"512\" r=\"320\" />\n            </svg>\n          </span>\n          <span class=\"devui-radio-label\">{{ value }}</span>\n        </label>\n      </li>\n    </ng-container>\n\n    <ng-content select=\"d-radio\"></ng-content>\n  </ul>\n</div>\n", styles: [".devui-radio-horizontal .devui-radio-list-item{display:inline-block}.devui-radio-horizontal .devui-radio-list-item:not(:last-child){padding-right:20px}.devui-radio-horizontal ::ng-deep d-radio{display:inline-block}.devui-radio-list-item{position:relative;line-height:28px}:host ::ng-deep d-radio{line-height:28px}\n", ".devui-font-size-base{font-size:12px;font-size:var(--devui-font-size, 12px)}.devui-font-base{font-size:12px;font-size:var(--devui-font-size, 12px);font-weight:400;line-height:1.5}.devui-font-size-modal-title{font-size:18px;font-size:var(--devui-font-size-modal-title, 18px)}.devui-font-modal-title{font-size:18px;font-size:var(--devui-font-size-modal-title, 18px);font-weight:700;line-height:1.5}.devui-font-size-page-title{font-size:16px;font-size:var(--devui-font-size-page-title, 16px)}.devui-font-page-title{font-size:16px;font-size:var(--devui-font-size-page-title, 16px);font-weight:700;line-height:1.5}.devui-font-size-secondary-title{font-size:14px;font-size:var(--devui-font-size-card-title, 14px)}.devui-font-secondary-title{font-size:14px;font-size:var(--devui-font-size-card-title, 14px);font-weight:700;line-height:1.5}:host{padding-right:20px;display:block;line-height:18px}.devui-radio{font-size:12px;font-size:var(--devui-font-size, 12px);line-height:1.5;font-weight:400;cursor:pointer;color:#252b3a;color:var(--devui-text, #252b3a);margin:0 auto}.devui-radio.disabled{cursor:not-allowed}.devui-radio.disabled .devui-radio-label{color:#cfd0d3;color:var(--devui-disabled-text, #cfd0d3)}.devui-radio svg .devui-outer{stroke:#d7d8da;stroke:var(--devui-line, #d7d8da);fill:transparent}.devui-radio svg .devui-outer.disabled{stroke:#dfe1e6;stroke:var(--devui-disabled-line, #dfe1e6);fill:#f5f5f5;fill:var(--devui-disabled-bg, #f5f5f5)}.devui-radio svg .devui-inner{fill:#5e7ce0;fill:var(--devui-brand, #5e7ce0)}.devui-radio:hover:not(.disabled) svg .devui-outer{stroke:#5e7ce0;stroke:var(--devui-form-control-line-active, #5e7ce0)}.devui-radio:hover:not(.disabled) .devui-radio-label{color:#7693f5;color:var(--devui-primary-hover, #7693f5)}.devui-radio:active:not(.disabled) svg .devui-outer,.devui-radio:focus:not(.disabled) svg .devui-outer{stroke:#5e7ce0;stroke:var(--devui-form-control-line-active, #5e7ce0)}.devui-radio.active svg .devui-outer{opacity:1;stroke:#5e7ce0;stroke:var(--devui-form-control-line-active, #5e7ce0);transition:stroke 50ms cubic-bezier(.5,.05,.5,.95);transition:stroke 50ms var(--devui-animation-ease-in-out, cubic-bezier(.5, .05, .5, .95))}.devui-radio.active svg .devui-outer.disabled{stroke:#beccfa;stroke:var(--devui-icon-fill-active-disabled, #beccfa);fill:transparent}.devui-radio.active svg .devui-inner{opacity:1;transform:scale(1);transition:transform .2s cubic-bezier(.5,.05,.5,.95),opacity .2s cubic-bezier(.5,.05,.5,.95);transition:transform var(--devui-animation-duration-base, .2s) var(--devui-animation-ease-in-out, cubic-bezier(.5, .05, .5, .95)),opacity var(--devui-animation-duration-base, .2s) var(--devui-animation-ease-in-out, cubic-bezier(.5, .05, .5, .95))}.devui-radio.active svg .devui-inner.disabled{fill:#beccfa;fill:var(--devui-icon-fill-active-disabled, #beccfa)}.devui-radio.active:not(.disabled):active .devui-radio-material svg .devui-outer,.devui-radio.active:not(.disabled):focus .devui-radio-material svg .devui-outer,.devui-radio.active:not(.disabled):hover .devui-radio-material svg .devui-outer{stroke:#344899;stroke:var(--devui-form-control-line-active-hover, #344899)}.devui-radio.active:not(.disabled):active .devui-radio-material svg .devui-inner,.devui-radio.active:not(.disabled):focus .devui-radio-material svg .devui-inner,.devui-radio.active:not(.disabled):hover .devui-radio-material svg .devui-inner{fill:#5e7ce0;fill:var(--devui-brand, #5e7ce0)}.devui-radio .devui-outer{opacity:1;transition:stroke 50ms cubic-bezier(.5,.05,.5,.95);transition:stroke 50ms var(--devui-animation-ease-in-out, cubic-bezier(.5, .05, .5, .95))}.devui-radio .devui-inner{opacity:0;transform:scale(0);transform-origin:50% 50%;transition:transform .2s cubic-bezier(.5,.05,.5,.95),opacity .2s cubic-bezier(.5,.05,.5,.95);transition:transform var(--devui-animation-duration-base, .2s) var(--devui-animation-ease-in-out, cubic-bezier(.5, .05, .5, .95)),opacity var(--devui-animation-duration-base, .2s) var(--devui-animation-ease-in-out, cubic-bezier(.5, .05, .5, .95))}.devui-radio .devui-radio-material{vertical-align:middle;position:relative;display:inline-block;overflow:hidden;height:16px;width:16px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;transform:translateY(-1px)}.devui-radio .devui-radio-label{color:#252b3a;color:var(--devui-text, #252b3a);margin-left:8px;font-size:12px;font-size:var(--devui-font-size, 12px);transition:color .3s cubic-bezier(.5,.05,.5,.95);transition:color var(--devui-animation-duration-slow, .3s) var(--devui-animation-ease-in-out, cubic-bezier(.5, .05, .5, .95))}.devui-radio .devui-radio-input{opacity:0;z-index:-1;width:0;height:0;display:none;overflow:hidden;pointer-events:none}\n"], directives: [{ type: i1.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { type: i1.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "13.1.3", ngImport: i0, type: RadioGroupComponent, decorators: [{
            type: Component,
            args: [{ selector: 'd-radio-group', providers: [
                        {
                            provide: NG_VALUE_ACCESSOR,
                            useExisting: forwardRef(() => RadioGroupComponent),
                            multi: true,
                        },
                    ], preserveWhitespaces: false, template: "<div class=\"devui-radio-group\">\n  <ul [class.devui-radio-horizontal]=\"direction === 'row'\">\n    <ng-container *ngIf=\"radios.length === 0\">\n      <li *ngFor=\"let value of values\" class=\"devui-radio-list-item\">\n        <label class=\"devui-radio\" [class.active]=\"value == _value\" [class.disabled]=\"disabled\">\n          <input\n            type=\"radio\"\n            class=\"devui-radio-input\"\n            [disabled]=\"disabled\"\n            [name]=\"name\"\n            [id]=\"name + '-' + value\"\n            [value]=\"value\"\n            [checked]=\"value == _value\"\n            (change)=\"handleChange($event, value)\"\n          />\n          <span class=\"devui-radio-material\">\n            <svg height=\"100%\" width=\"100%\" viewBox=\"0 0 1024 1024\" xmlns=\"http://www.w3.org/2000/svg\">\n              <circle class=\"devui-outer\" [class.disabled]=\"disabled\" cx=\"512\" cy=\"512\" r=\"486.5\" stroke-width=\"51\" />\n              <circle class=\"devui-inner\" [class.disabled]=\"disabled\" cx=\"512\" fill-rule=\"nonzero\" cy=\"512\" r=\"320\" />\n            </svg>\n          </span>\n          <span class=\"devui-radio-label\">{{ value }}</span>\n        </label>\n      </li>\n    </ng-container>\n\n    <ng-content select=\"d-radio\"></ng-content>\n  </ul>\n</div>\n", styles: [".devui-radio-horizontal .devui-radio-list-item{display:inline-block}.devui-radio-horizontal .devui-radio-list-item:not(:last-child){padding-right:20px}.devui-radio-horizontal ::ng-deep d-radio{display:inline-block}.devui-radio-list-item{position:relative;line-height:28px}:host ::ng-deep d-radio{line-height:28px}\n", ".devui-font-size-base{font-size:12px;font-size:var(--devui-font-size, 12px)}.devui-font-base{font-size:12px;font-size:var(--devui-font-size, 12px);font-weight:400;line-height:1.5}.devui-font-size-modal-title{font-size:18px;font-size:var(--devui-font-size-modal-title, 18px)}.devui-font-modal-title{font-size:18px;font-size:var(--devui-font-size-modal-title, 18px);font-weight:700;line-height:1.5}.devui-font-size-page-title{font-size:16px;font-size:var(--devui-font-size-page-title, 16px)}.devui-font-page-title{font-size:16px;font-size:var(--devui-font-size-page-title, 16px);font-weight:700;line-height:1.5}.devui-font-size-secondary-title{font-size:14px;font-size:var(--devui-font-size-card-title, 14px)}.devui-font-secondary-title{font-size:14px;font-size:var(--devui-font-size-card-title, 14px);font-weight:700;line-height:1.5}:host{padding-right:20px;display:block;line-height:18px}.devui-radio{font-size:12px;font-size:var(--devui-font-size, 12px);line-height:1.5;font-weight:400;cursor:pointer;color:#252b3a;color:var(--devui-text, #252b3a);margin:0 auto}.devui-radio.disabled{cursor:not-allowed}.devui-radio.disabled .devui-radio-label{color:#cfd0d3;color:var(--devui-disabled-text, #cfd0d3)}.devui-radio svg .devui-outer{stroke:#d7d8da;stroke:var(--devui-line, #d7d8da);fill:transparent}.devui-radio svg .devui-outer.disabled{stroke:#dfe1e6;stroke:var(--devui-disabled-line, #dfe1e6);fill:#f5f5f5;fill:var(--devui-disabled-bg, #f5f5f5)}.devui-radio svg .devui-inner{fill:#5e7ce0;fill:var(--devui-brand, #5e7ce0)}.devui-radio:hover:not(.disabled) svg .devui-outer{stroke:#5e7ce0;stroke:var(--devui-form-control-line-active, #5e7ce0)}.devui-radio:hover:not(.disabled) .devui-radio-label{color:#7693f5;color:var(--devui-primary-hover, #7693f5)}.devui-radio:active:not(.disabled) svg .devui-outer,.devui-radio:focus:not(.disabled) svg .devui-outer{stroke:#5e7ce0;stroke:var(--devui-form-control-line-active, #5e7ce0)}.devui-radio.active svg .devui-outer{opacity:1;stroke:#5e7ce0;stroke:var(--devui-form-control-line-active, #5e7ce0);transition:stroke 50ms cubic-bezier(.5,.05,.5,.95);transition:stroke 50ms var(--devui-animation-ease-in-out, cubic-bezier(.5, .05, .5, .95))}.devui-radio.active svg .devui-outer.disabled{stroke:#beccfa;stroke:var(--devui-icon-fill-active-disabled, #beccfa);fill:transparent}.devui-radio.active svg .devui-inner{opacity:1;transform:scale(1);transition:transform .2s cubic-bezier(.5,.05,.5,.95),opacity .2s cubic-bezier(.5,.05,.5,.95);transition:transform var(--devui-animation-duration-base, .2s) var(--devui-animation-ease-in-out, cubic-bezier(.5, .05, .5, .95)),opacity var(--devui-animation-duration-base, .2s) var(--devui-animation-ease-in-out, cubic-bezier(.5, .05, .5, .95))}.devui-radio.active svg .devui-inner.disabled{fill:#beccfa;fill:var(--devui-icon-fill-active-disabled, #beccfa)}.devui-radio.active:not(.disabled):active .devui-radio-material svg .devui-outer,.devui-radio.active:not(.disabled):focus .devui-radio-material svg .devui-outer,.devui-radio.active:not(.disabled):hover .devui-radio-material svg .devui-outer{stroke:#344899;stroke:var(--devui-form-control-line-active-hover, #344899)}.devui-radio.active:not(.disabled):active .devui-radio-material svg .devui-inner,.devui-radio.active:not(.disabled):focus .devui-radio-material svg .devui-inner,.devui-radio.active:not(.disabled):hover .devui-radio-material svg .devui-inner{fill:#5e7ce0;fill:var(--devui-brand, #5e7ce0)}.devui-radio .devui-outer{opacity:1;transition:stroke 50ms cubic-bezier(.5,.05,.5,.95);transition:stroke 50ms var(--devui-animation-ease-in-out, cubic-bezier(.5, .05, .5, .95))}.devui-radio .devui-inner{opacity:0;transform:scale(0);transform-origin:50% 50%;transition:transform .2s cubic-bezier(.5,.05,.5,.95),opacity .2s cubic-bezier(.5,.05,.5,.95);transition:transform var(--devui-animation-duration-base, .2s) var(--devui-animation-ease-in-out, cubic-bezier(.5, .05, .5, .95)),opacity var(--devui-animation-duration-base, .2s) var(--devui-animation-ease-in-out, cubic-bezier(.5, .05, .5, .95))}.devui-radio .devui-radio-material{vertical-align:middle;position:relative;display:inline-block;overflow:hidden;height:16px;width:16px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;transform:translateY(-1px)}.devui-radio .devui-radio-label{color:#252b3a;color:var(--devui-text, #252b3a);margin-left:8px;font-size:12px;font-size:var(--devui-font-size, 12px);transition:color .3s cubic-bezier(.5,.05,.5,.95);transition:color var(--devui-animation-duration-slow, .3s) var(--devui-animation-ease-in-out, cubic-bezier(.5, .05, .5, .95))}.devui-radio .devui-radio-input{opacity:0;z-index:-1;width:0;height:0;display:none;overflow:hidden;pointer-events:none}\n"] }]
        }], ctorParameters: function () { return []; }, propDecorators: { name: [{
                type: Input
            }], values: [{
                type: Input
            }], cssStyle: [{
                type: Input
            }], direction: [{
                type: Input
            }], disabled: [{
                type: Input
            }], beforeChange: [{
                type: Input
            }], change: [{
                type: Output
            }], radios: [{
                type: ContentChildren,
                args: [RadioComponent]
            }], onRadioChange: [{
                type: HostListener,
                args: ['click', ['$event']]
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmFkaW8tZ3JvdXAuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vZGV2dWkvcmFkaW8vcmFkaW8tZ3JvdXAuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vZGV2dWkvcmFkaW8vcmFkaW8tZ3JvdXAuY29tcG9uZW50Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUVMLFNBQVMsRUFDVCxlQUFlLEVBQ2YsWUFBWSxFQUNaLFVBQVUsRUFDVixZQUFZLEVBQ1osS0FBSyxFQUVMLE1BQU0sRUFDTixTQUFTLEVBRVYsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUF3QixpQkFBaUIsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBRXpFLE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQzs7O0FBZW5ELE1BQU0sT0FBTyxtQkFBbUI7SUFDOUI7UUFZVSxXQUFNLEdBQUcsSUFBSSxZQUFZLEVBQU8sQ0FBQztRQUNWLFdBQU0sR0FBOEIsSUFBSSxTQUFTLEVBQWtCLENBQUM7SUFidEYsQ0FBQztJQUdoQjs7T0FFRztJQUNILElBQWEsUUFBUSxDQUFDLFNBQWM7UUFDbEMsSUFBSSxDQUFDLFNBQVMsR0FBRyxTQUFTLENBQUM7SUFDN0IsQ0FBQztJQVdELGFBQWEsQ0FBQyxLQUFLO1FBQ2pCLElBQUksS0FBSyxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsV0FBVyxFQUFFLEtBQUssT0FBTyxFQUFFO1lBQ2xELElBQUksSUFBSSxDQUFDLFFBQVEsRUFBRTtnQkFDakIsS0FBSyxDQUFDLGNBQWMsRUFBRSxDQUFDO2FBQ3hCO1lBQ0QsSUFBSSxDQUFDLFNBQVMsRUFBRSxDQUFDLElBQUksQ0FBQyxDQUFDLE1BQU0sRUFBRSxFQUFFO2dCQUMvQixJQUFJLENBQUMsTUFBTSxFQUFFO29CQUNYLEtBQUssQ0FBQyxjQUFjLEVBQUUsQ0FBQztpQkFDeEI7WUFDSCxDQUFDLENBQUMsQ0FBQztTQUNKO0lB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QUFpQjs0QkFDMUIsV0FBVyxFQUFFLFVBQVUsQ0FBQyxHQUFHLEVBQUUsb0JBQW9CLENBQUM7NEJBQ2xELEtBQUssRUFBRSxJQUFJO3lCQUNaO3FCQUNGLHVCQUNvQixLQUFLOzBFQUlqQixJQUFJO3NCQUFaLEtBQUs7Z0JBQ0csTUFBTTtzQkFBZCxLQUFLO2dCQUlPLFFBQVE7c0JBQXBCLEtBQUs7Z0JBR0csU0FBUztzQkFBakIsS0FBSztnQkFDRyxRQUFRO3NCQUFoQixLQUFLO2dCQUNHLFlBQVk7c0JBQXBCLEtBQUs7Z0JBQ0ksTUFBTTtzQkFBZixNQUFNO2dCQUMwQixNQUFNO3NCQUF0QyxlQUFlO3VCQUFDLGNBQWM7Z0JBTS9CLGFBQWE7c0JBRFosWUFBWTt1QkFBQyxPQUFPLEVBQUUsQ0FBQyxRQUFRLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBBZnRlclZpZXdJbml0LFxuICBDb21wb25lbnQsXG4gIENvbnRlbnRDaGlsZHJlbixcbiAgRXZlbnRFbWl0dGVyLFxuICBmb3J3YXJkUmVmLFxuICBIb3N0TGlzdGVuZXIsXG4gIElucHV0LFxuICBPbkNoYW5nZXMsXG4gIE91dHB1dCxcbiAgUXVlcnlMaXN0LFxuICBTaW1wbGVDaGFuZ2VzXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQ29udHJvbFZhbHVlQWNjZXNzb3IsIE5HX1ZBTFVFX0FDQ0VTU09SIH0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xuaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgUmFkaW9Db21wb25lbnQgfSBmcm9tICcuL3JhZGlvLmNvbXBvbmVudCc7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2QtcmFkaW8tZ3JvdXAnLFxuICB0ZW1wbGF0ZVVybDogJy4vcmFkaW8tZ3JvdXAuY29tcG9uZW50Lmh0bWwnLFxuICBzdHlsZVVybHM6IFsnLi9yYWRpby1ncm91cC5jb21wb25lbnQuc2NzcycsICcuL3JhZGlvLmNvbXBvbmVudC5zY3NzJ10sXG4gIHByb3ZpZGVyczogW1xuICAgIHtcbiAgICAgIHByb3ZpZGU6IE5HX1ZBTFVFX0FDQ0VTU09SLFxuICAgICAgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gUmFkaW9Hcm91cENvbXBvbmVudCksXG4gICAgICBtdWx0aTogdHJ1ZSxcbiAgICB9LFxuICBdLFxuICBwcmVzZXJ2ZVdoaXRlc3BhY2VzOiBmYWxzZSxcbn0pXG5leHBvcnQgY2xhc3MgUmFkaW9Hcm91cENvbXBvbmVudCBpbXBsZW1lbnRzIENvbnRyb2xWYWx1ZUFjY2Vzc29yLCBPbkNoYW5nZXMsIEFmdGVyVmlld0luaXQge1xuICBjb25zdHJ1Y3RvcigpIHt9XG4gIEBJbnB1dCgpIG5hbWU6IHN0cmluZztcbiAgQElucHV0KCkgdmFsdWVzOiBhbnlbXTtcbiAgLyoqXG4gICAqIEBkZXByZWNhdGVkIFVzZSBkaXJlY3Rpb24gdG8gcmVwbGFjZS5cbiAgICovXG4gIEBJbnB1dCgpIHNldCBjc3NTdHlsZShkaXJlY3Rpb246IGFueSkge1xuICAgIHRoaXMuZGlyZWN0aW9uID0gZGlyZWN0aW9uO1xuICB9XG4gIEBJbnB1dCgpIGRpcmVjdGlvbjogJ3JvdycgfCAnY29sdW1uJztcbiAgQElucHV0KCkgZGlzYWJsZWQ6IGJvb2xlYW47XG4gIEBJbnB1dCgpIGJlZm9yZUNoYW5nZTogKHZhbHVlKSA9PiBib29sZWFuIHwgUHJvbWlzZTxib29sZWFuPiB8IE9ic2VydmFibGU8Ym9vbGVhbj47XG4gIEBPdXRwdXQoKSBjaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcbiAgQENvbnRlbnRDaGlsZHJlbihSYWRpb0NvbXBvbmVudCkgcmFkaW9zOiBRdWVyeUxpc3Q8UmFkaW9Db21wb25lbnQ+ID0gbmV3IFF1ZXJ5TGlzdDxSYWRpb0NvbXBvbmVudD4oKTtcblxuICBfdmFsdWU6IGFueTtcbiAgb25DaGFuZ2U6IChfOiBhbnkpID0+IG51bGw7XG4gIG9uVG91Y2hlZDogKCkgPT4gbnVsbDtcbiAgQEhvc3RMaXN0ZW5lcignY2xpY2snLCBbJyRldmVudCddKVxuICBvblJhZGlvQ2hhbmdlKGV2ZW50KSB7XG4gICAgaWYgKGV2ZW50LnRhcmdldC50YWdOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICdpbnB1dCcpIHtcbiAgICAgIGlmICh0aGlzLmRpc2FibGVkKSB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB9XG4gICAgICB0aGlzLmNhbkNoYW5nZSgpLnRoZW4oKGNoYW5nZSkgPT4ge1xuICAgICAgICBpZiAoIWNoYW5nZSkge1xuICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIG5nQWZ0ZXJWaWV3SW5pdCgpOiB2b2lkIHtcbiAgICB0aGlzLnJhZGlvcy5mb3JFYWNoKChyYWRpbykgPT4ge1xuICAgICAgdGhpcy5yZWdpc3RlclJhZGlvKHJhZGlvKTtcbiAgICB9KTtcblxuICAgIHRoaXMucmFkaW9zLmNoYW5nZXMuc3Vic2NyaWJlKChuZXdSYWRpb3MpID0+IHtcbiAgICAgIG5ld1JhZGlvcy5mb3JFYWNoKChyYWRpbzogUmFkaW9Db21wb25lbnQpID0+IHtcbiAgICAgICAgdGhpcy5yZWdpc3RlclJhZGlvKHJhZGlvKTtcbiAgICAgICAgUHJvbWlzZS5yZXNvbHZlKHRydWUpLnRoZW4oKCkgPT4gcmFkaW8ud3JpdGVWYWx1ZSh0aGlzLl92YWx1ZSkpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICB0aGlzLnJhZGlvcy5ub3RpZnlPbkNoYW5nZXMoKTtcbiAgfVxuXG4gIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpOiB2b2lkIHtcbiAgICBpZiAoY2hhbmdlcyAmJiBjaGFuZ2VzLm5hbWUgJiYgdGhpcy5yYWRpb3MpIHtcbiAgICAgIHRoaXMucmFkaW9zLmZvckVhY2goKHJhZGlvKSA9PiB7XG4gICAgICAgIHJhZGlvLm5hbWUgPSB0aGlzLm5hbWU7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAoY2hhbmdlcyAmJiBjaGFuZ2VzLmRpc2FibGVkICYmIHRoaXMucmFkaW9zKSB7XG4gICAgICB0aGlzLnJhZGlvcy5mb3JFYWNoKChyYWRpbykgPT4ge1xuICAgICAgICByYWRpby5kaXNhYmxlZCA9IHRoaXMuZGlzYWJsZWQ7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAoY2hhbmdlcyAmJiB0aGlzLnJhZGlvcykge1xuICAgICAgdGhpcy5yYWRpb3MuZm9yRWFjaCgocmFkaW8pID0+IHtcbiAgICAgICAgcmFkaW8uZGlzYWJsZWQgPSB0aGlzLmRpc2FibGVkO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgcmVnaXN0ZXJSYWRpbyhyYWRpbzogUmFkaW9Db21wb25lbnQpIHtcbiAgICByYWRpby5yZWdpc3Rlck9uQ2hhbmdlKCh2YWx1ZTogYW55KSA9PiB7XG4gICAgICB0aGlzLndyaXRlVmFsdWUodmFsdWUpO1xuICAgICAgdGhpcy5vbkNoYW5nZSh2YWx1ZSk7XG4gICAgICBQcm9taXNlLnJlc29sdmUoKS50aGVuKCgpID0+IHRoaXMub25Ub3VjaGVkKCkpO1xuICAgICAgdGhpcy5jaGFuZ2UuZW1pdCh2YWx1ZSk7XG4gICAgfSk7XG4gIH1cblxuICBjYW5DaGFuZ2UoKSB7XG4gICAgbGV0IGNoYW5nZVJlc3VsdCA9IFByb21pc2UucmVzb2x2ZSh0cnVlKTtcbiAgICBpZiAodGhpcy5iZWZvcmVDaGFuZ2UpIHtcbiAgICAgIGNvbnN0IHJlc3VsdDogYW55ID0gdGhpcy5iZWZvcmVDaGFuZ2UodGhpcy52YWx1ZXMpO1xuICAgICAgaWYgKHR5cGVvZiByZXN1bHQgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIGlmIChyZXN1bHQudGhlbikge1xuICAgICAgICAgIGNoYW5nZVJlc3VsdCA9IHJlc3VsdDtcbiAgICAgICAgfSBlbHNlIGlmIChyZXN1bHQuc3Vic2NyaWJlKSB7XG4gICAgICAgICAgY2hhbmdlUmVzdWx0ID0gKHJlc3VsdCBhcyBPYnNlcnZhYmxlPGJvb2xlYW4+KS50b1Byb21pc2UoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjaGFuZ2VSZXN1bHQgPSBQcm9taXNlLnJlc29sdmUocmVzdWx0KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gY2hhbmdlUmVzdWx0O1xuICB9XG5cbiAgaGFuZGxlQ2hhbmdlKCRldmVudCwgdmFsdWUpIHtcbiAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgdGhpcy53cml0ZVZhbHVlKHZhbHVlKTtcbiAgICB0aGlzLm9uQ2hhbmdlKHZhbHVlKTtcbiAgICB0aGlzLmNoYW5nZS5lbWl0KHZhbHVlKTtcbiAgfVxuXG4gIHdyaXRlVmFsdWUodmFsdWU6IGFueSkge1xuICAgIHRoaXMuX3ZhbHVlID0gdmFsdWU7XG4gICAgaWYgKHRoaXMucmFkaW9zICYmIHRoaXMucmFkaW9zLmxlbmd0aCA+IDApIHtcbiAgICAgIHRoaXMucmFkaW9zLmZvckVhY2goKHJhZGlvKSA9PiB7XG4gICAgICAgIHJhZGlvLndyaXRlVmFsdWUodGhpcy5fdmFsdWUpO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgcmVnaXN0ZXJPbkNoYW5nZShmbikge1xuICAgIHRoaXMub25DaGFuZ2UgPSBmbjtcbiAgfVxuXG4gIHJlZ2lzdGVyT25Ub3VjaGVkKGZuOiBhbnkpIHtcbiAgICB0aGlzLm9uVG91Y2hlZCA9IGZuO1xuICB9XG59XG4iLCI8ZGl2IGNsYXNzPVwiZGV2dWktcmFkaW8tZ3JvdXBcIj5cbiAgPHVsIFtjbGFzcy5kZXZ1aS1yYWRpby1ob3Jpem9udGFsXT1cImRpcmVjdGlvbiA9PT0gJ3JvdydcIj5cbiAgICA8bmctY29udGFpbmVyICpuZ0lmPVwicmFkaW9zLmxlbmd0aCA9PT0gMFwiPlxuICAgICAgPGxpICpuZ0Zvcj1cImxldCB2YWx1ZSBvZiB2YWx1ZXNcIiBjbGFzcz1cImRldnVpLXJhZGlvLWxpc3QtaXRlbVwiPlxuICAgICAgICA8bGFiZWwgY2xhc3M9XCJkZXZ1aS1yYWRpb1wiIFtjbGFzcy5hY3RpdmVdPVwidmFsdWUgPT0gX3ZhbHVlXCIgW2NsYXNzLmRpc2FibGVkXT1cImRpc2FibGVkXCI+XG4gICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICB0eXBlPVwicmFkaW9cIlxuICAgICAgICAgICAgY2xhc3M9XCJkZXZ1aS1yYWRpby1pbnB1dFwiXG4gICAgICAgICAgICBbZGlzYWJsZWRdPVwiZGlzYWJsZWRcIlxuICAgICAgICAgICAgW25hbWVdPVwibmFtZVwiXG4gICAgICAgICAgICBbaWRdPVwibmFtZSArICctJyArIHZhbHVlXCJcbiAgICAgICAgICAgIFt2YWx1ZV09XCJ2YWx1ZVwiXG4gICAgICAgICAgICBbY2hlY2tlZF09XCJ2YWx1ZSA9PSBfdmFsdWVcIlxuICAgICAgICAgICAgKGNoYW5nZSk9XCJoYW5kbGVDaGFuZ2UoJGV2ZW50LCB2YWx1ZSlcIlxuICAgICAgICAgIC8+XG4gICAgICAgICAgPHNwYW4gY2xhc3M9XCJkZXZ1aS1yYWRpby1tYXRlcmlhbFwiPlxuICAgICAgICAgICAgPHN2ZyBoZWlnaHQ9XCIxMDAlXCIgd2lkdGg9XCIxMDAlXCIgdmlld0JveD1cIjAgMCAxMDI0IDEwMjRcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCI+XG4gICAgICAgICAgICAgIDxjaXJjbGUgY2xhc3M9XCJkZXZ1aS1vdXRlclwiIFtjbGFzcy5kaXNhYmxlZF09XCJkaXNhYmxlZFwiIGN4PVwiNTEyXCIgY3k9XCI1MTJcIiByPVwiNDg2LjVcIiBzdHJva2Utd2lkdGg9XCI1MVwiIC8+XG4gICAgICAgICAgICAgIDxjaXJjbGUgY2xhc3M9XCJkZXZ1aS1pbm5lclwiIFtjbGFzcy5kaXNhYmxlZF09XCJkaXNhYmxlZFwiIGN4PVwiNTEyXCIgZmlsbC1ydWxlPVwibm9uemVyb1wiIGN5PVwiNTEyXCIgcj1cIjMyMFwiIC8+XG4gICAgICAgICAgICA8L3N2Zz5cbiAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgPHNwYW4gY2xhc3M9XCJkZXZ1aS1yYWRpby1sYWJlbFwiPnt7IHZhbHVlIH19PC9zcGFuPlxuICAgICAgICA8L2xhYmVsPlxuICAgICAgPC9saT5cbiAgICA8L25nLWNvbnRhaW5lcj5cblxuICAgIDxuZy1jb250ZW50IHNlbGVjdD1cImQtcmFkaW9cIj48L25nLWNvbnRlbnQ+XG4gIDwvdWw+XG48L2Rpdj5cbiJdfQ==