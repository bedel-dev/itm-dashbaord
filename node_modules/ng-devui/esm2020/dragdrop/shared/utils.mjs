import { ElementRef } from '@angular/core';
export class Utils {
    /**
     * Polyfill for element.matches.
     * See: https://developer.mozilla.org/en/docs/Web/API/Element/matches#Polyfill
     * element
     */
    static matches(element, selectorName) {
        const proto = Element.prototype;
        const func = proto['matches'] ||
            proto.matchesSelector ||
            proto.mozMatchesSelector ||
            proto.msMatchesSelector ||
            proto.oMatchesSelector ||
            proto.webkitMatchesSelector ||
            function (s) {
                const matches = (this.document || this.ownerDocument).querySelectorAll(s);
                let i = matches.length;
                while (--i >= 0 && matches.item(i) !== this) {
                    // do nothing
                }
                return i > -1;
            };
        return func.call(element, selectorName);
    }
    /**
     * Applies the specified css class on nativeElement
     * elementRef
     * className
     */
    static addClass(elementRef, className) {
        if (className === undefined) {
            return;
        }
        const e = this.getElementWithValidClassList(elementRef);
        if (e) {
            e.classList.add(className);
        }
    }
    /**
     * Removes the specified class from nativeElement
     * elementRef
     * className
     */
    static removeClass(elementRef, className) {
        if (className === undefined) {
            return;
        }
        const e = this.getElementWithValidClassList(elementRef);
        if (e) {
            e.classList.remove(className);
        }
    }
    /**
     * Gets element with valid classList
     *
     * elementRef
     * @returns ElementRef | null
     */
    static getElementWithValidClassList(elementRef) {
        const e = elementRef instanceof ElementRef ? elementRef.nativeElement : elementRef;
        if (e.classList !== undefined && e.classList !== null) {
            return e;
        }
        return null;
    }
    static slice(args, slice, sliceEnd) {
        const ret = [];
        let len = args.length;
        if (len === 0) {
            return ret;
        }
        const start = slice < 0
            ? Math.max(0, slice + len)
            : slice || 0;
        if (sliceEnd !== undefined) {
            len = sliceEnd < 0
                ? sliceEnd + len
                : sliceEnd;
        }
        while (len-- > start) {
            ret[len - start] = args[len];
        }
        return ret;
    }
    // 动态添加styles
    static addElStyles(el, styles) {
        if (styles instanceof Object) {
            for (const s in styles) {
                if (Object.prototype.hasOwnProperty.call(styles, s)) {
                    if (Array.isArray(styles[s])) {
                        // 用于支持兼容渐退
                        styles[s].forEach(val => {
                            el.style[s] = val;
                        });
                    }
                    else {
                        el.style[s] = styles[s];
                    }
                }
            }
        }
    }
    static dispatchEventToUnderElement(event, target, eventType) {
        const up = target || (event.target);
        up.style.display = 'none';
        const { x, y } = { x: event.clientX, y: event.clientY };
        const under = document.elementFromPoint(x, y);
        up.style.display = '';
        if (!under) {
            return event;
        }
        const ev = document.createEvent('DragEvent');
        ev.initMouseEvent(eventType || event.type, true, true, window, 0, event.screenX, event.screenY, event.clientX, event.clientY, event.ctrlKey, event.altKey, event.shiftKey, event.metaKey, event.button, event.relatedTarget);
        if (ev.dataTransfer !== null) {
            ev.dataTransfer.setData('text', '');
            ev.dataTransfer.effectAllowed = event.dataTransfer.effectAllowed;
        }
        under.dispatchEvent(ev);
        return event;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbHMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9kZXZ1aS9kcmFnZHJvcC9zaGFyZWQvdXRpbHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUUzQyxNQUFNLE9BQU8sS0FBSztJQUNoQjs7OztPQUlHO0lBQ0ksTUFBTSxDQUFDLE9BQU8sQ0FBQyxPQUFZLEVBQUUsWUFBb0I7UUFDdEQsTUFBTSxLQUFLLEdBQVEsT0FBTyxDQUFDLFNBQVMsQ0FBQztRQUVyQyxNQUFNLElBQUksR0FDUixLQUFLLENBQUMsU0FBUyxDQUFDO1lBQ2hCLEtBQUssQ0FBQyxlQUFlO1lBQ3JCLEtBQUssQ0FBQyxrQkFBa0I7WUFDeEIsS0FBSyxDQUFDLGlCQUFpQjtZQUN2QixLQUFLLENBQUMsZ0JBQWdCO1lBQ3RCLEtBQUssQ0FBQyxxQkFBcUI7WUFDM0IsVUFBVSxDQUFDO2dCQUNULE1BQU0sT0FBTyxHQUFHLENBQUMsSUFBSSxDQUFDLFFBQVEsSUFBSSxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0JBQzFFLElBQUksQ0FBQyxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQUM7Z0JBQ3ZCLE9BQU8sRUFBRSxDQUFDLElBQUksQ0FBQyxJQUFJLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEtBQUssSUFBSSxFQUFFO29CQUMzQyxhQUFhO2lCQUNkO2dCQUNELE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1lBQ2hCLENBQUMsQ0FBQztRQUVKLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsWUFBWSxDQUFDLENBQUM7SUFDMUMsQ0FBQztJQUVEOzs7O09BSUc7SUFDSSxNQUFNLENBQUMsUUFBUSxDQUFDLFVBQTRCLEVBQUUsU0FBaUI7UUFDcEUsSUFBSSxTQUFTLEtBQUssU0FBUyxFQUFFO1lBQUMsT0FBTztTQUFFO1FBQ3ZDLE1BQU0sQ0FBQyxHQUFHLElBQUksQ0FBQyw0QkFBNEIsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUV4RCxJQUFJLENBQUMsRUFBRTtZQUNMLENBQUMsQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxDQUFDO1NBQzVCO0lBQ0gsQ0FBQztJQUVEOzs7O09BSUc7SUFDSSxNQUFNLENBQUMsV0FBVyxDQUFDLFVBQTRCLEVBQUUsU0FBaUI7UUFDdkUsSUFBSSxTQUFTLEtBQUssU0FBUyxFQUFFO1lBQUMsT0FBTztTQUFFO1FBQ3ZDLE1BQU0sQ0FBQyxHQUFHLElBQUksQ0FBQyw0QkFBNEIsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUV4RCxJQUFJLENBQUMsRUFBRTtZQUNMLENBQUMsQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1NBQy9CO0lBQ0gsQ0FBQztJQUVEOzs7OztPQUtHO0lBQ0ssTUFBTSxDQUFDLDRCQUE0QixDQUFDLFVBQXNCO1FBQ2hFLE1BQU0sQ0FBQyxHQUFHLFVBQVUsWUFBWSxVQUFVLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQztRQUVuRixJQUFJLENBQUMsQ0FBQyxTQUFTLEtBQUssU0FBUyxJQUFJLENBQUMsQ0FBQyxTQUFTLEtBQUssSUFBSSxFQUFFO1lBQ3JELE9BQU8sQ0FBQyxDQUFDO1NBQ1Y7UUFFRCxPQUFPLElBQUksQ0FBQztJQUNkLENBQUM7SUFFTSxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSxLQUFNLEVBQUUsUUFBUztRQUN6QyxNQUFNLEdBQUcsR0FBRyxFQUFFLENBQUM7UUFDZixJQUFJLEdBQUcsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDO1FBRXRCLElBQUksR0FBRyxLQUFLLENBQUMsRUFBRTtZQUFFLE9BQU8sR0FBRyxDQUFDO1NBQUU7UUFFOUIsTUFBTSxLQUFLLEdBQUcsS0FBSyxHQUFHLENBQUM7WUFDckIsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLEtBQUssR0FBRyxHQUFHLENBQUM7WUFDMUIsQ0FBQyxDQUFDLEtBQUssSUFBSSxDQUFDLENBQUM7UUFFZixJQUFJLFFBQVEsS0FBSyxTQUFTLEVBQUU7WUFDMUIsR0FBRyxHQUFHLFFBQVEsR0FBRyxDQUFDO2dCQUNoQixDQUFDLENBQUMsUUFBUSxHQUFHLEdBQUc7Z0JBQ2hCLENBQUMsQ0FBQyxRQUFRLENBQUM7U0FDZDtRQUVELE9BQU8sR0FBRyxFQUFFLEdBQUcsS0FBSyxFQUFFO1lBQ3BCLEdBQUcsQ0FBQyxHQUFHLEdBQUcsS0FBSyxDQUFDLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1NBQzlCO1FBQ0QsT0FBTyxHQUFHLENBQUM7SUFDYixDQUFDO0lBRUQsYUFBYTtJQUNOLE1BQU0sQ0FBQyxXQUFXLENBQUMsRUFBTyxFQUFFLE1BQVc7UUFDNUMsSUFBSSxNQUFNLFlBQVksTUFBTSxFQUFFO1lBQzVCLEtBQUssTUFBTSxDQUFDLElBQUksTUFBTSxFQUFFO2dCQUN0QixJQUFJLE1BQU0sQ0FBQyxTQUFTLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFDLEVBQUU7b0JBQ25ELElBQUksS0FBSyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRTt3QkFDNUIsV0FBVzt3QkFDWCxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxFQUFFOzRCQUN0QixFQUFFLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxHQUFHLEdBQUcsQ0FBQzt3QkFDcEIsQ0FBQyxDQUFDLENBQUM7cUJBQ0o7eUJBQU07d0JBQ0wsRUFBRSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsR0FBRyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUM7cUJBQ3pCO2lCQUNGO2FBQ0Y7U0FDRjtJQUNILENBQUM7SUFDTSxNQUFNLENBQUMsMkJBQTJCLENBQUMsS0FBZ0IsRUFBRSxNQUFvQixFQUFFLFNBQWtCO1FBQ2xHLE1BQU0sRUFBRSxHQUFHLE1BQU0sSUFBaUIsQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDakQsRUFBRSxDQUFDLEtBQUssQ0FBQyxPQUFPLEdBQUcsTUFBTSxDQUFDO1FBQzFCLE1BQU0sRUFBQyxDQUFDLEVBQUUsQ0FBQyxFQUFDLEdBQUcsRUFBQyxDQUFDLEVBQUUsS0FBSyxDQUFDLE9BQU8sRUFBRSxDQUFDLEVBQUUsS0FBSyxDQUFDLE9BQU8sRUFBQyxDQUFDO1FBQ3BELE1BQU0sS0FBSyxHQUFHLFFBQVEsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDOUMsRUFBRSxDQUFDLEtBQUssQ0FBQyxPQUFPLEdBQUcsRUFBRSxDQUFDO1FBQ3RCLElBQUksQ0FBQyxLQUFLLEVBQUU7WUFDVixPQUFPLEtBQUssQ0FBQztTQUNkO1FBQ0QsTUFBTSxFQUFFLEdBQUcsUUFBUSxDQUFDLFdBQVcsQ0FBQyxXQUFXLENBQUMsQ0FBQztRQUM3QyxFQUFFLENBQUMsY0FBYyxDQUFDLFNBQVMsSUFBSSxLQUFLLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLENBQUMsRUFDOUQsS0FBSyxDQUFDLE9BQU8sRUFBRSxLQUFLLENBQUMsT0FBTyxFQUFFLEtBQUssQ0FBQyxPQUFPLEVBQUUsS0FBSyxDQUFDLE9BQU8sRUFDMUQsS0FBSyxDQUFDLE9BQU8sRUFBRSxLQUFLLENBQUMsTUFBTSxFQUFFLEtBQUssQ0FBQyxRQUFRLEVBQUUsS0FBSyxDQUFDLE9BQU8sRUFDMUQsS0FBSyxDQUFDLE1BQU0sRUFBRSxLQUFLLENBQUMsYUFBYSxDQUFDLENBQUM7UUFDckMsSUFBSSxFQUFFLENBQUMsWUFBWSxLQUFLLElBQUksRUFBRTtZQUM1QixFQUFFLENBQUMsWUFBWSxDQUFDLE9BQU8sQ0FBQyxNQUFNLEVBQUUsRUFBRSxDQUFDLENBQUM7WUFDcEMsRUFBRSxDQUFDLFlBQVksQ0FBQyxhQUFhLEdBQUcsS0FBSyxDQUFDLFlBQVksQ0FBQyxhQUFhLENBQUM7U0FDbEU7UUFDRCxLQUFLLENBQUMsYUFBYSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBQ3hCLE9BQU8sS0FBSyxDQUFDO0lBQ2YsQ0FBQztDQUNGIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRWxlbWVudFJlZiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuXG5leHBvcnQgY2xhc3MgVXRpbHMge1xuICAvKipcbiAgICogUG9seWZpbGwgZm9yIGVsZW1lbnQubWF0Y2hlcy5cbiAgICogU2VlOiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi9kb2NzL1dlYi9BUEkvRWxlbWVudC9tYXRjaGVzI1BvbHlmaWxsXG4gICAqIGVsZW1lbnRcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgbWF0Y2hlcyhlbGVtZW50OiBhbnksIHNlbGVjdG9yTmFtZTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgY29uc3QgcHJvdG86IGFueSA9IEVsZW1lbnQucHJvdG90eXBlO1xuXG4gICAgY29uc3QgZnVuYyA9XG4gICAgICBwcm90b1snbWF0Y2hlcyddIHx8XG4gICAgICBwcm90by5tYXRjaGVzU2VsZWN0b3IgfHxcbiAgICAgIHByb3RvLm1vek1hdGNoZXNTZWxlY3RvciB8fFxuICAgICAgcHJvdG8ubXNNYXRjaGVzU2VsZWN0b3IgfHxcbiAgICAgIHByb3RvLm9NYXRjaGVzU2VsZWN0b3IgfHxcbiAgICAgIHByb3RvLndlYmtpdE1hdGNoZXNTZWxlY3RvciB8fFxuICAgICAgZnVuY3Rpb24gKHMpIHtcbiAgICAgICAgY29uc3QgbWF0Y2hlcyA9ICh0aGlzLmRvY3VtZW50IHx8IHRoaXMub3duZXJEb2N1bWVudCkucXVlcnlTZWxlY3RvckFsbChzKTtcbiAgICAgICAgbGV0IGkgPSBtYXRjaGVzLmxlbmd0aDtcbiAgICAgICAgd2hpbGUgKC0taSA+PSAwICYmIG1hdGNoZXMuaXRlbShpKSAhPT0gdGhpcykge1xuICAgICAgICAgIC8vIGRvIG5vdGhpbmdcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaSA+IC0xO1xuICAgICAgfTtcblxuICAgIHJldHVybiBmdW5jLmNhbGwoZWxlbWVudCwgc2VsZWN0b3JOYW1lKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBcHBsaWVzIHRoZSBzcGVjaWZpZWQgY3NzIGNsYXNzIG9uIG5hdGl2ZUVsZW1lbnRcbiAgICogZWxlbWVudFJlZlxuICAgKiBjbGFzc05hbWVcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgYWRkQ2xhc3MoZWxlbWVudFJlZjogRWxlbWVudFJlZiB8IGFueSwgY2xhc3NOYW1lOiBzdHJpbmcpIHtcbiAgICBpZiAoY2xhc3NOYW1lID09PSB1bmRlZmluZWQpIHtyZXR1cm47IH1cbiAgICBjb25zdCBlID0gdGhpcy5nZXRFbGVtZW50V2l0aFZhbGlkQ2xhc3NMaXN0KGVsZW1lbnRSZWYpO1xuXG4gICAgaWYgKGUpIHtcbiAgICAgIGUuY2xhc3NMaXN0LmFkZChjbGFzc05hbWUpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZW1vdmVzIHRoZSBzcGVjaWZpZWQgY2xhc3MgZnJvbSBuYXRpdmVFbGVtZW50XG4gICAqIGVsZW1lbnRSZWZcbiAgICogY2xhc3NOYW1lXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIHJlbW92ZUNsYXNzKGVsZW1lbnRSZWY6IEVsZW1lbnRSZWYgfCBhbnksIGNsYXNzTmFtZTogc3RyaW5nKSB7XG4gICAgaWYgKGNsYXNzTmFtZSA9PT0gdW5kZWZpbmVkKSB7cmV0dXJuOyB9XG4gICAgY29uc3QgZSA9IHRoaXMuZ2V0RWxlbWVudFdpdGhWYWxpZENsYXNzTGlzdChlbGVtZW50UmVmKTtcblxuICAgIGlmIChlKSB7XG4gICAgICBlLmNsYXNzTGlzdC5yZW1vdmUoY2xhc3NOYW1lKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0cyBlbGVtZW50IHdpdGggdmFsaWQgY2xhc3NMaXN0XG4gICAqXG4gICAqIGVsZW1lbnRSZWZcbiAgICogQHJldHVybnMgRWxlbWVudFJlZiB8IG51bGxcbiAgICovXG4gIHByaXZhdGUgc3RhdGljIGdldEVsZW1lbnRXaXRoVmFsaWRDbGFzc0xpc3QoZWxlbWVudFJlZjogRWxlbWVudFJlZikge1xuICAgIGNvbnN0IGUgPSBlbGVtZW50UmVmIGluc3RhbmNlb2YgRWxlbWVudFJlZiA/IGVsZW1lbnRSZWYubmF0aXZlRWxlbWVudCA6IGVsZW1lbnRSZWY7XG5cbiAgICBpZiAoZS5jbGFzc0xpc3QgIT09IHVuZGVmaW5lZCAmJiBlLmNsYXNzTGlzdCAhPT0gbnVsbCkge1xuICAgICAgcmV0dXJuIGU7XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIHNsaWNlKGFyZ3MsIHNsaWNlPywgc2xpY2VFbmQ/KSB7XG4gICAgY29uc3QgcmV0ID0gW107XG4gICAgbGV0IGxlbiA9IGFyZ3MubGVuZ3RoO1xuXG4gICAgaWYgKGxlbiA9PT0gMCkgeyByZXR1cm4gcmV0OyB9XG5cbiAgICBjb25zdCBzdGFydCA9IHNsaWNlIDwgMFxuICAgICAgPyBNYXRoLm1heCgwLCBzbGljZSArIGxlbilcbiAgICAgIDogc2xpY2UgfHwgMDtcblxuICAgIGlmIChzbGljZUVuZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBsZW4gPSBzbGljZUVuZCA8IDBcbiAgICAgICAgPyBzbGljZUVuZCArIGxlblxuICAgICAgICA6IHNsaWNlRW5kO1xuICAgIH1cblxuICAgIHdoaWxlIChsZW4tLSA+IHN0YXJ0KSB7XG4gICAgICByZXRbbGVuIC0gc3RhcnRdID0gYXJnc1tsZW5dO1xuICAgIH1cbiAgICByZXR1cm4gcmV0O1xuICB9XG5cbiAgLy8g5Yqo5oCB5re75Yqgc3R5bGVzXG4gIHB1YmxpYyBzdGF0aWMgYWRkRWxTdHlsZXMoZWw6IGFueSwgc3R5bGVzOiBhbnkpIHtcbiAgICBpZiAoc3R5bGVzIGluc3RhbmNlb2YgT2JqZWN0KSB7XG4gICAgICBmb3IgKGNvbnN0IHMgaW4gc3R5bGVzKSB7XG4gICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoc3R5bGVzLCBzKSkge1xuICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHN0eWxlc1tzXSkpIHtcbiAgICAgICAgICAgIC8vIOeUqOS6juaUr+aMgeWFvOWuuea4kOmAgFxuICAgICAgICAgICAgc3R5bGVzW3NdLmZvckVhY2godmFsID0+IHtcbiAgICAgICAgICAgICAgZWwuc3R5bGVbc10gPSB2YWw7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZWwuc3R5bGVbc10gPSBzdHlsZXNbc107XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHB1YmxpYyBzdGF0aWMgZGlzcGF0Y2hFdmVudFRvVW5kZXJFbGVtZW50KGV2ZW50OiBEcmFnRXZlbnQsIHRhcmdldD86IEhUTUxFbGVtZW50LCBldmVudFR5cGU/OiBzdHJpbmcpIHtcbiAgICBjb25zdCB1cCA9IHRhcmdldCB8fCA8SFRNTEVsZW1lbnQ+KGV2ZW50LnRhcmdldCk7XG4gICAgdXAuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICBjb25zdCB7eCwgeX0gPSB7eDogZXZlbnQuY2xpZW50WCwgeTogZXZlbnQuY2xpZW50WX07XG4gICAgY29uc3QgdW5kZXIgPSBkb2N1bWVudC5lbGVtZW50RnJvbVBvaW50KHgsIHkpO1xuICAgIHVwLnN0eWxlLmRpc3BsYXkgPSAnJztcbiAgICBpZiAoIXVuZGVyKSB7XG4gICAgICByZXR1cm4gZXZlbnQ7XG4gICAgfVxuICAgIGNvbnN0IGV2ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0RyYWdFdmVudCcpO1xuICAgIGV2LmluaXRNb3VzZUV2ZW50KGV2ZW50VHlwZSB8fCBldmVudC50eXBlLCB0cnVlLCB0cnVlLCB3aW5kb3csIDAsXG4gICAgICBldmVudC5zY3JlZW5YLCBldmVudC5zY3JlZW5ZLCBldmVudC5jbGllbnRYLCBldmVudC5jbGllbnRZLFxuICAgICAgZXZlbnQuY3RybEtleSwgZXZlbnQuYWx0S2V5LCBldmVudC5zaGlmdEtleSwgZXZlbnQubWV0YUtleSxcbiAgICAgIGV2ZW50LmJ1dHRvbiwgZXZlbnQucmVsYXRlZFRhcmdldCk7XG4gICAgaWYgKGV2LmRhdGFUcmFuc2ZlciAhPT0gbnVsbCkge1xuICAgICAgZXYuZGF0YVRyYW5zZmVyLnNldERhdGEoJ3RleHQnLCAnJyk7XG4gICAgICBldi5kYXRhVHJhbnNmZXIuZWZmZWN0QWxsb3dlZCA9IGV2ZW50LmRhdGFUcmFuc2Zlci5lZmZlY3RBbGxvd2VkO1xuICAgIH1cbiAgICB1bmRlci5kaXNwYXRjaEV2ZW50KGV2KTtcbiAgICByZXR1cm4gZXZlbnQ7XG4gIH1cbn1cbiJdfQ==