{"version":3,"file":"ng-devui-editable-select.mjs","sources":["../../devui/editable-select/editable-select.component.ts","../../devui/editable-select/editable-select.component.html","../../devui/editable-select/editable-select.module.ts","../../devui/editable-select/ng-devui-editable-select.ts"],"sourcesContent":["import { ConnectedPosition } from '@angular/cdk/overlay';\nimport {\n  ChangeDetectorRef,\n  Component,\n  ElementRef,\n  EventEmitter,\n  forwardRef,\n  HostListener,\n  Input,\n  OnChanges,\n  OnDestroy,\n  OnInit,\n  Output,\n  SimpleChanges,\n  TemplateRef,\n  ViewChild\n} from '@angular/core';\nimport { ControlValueAccessor, NG_VALUE_ACCESSOR } from '@angular/forms';\nimport { AutoCompleteDirective } from 'ng-devui/auto-complete';\nimport { I18nInterface, I18nService } from 'ng-devui/i18n';\nimport { AppendToBodyDirection, DevConfigService, WithConfig } from 'ng-devui/utils';\nimport { Observable, Subscription } from 'rxjs';\n\n@Component({\n  selector: 'd-editable-select',\n  templateUrl: './editable-select.component.html',\n  styleUrls: ['./editable-select.component.scss'],\n  exportAs: 'editable-select',\n  providers: [\n    {\n      provide: NG_VALUE_ACCESSOR,\n      useExisting: forwardRef(() => EditableSelectComponent),\n      multi: true,\n    },\n  ],\n  preserveWhitespaces: false,\n})\nexport class EditableSelectComponent implements ControlValueAccessor, OnInit, OnChanges, OnDestroy {\n  @Input() appendToBody = false;\n  @Input() appendToBodyDirections: Array<AppendToBodyDirection | ConnectedPosition> = ['rightDown', 'leftDown', 'rightUp', 'leftUp'];\n  @Input() disabled = false;\n  @Input() placeholder = '';\n  @Input() source: any[] = [];\n  @Input() itemTemplate: TemplateRef<any>;\n  @Input() noResultItemTemplate: TemplateRef<any>;\n  @Input() maxHeight: number;\n  @Input() width: number;\n  @Input() disabledKey: string;\n  @Input() allowClear = false;\n  @Input() enableLazyLoad = false;\n  @Input() formatter = (item: any) => (item ? item.label || item.toString() : '');\n  @Input() valueParser = (item) => item;\n  @Input() searchFn: (term: string) => Observable<any[]>;\n  @Input() @WithConfig() showAnimation = true;\n  @Output() loadMore = new EventEmitter<any>();\n  @Output() toggleChange = new EventEmitter<any>();\n  @ViewChild(AutoCompleteDirective, { static: true }) autoCompleteDirective: AutoCompleteDirective;\n  @ViewChild('editableSelectBox', { static: true }) editableSelectBox: ElementRef;\n\n  multiItems: any[] = [];\n  inputValue: any;\n  activeIndex = 0;\n  i18nCommonText: I18nInterface['common'];\n  i18nSubscription: Subscription;\n  subscription: Subscription;\n\n  set dropDownOpen(val) {\n    this._dropDownOpen = val;\n    if (this._dropDownOpen) {\n      this.autoCompleteDirective.openPopup(this.activeIndex);\n    } else {\n      this.autoCompleteDirective.hidePopup();\n      this.onTouched();\n    }\n  }\n\n  get dropDownOpen() {\n    return this._dropDownOpen;\n  }\n\n  private _dropDownOpen = false;\n  private onChange = (_: any) => null;\n  private onTouched = () => null;\n\n  @HostListener('document:click', ['$event'])\n  onDocumentClick(event: Event): void {\n    if (!this.dropDownOpen) {\n      return;\n    }\n\n    const targetEl = event.target as HTMLElement;\n    if (!this.editableSelectBox.nativeElement.contains(targetEl)) {\n      this.dropDownOpen = false;\n    }\n  }\n\n  constructor(private cdr: ChangeDetectorRef, private i18n: I18nService, private devConfigService: DevConfigService) {}\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (changes && changes['searchFn'] && typeof this.searchFn === 'function') {\n      if (this.subscription) {\n        this.subscription.unsubscribe();\n      }\n      this.subscription = this.searchFn('').subscribe((source) => {\n        this.source = source;\n      });\n    }\n  }\n\n  ngOnInit(): void {\n    this.i18nCommonText = this.i18n.getI18nText().common;\n    this.i18nSubscription = this.i18n.langChange().subscribe((data) => {\n      this.i18nCommonText = data.common;\n    });\n  }\n\n  ngOnDestroy(): void {\n    if (this.i18nSubscription) {\n      this.i18nSubscription.unsubscribe();\n    }\n  }\n\n  writeValue(obj: any): void {\n    this.inputValue = obj || '';\n    this.cdr.markForCheck();\n  }\n\n  registerOnChange(fn: any): void {\n    this.onChange = fn;\n  }\n\n  registerOnTouched(fn: any): void {\n    this.onTouched = fn;\n  }\n\n  selectValue(): void {\n    this.dropDownOpen = false;\n  }\n\n  valueClear(event: Event): void {\n    event.stopPropagation();\n    this.inputValue = '';\n    this.onChange(this.inputValue);\n  }\n\n  onTermChange(value: any): void {\n    this.inputValue = value;\n    this.onChange(this.inputValue);\n  }\n\n  toggle(): void {\n    const inputString = this.formatter(this.inputValue);\n    this.activeIndex = this.source.map((item) => this.formatter(item).toLowerCase()).indexOf(inputString.toLowerCase());\n    this.activeIndex = this.activeIndex > -1 ? this.activeIndex : 0;\n    this.dropDownOpen = !this.dropDownOpen;\n  }\n\n  loadMoreEvent(event: any): void {\n    this.loadMore.emit(event);\n  }\n\n  toggleChangeHandler(value: boolean): void {\n    this.toggleChange.emit(value);\n  }\n}\n","<div\n  #editableSelectBox\n  class=\"devui-form-group devui-has-feedback\"\n  [ngClass]=\"{\n    'devui-select-open': dropDownOpen,\n    'allow-clear': (inputValue || inputValue === 0) && allowClear\n  }\"\n>\n  <input\n    (click)=\"toggle()\"\n    class=\"devui-form-control devui-dropdown-origin\"\n    type=\"text\"\n    name=\"autoCompleteControl\"\n    [source]=\"source\"\n    (ngModelChange)=\"onTermChange($event)\"\n    [ngModel]=\"inputValue\"\n    [searchFn]=\"searchFn\"\n    [disabled]=\"disabled\"\n    [disabledKey]=\"disabledKey\"\n    [placeholder]=\"placeholder\"\n    [itemTemplate]=\"itemTemplate\"\n    [noResultItemTemplate]=\"noResultItemTemplate || noResultDefaultTemplate\"\n    [appendToBody]=\"appendToBody\"\n    [appendToBodyDirections]=\"appendToBodyDirections\"\n    [maxHeight]=\"maxHeight\"\n    [sceneType]=\"'select'\"\n    [dAutoCompleteWidth]=\"width\"\n    dAutoComplete\n    [enableLazyLoad]=\"enableLazyLoad\"\n    [formatter]=\"formatter\"\n    [valueParser]=\"valueParser\"\n    [showAnimation]=\"showAnimation\"\n    (toggleChange)=\"toggleChangeHandler($event)\"\n    (loadMore)=\"loadMoreEvent($event)\"\n    (selectValue)=\"selectValue()\"\n  />\n  <span class=\"devui-form-control-feedback\">\n    <span class=\"devui-select-clear-icon\" (click)=\"valueClear($event)\">\n      <svg viewBox=\"0 0 16 16\">\n        <g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\n          <path\n            d=\"M8,1 C11.8659932,1 15,4.13400675 15,8 C15,11.8659932 11.8659932,15 8,15 C4.13400675,15 1,11.8659932 1,8 C1,4.13400675 4.13400675,1 8,1 Z M5.87867966,5.17157288 C5.68341751,4.97631073 5.36683502,4.97631073 5.17157288,5.17157288 C4.99800652,5.34513923 4.97872137,5.61456363 5.11371742,5.80943177 L5.17157288,5.87867966 L7.29218611,7.99929289 L5.17157288,10.1213203 C4.97631073,10.3165825 4.97631073,10.633165 5.17157288,10.8284271 C5.34513923,11.0019935 5.61456363,11.0212786 5.80943177,10.8862826 L5.87867966,10.8284271 L7.99929289,8.70639967 L10.1213203,10.8284271 C10.3165825,11.0236893 10.633165,11.0236893 10.8284271,10.8284271 C11.0019935,10.6548608 11.0212786,10.3854364 10.8862826,10.1905682 L10.8284271,10.1213203 L8.70710678,8 L10.8284271,5.87867966 C11.0236893,5.68341751 11.0236893,5.36683502 10.8284271,5.17157288 C10.6548608,4.99800652 10.3854364,4.97872137 10.1905682,5.11371742 L10.1213203,5.17157288 L8,7.29289322 L5.87867966,5.17157288 Z\"\n            fill-rule=\"nonzero\"\n          ></path>\n        </g>\n      </svg>\n    </span>\n    <span class=\"devui-select-chevron-icon\">\n      <svg viewBox=\"0 0 16 16\">\n        <g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\n          <path\n            d=\"M12.1464466,6.85355339 L8.35355339,10.6464466 C8.15829124,10.8417088 7.84170876,10.8417088 7.64644661,10.6464466 L3.85355339,6.85355339 C3.65829124,6.65829124 3.65829124,6.34170876 3.85355339,6.14644661 C3.94732158,6.05267842 4.07449854,6 4.20710678,6 L11.7928932,6 C12.0690356,6 12.2928932,6.22385763 12.2928932,6.5 C12.2928932,6.63260824 12.2402148,6.7597852 12.1464466,6.85355339 Z\"\n            fill-rule=\"nonzero\"\n          ></path>\n        </g>\n      </svg>\n    </span>\n  </span>\n</div>\n\n<ng-template #noResultDefaultTemplate>\n  <span>{{ inputValue || inputValue === 0 ? i18nCommonText?.noRecordsFound : i18nCommonText?.noData }}</span>\n</ng-template>\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { FormsModule } from '@angular/forms';\nimport { AutoCompleteModule } from 'ng-devui/auto-complete';\nimport { PositioningModule } from 'ng-devui/position';\nimport { EditableSelectComponent } from './editable-select.component';\n\n@NgModule({\n  imports: [CommonModule, FormsModule, AutoCompleteModule, PositioningModule],\n  exports: [EditableSelectComponent],\n  declarations: [EditableSelectComponent],\n})\nexport class EditableSelectModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":[],"mappings":"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"}