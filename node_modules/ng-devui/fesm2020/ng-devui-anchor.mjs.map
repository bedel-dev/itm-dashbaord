{"version":3,"file":"ng-devui-anchor.mjs","sources":["../../devui/anchor/anchor.directive.ts","../../devui/anchor/anchor-box.directive.ts","../../devui/anchor/anchor-link.directive.ts","../../devui/anchor/anchor-box-hash.directive.ts","../../devui/anchor/anchor.module.ts","../../devui/anchor/ng-devui-anchor.ts"],"sourcesContent":["import { AfterViewInit, Directive, ElementRef, HostListener, Input, OnDestroy } from '@angular/core';\nimport { ReplaySubject, Subscription } from 'rxjs';\nimport { AnchorActiveChangeSource, IAnchorBox } from './anchor.type';\n\n@Directive({\n  selector: '[dAnchor]',\n})\nexport class AnchorDirective implements AfterViewInit, OnDestroy {\n  @Input('dAnchor') anchor: string;\n  @Input() anchorActive = 'active';\n  _isActive: boolean;\n  set isActive(active: boolean) {\n    this._isActive = active;\n    this.activeChangeSubject.next(active);\n  }\n  get isActive() {\n    return this._isActive;\n  }\n  activeChangeBy: AnchorActiveChangeSource;\n  activeChangeSubscription: Subscription;\n  activeChangeSubject = new ReplaySubject(1);\n  lastActiveBy: string;\n\n  element: HTMLElement;\n  _boxElement: IAnchorBox;\n  set boxElement(box: IAnchorBox) {\n    this._boxElement = box;\n    this.updateScrollListenTarget();\n  }\n  get boxElement() {\n    return this._boxElement;\n  }\n\n  scrollListenTarget: Element | Window;\n  REACH_TOP_VISION_OFFSET = 50;\n\n  private THROTTLE_DELAY = 100;\n  private THROTTLE_TRIGGER = 600;\n  private scrollPreStart;\n  private scrollTimer;\n\n  constructor(private el: ElementRef) {\n    this.element = this.el.nativeElement;\n  }\n\n  ngAfterViewInit() {\n    this.activeChangeSubscription = this.activeChangeSubject.asObservable().subscribe((active) => {\n      if (this.lastActiveBy) {\n        this.element.classList.remove(this.lastActiveBy);\n      }\n      if (active) {\n        this.element.classList.add(this.anchorActive);\n        this.lastActiveBy = 'anchor-active-by-' + this.activeChangeBy;\n        // setTimeout是为了this.lastActiveBy每次都能被再次触发\n        setTimeout(() => {\n          this.element.classList.add(this.lastActiveBy);\n        }, 0);\n      } else {\n        this.element.classList.remove(this.anchorActive);\n      }\n    });\n    setTimeout(() => {\n      this.checkActiveStatus('initial');\n    });\n  }\n\n  ngOnDestroy() {\n    this.scrollListenTarget.removeEventListener('scroll', this.throttle);\n    if (this.activeChangeSubscription) {\n      this.activeChangeSubscription.unsubscribe();\n    }\n  }\n\n  @HostListener('click') // 鼠标落入范围，激活anchor\n  beFocused() {\n    this.boxElement.forceActiveAnchor(this.anchor, 'click-inside');\n    this.boxElement.isScrollingToTarget = false;\n  }\n\n  throttle = () => {\n    const fn = this.checkActiveStatus;\n    const time = Date.now();\n    if (this.scrollTimer) {\n      clearTimeout(this.scrollTimer);\n    }\n    if (!this.scrollPreStart) {\n      this.scrollPreStart = time;\n    }\n    if (time - this.scrollPreStart > this.THROTTLE_TRIGGER) {\n      fn();\n      this.scrollPreStart = null;\n      this.scrollTimer = null;\n    } else {\n      this.scrollTimer = setTimeout(() => {\n        fn();\n        this.scrollPreStart = null;\n        this.scrollTimer = null;\n      }, this.THROTTLE_DELAY);\n    }\n  };\n\n  checkActiveStatus = (activeChangeBy?: AnchorActiveChangeSource) => {\n    if (this.boxElement.isScrollingToTarget) {\n      return;\n    }\n    const top = this.element.getBoundingClientRect().top - ((this.boxElement.view && this.boxElement.view.top) || 0);\n    const bottom = this.element.getBoundingClientRect().bottom - ((this.boxElement.view && this.boxElement.view.top) || 0);\n\n    // 首个个特殊处理\n    if (this.anchor === this.boxElement.defaultAnchor) {\n      this.activeChangeBy = activeChangeBy || 'scroll';\n      this.isActive = bottom > this.REACH_TOP_VISION_OFFSET;\n      return;\n    }\n\n    // 默认处理\n    this.activeChangeBy = activeChangeBy || 'scroll';\n    this.isActive = bottom > this.REACH_TOP_VISION_OFFSET && top < this.REACH_TOP_VISION_OFFSET;\n  };\n\n  updateScrollListenTarget() {\n    if (this.scrollListenTarget) {\n      return;\n    }\n    if (this.boxElement && typeof window !== 'undefined') {\n      this.scrollListenTarget = this.boxElement.scrollTarget || window; // window有scroll事件，document.documentElement没有scroll事件\n    }\n    this.scrollListenTarget.addEventListener('scroll', this.throttle, { passive: true });\n  }\n}\n","import { ContentChildren, Directive, Input, OnDestroy, OnInit, QueryList } from '@angular/core';\nimport { Subject, Subscription} from 'rxjs';\nimport { filter } from 'rxjs/operators';\nimport { AnchorDirective } from './anchor.directive';\nimport { AnchorActiveChangeSource, IAnchorBox } from './anchor.type';\n\n@Directive({\n  selector: '[dAnchorBox]'\n})\nexport class AnchorBoxDirective implements IAnchorBox, OnDestroy {\n  public isScrollingToTarget = false;\n  private activeChangeSubject = new Subject();\n  public activeChange = this.activeChangeSubject.asObservable();\n  sub: Subscription;\n  @Input() view: {\n    top?: number;\n    bottom?: number;\n  };\n  @Input() defaultAnchor: string;\n  @Input() scrollTarget: HTMLElement;\n  refreshAnchorMap: Subject<any> = new Subject<any>();\n  anchorMap: {\n    [anchor: string]: AnchorDirective;\n  };\n\n  _anchorList: QueryList<AnchorDirective>;\n  @ContentChildren(AnchorDirective, {descendants: true})\n  set anchorList(list: QueryList<AnchorDirective>) {\n    if (this.sub) {\n      this.sub.unsubscribe();\n    }\n    this.sub = new Subscription();\n    this.anchorMap = {};\n    this._anchorList = list;\n    this._anchorList.toArray().forEach(targetAnchor => {\n      this.anchorMap[targetAnchor.anchor] = targetAnchor;\n      targetAnchor.boxElement = this;\n      this.sub.add(\n        targetAnchor.activeChangeSubject.pipe(filter(bool => !!bool)).subscribe(() => {\n          this.activeChangeSubject.next(targetAnchor);\n        }));\n    });\n    this.refreshAnchorMap.next();\n  }\n  get anchorList() {\n    return this._anchorList;\n  }\n\n  forceActiveAnchor(anchorName: string, forceActiveSource: AnchorActiveChangeSource = 'scroll', deactivateOtherAnchor = true) {\n    this.anchorMap[anchorName].activeChangeBy = forceActiveSource;\n    this.anchorMap[anchorName].isActive = true;\n    if (deactivateOtherAnchor) {\n      Object.keys(this.anchorMap)\n        .filter(name => name !== anchorName)\n        .map(name => this.anchorMap[name])\n        .forEach(anchor => {\n          anchor.activeChangeBy = forceActiveSource;\n          anchor.isActive = false;\n        });\n    }\n  }\n  ngOnDestroy() {\n    this.activeChangeSubject.complete();\n    if (this.sub) {\n      this.sub.unsubscribe();\n    }\n  }\n}\n","import { Directive, forwardRef, HostBinding, HostListener, Inject, Input, OnDestroy, OnInit } from '@angular/core';\nimport { scrollAnimate } from 'ng-devui/utils';\nimport { AnchorBoxDirective } from './anchor-box.directive';\nimport { AnchorDirective } from './anchor.directive';\nimport { AnchorActiveChangeSource } from './anchor.type';\n\n@Directive({\n  selector: '[dAnchorLink]',\n})\nexport class AnchorLinkDirective implements OnInit, OnDestroy {\n  @HostBinding('class') get anchorActiveClass() {\n    return this.anchorBlock && this.anchorBlock.isActive ? this.anchorActive || '' : '';\n  }\n  private _anchorName;\n  @Input('dAnchorLink')\n  set anchorName(anchor: string) {\n    this._anchorName = anchor;\n    this.bindAnchorAfterBoxReady();\n  }\n  get anchorName() {\n    return this._anchorName;\n  }\n\n  @Input() anchorActive: string;\n\n  boxElement: AnchorBoxDirective;\n  anchorBlock: AnchorDirective;\n  bindingAnchorTimer;\n  subscription;\n\n  constructor(@Inject(forwardRef(() => AnchorBoxDirective)) box: AnchorBoxDirective) {\n    this.boxElement = box;\n  }\n\n  ngOnInit() {\n    this.subscribeAnchorMapChange();\n  }\n\n  ngOnDestroy() {\n    if (this.subscription) {\n      this.subscription.unsubscribe();\n    }\n  }\n\n  subscribeAnchorMapChange() {\n    if (this.boxElement) {\n      this.subscription = this.boxElement.refreshAnchorMap.subscribe(() => {\n        if (this.bindingAnchorTimer) {\n          clearTimeout(this.bindingAnchorTimer);\n          this.bindingAnchorTimer = undefined;\n        }\n        this.bindAnchorAfterBoxReady();\n      });\n    }\n  }\n\n  bindAnchorAfterBoxReady = () => {\n    if (this.boxElement.anchorMap) {\n      setTimeout(() => {\n        this.anchorBlock = this.boxElement.anchorMap[this.anchorName];\n      }, 0);\n    } else {\n      this.bindingAnchorTimer = setTimeout(this.bindAnchorAfterBoxReady, 500);\n    }\n  };\n\n  @HostListener('click')\n  scrollToAnchor(activeChangeBy?: AnchorActiveChangeSource) {\n    if (typeof document === 'undefined') {\n      return;\n    }\n    if (!this.anchorBlock) {\n      return;\n    }\n    const callback = () => {\n      setTimeout(() => {\n        this.boxElement.forceActiveAnchor(this.anchorName, activeChangeBy || 'anchor-link');\n        this.boxElement.isScrollingToTarget = false;\n      }, 120);\n    };\n    ((container: Element, anchor: Element) => {\n      let containerScrollTop = container.scrollTop;\n      let containerOffsetTop = container.getBoundingClientRect().top;\n      if (container === document.documentElement) {\n        containerScrollTop += document.body.scrollTop; // scrollTop兼容性问题\n        containerOffsetTop = 0; // offsettop抵消\n      }\n      scrollAnimate(\n        container,\n        containerScrollTop,\n        containerScrollTop +\n          anchor.getBoundingClientRect().top -\n          containerOffsetTop -\n          ((this.boxElement.view && this.boxElement.view.top) || 0),\n        undefined,\n        undefined,\n        callback\n      );\n    })(this.boxElement.scrollTarget || document.documentElement, this.anchorBlock.element);\n    this.boxElement.isScrollingToTarget = true;\n  }\n}\n","import { AfterViewInit, Directive, Input, OnDestroy, OnInit, SimpleChanges } from '@angular/core';\nimport { ActivatedRoute, NavigationEnd, Router } from '@angular/router';\nimport { Subscription} from 'rxjs';\nimport { debounceTime, filter } from 'rxjs/operators';\nimport { AnchorBoxDirective } from './anchor-box.directive';\nimport { AnchorLinkDirective } from './anchor-link.directive';\nimport { AnchorDirective } from './anchor.directive';\n\n@Directive({\n  selector: '[dAnchorBox][dAnchorHashSupport]'\n})\nexport class AnchorBoxHashSupportDirective implements OnInit, AfterViewInit, OnDestroy {\n  @Input() updateUrlWhenAnchorActive = true;\n  @Input() scrollToAnchorByHashOnlyInit = false;\n  sub: Subscription = new Subscription();\n  manual = false;\n\n  constructor(private box: AnchorBoxDirective, private router: Router, private route: ActivatedRoute) {}\n\n  ngOnInit(): void {\n    this.sub.add(this.box.activeChange.pipe(\n      debounceTime(300),\n      filter(anchor => this.updateUrlWhenAnchorActive)\n    ).subscribe(this.navigateToHash));\n\n    this.sub.add(this.router.events.pipe(\n      filter(event => event instanceof NavigationEnd)\n    ).subscribe(\n      this.navigateToAnchor\n    ));\n  }\n\n  ngAfterViewInit(): void {\n    const frag = this.route.snapshot.fragment;\n    setTimeout(() => {\n      this.scrollToFragment(frag);\n    }, 120);\n  }\n\n  ngOnDestroy(): void {\n    if (this.sub) {\n      this.sub.unsubscribe();\n    }\n  }\n\n  navigateToHash = (targetAnchor: AnchorDirective) => {\n    if (targetAnchor.activeChangeBy === 'initial') { return; }\n    this.router.navigate([], { fragment: targetAnchor.anchor, replaceUrl: true });\n    this.manual = true;\n  };\n\n  navigateToAnchor = (event: NavigationEnd) => {\n    if (this.manual) {\n      this.manual = false;\n      return;\n    }\n    if (this.scrollToAnchorByHashOnlyInit) { return; }\n    const frag = this.router.parseUrl(event.url).fragment;\n    this.scrollToFragment(frag);\n  };\n\n  scrollToFragment = (frag: string) => {\n    if (!frag) { return; }\n    if (this.box.anchorMap[frag]) {\n      const tempAnchor = new AnchorLinkDirective(this.box);\n      tempAnchor.anchorName = frag;\n      tempAnchor.anchorBlock = this.box.anchorMap[frag];\n      tempAnchor.scrollToAnchor('fragment');\n    }\n  };\n}\n","\nimport { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\n\nimport { RouterModule } from '@angular/router';\nimport { AnchorBoxHashSupportDirective } from './anchor-box-hash.directive';\nimport { AnchorBoxDirective } from './anchor-box.directive';\nimport { AnchorLinkDirective } from './anchor-link.directive';\nimport { AnchorDirective } from './anchor.directive';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    RouterModule\n  ],\n  declarations: [\n    AnchorLinkDirective,\n    AnchorBoxDirective,\n    AnchorDirective,\n    AnchorBoxHashSupportDirective\n  ],\n  exports: [\n    AnchorLinkDirective,\n    AnchorBoxDirective,\n    AnchorDirective,\n    AnchorBoxHashSupportDirective\n  ],\n})\n\nexport class AnchorModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":[],"mappings":"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"}