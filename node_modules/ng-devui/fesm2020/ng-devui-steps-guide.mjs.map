{"version":3,"file":"ng-devui-steps-guide.mjs","sources":["../../devui/steps-guide/steps-guide.service.ts","../../devui/steps-guide/steps-guide.component.ts","../../devui/steps-guide/steps-guide.component.html","../../devui/steps-guide/steps-guide.directive.ts","../../devui/steps-guide/steps-guide.module.ts","../../devui/steps-guide/ng-devui-steps-guide.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { BehaviorSubject, ReplaySubject } from 'rxjs';\n\n@Injectable()\nexport class StepsGuideService {\n  private showGuideSource = new ReplaySubject<any>(1);\n  private currentIndexSource = new BehaviorSubject(0);\n  showGuideObs = this.showGuideSource.asObservable();\n  currentIndex = this.currentIndexSource.asObservable();\n\n  // 引导步骤\n  private steps = [];\n  private currentStep = 0;\n\n  // 切换向导的显示和销毁\n  showGuide(visible: boolean) {\n    this.showGuideSource.next(visible);\n  }\n\n  setCurrentIndex(index: number) {\n    this.currentStep = index;\n    this.currentIndexSource.next(index);\n  }\n\n  getCurrentStep() {\n    return this.currentStep;\n  }\n\n  setSteps(steps) {\n    this.steps = steps;\n  }\n\n  getSteps() {\n    return this.steps;\n  }\n}\n","import { DOCUMENT } from '@angular/common';\nimport { AfterViewInit, Component, ElementRef, HostBinding, Inject, OnDestroy, OnInit, Renderer2 } from '@angular/core';\nimport { I18nInterface, I18nService } from 'ng-devui/i18n';\nimport { PositionService } from 'ng-devui/position';\nimport { fromEvent, Subscription } from 'rxjs';\nimport { debounceTime, throttleTime } from 'rxjs/operators';\nimport { StepsGuideService } from './steps-guide.service';\nimport { ExtraConfig } from './steps-guide.types';\n\n@Component({\n  templateUrl: './steps-guide.component.html',\n  styleUrls: ['./steps-guide.component.scss'],\n  preserveWhitespaces: false,\n})\nexport class StepsGuideComponent implements OnInit, AfterViewInit, OnDestroy {\n  @HostBinding('class')\n  get class() {\n    return 'devui-step-item ' + this.position;\n  }\n  @HostBinding('style.display')\n  get display() {\n    return 'block';\n  }\n  triggerElement: HTMLElement;\n  scrollElement: HTMLElement;\n  pageName: string; // 页面名称，用于标记当页帮助信息是否关闭\n  title: string; // 引导标题\n  content: string; // 引导介绍内容\n  stepsCount: number; // 总步骤数\n  stepIndex: number; // 该步骤序号\n  position = 'top';\n  leftFix: number;\n  topFix: number;\n  zIndex = 1100;\n  extraConfig: ExtraConfig;\n  dots: Array<undefined> = [];\n  subScriber: Subscription;\n  SCROLL_REFRESH_INTERVAL = 100;\n  i18nCommonText: I18nInterface['stepsGuide'];\n  DOT_HORIZONTAL_MARGIN = 27;\n  DOT_VERTICAL_MARGIN = 22;\n  document: Document;\n\n  constructor(\n    private stepService: StepsGuideService,\n    private renderer: Renderer2,\n    private positionService: PositionService,\n    private elm: ElementRef,\n    private i18n: I18nService,\n    @Inject(DOCUMENT) private doc: any\n  ) {\n    this.document = this.doc;\n  }\n\n  ngOnInit() {\n    this.dots = new Array(this.stepsCount);\n    this.elm.nativeElement.style.zIndex = this.zIndex;\n    this.i18nCommonText = this.i18n.getI18nText().stepsGuide;\n    const i18nSubscription = this.i18n.langChange().subscribe((data) => {\n      this.i18nCommonText = data.stepsGuide;\n    });\n\n    this.subScriber = fromEvent(window, 'resize')\n      .pipe(debounceTime(this.SCROLL_REFRESH_INTERVAL))\n      .subscribe(() => {\n        this.updatePosition();\n      });\n    this.subScriber.add(i18nSubscription);\n  }\n\n  ngAfterViewInit() {\n    this.updatePosition();\n    if (!this.scrollElement) {\n      const currentScrollElement = this.positionService.getScrollParent(this.triggerElement);\n      this.scrollElement = currentScrollElement === this.document.body ? window : currentScrollElement;\n    }\n    const scrollSubscriber = fromEvent(this.scrollElement, 'scroll')\n      .pipe(throttleTime(this.SCROLL_REFRESH_INTERVAL, undefined, { leading: true, trailing: true }))\n      .subscribe(() => {\n        this.updatePosition();\n      });\n    this.subScriber.add(scrollSubscriber);\n  }\n\n  ngOnDestroy() {\n    if (this.subScriber) {\n      this.subScriber.unsubscribe();\n    }\n  }\n\n  updatePosition() {\n    const calcPosition = this.position === 'left' ? 'left-top' : this.position === 'right' ? 'right-top' : this.position;\n    const rect = this.positionService.positionElements(this.triggerElement, this.elm.nativeElement, calcPosition, true);\n    const targetRect = this.triggerElement.getBoundingClientRect();\n    let left = rect.left;\n    let top = rect.top;\n\n    switch (rect.placementPrimary) {\n    case 'top':\n      left = targetRect.left + this.triggerElement.clientWidth / 2 - this.elm.nativeElement.clientWidth / 2;\n      top = top + this.triggerElement.clientHeight / 2 - this.DOT_HORIZONTAL_MARGIN;\n      break;\n    case 'bottom':\n      left = targetRect.left + this.triggerElement.clientWidth / 2 - this.elm.nativeElement.clientWidth / 2;\n      top = top + this.DOT_HORIZONTAL_MARGIN / 2;\n      break;\n    case 'left':\n      left = left + this.triggerElement.clientWidth / 2 - this.DOT_HORIZONTAL_MARGIN;\n      top = top + this.triggerElement.clientHeight / 2 - this.DOT_VERTICAL_MARGIN;\n      break;\n    case 'right':\n      left = left - this.triggerElement.clientWidth / 2 + this.DOT_HORIZONTAL_MARGIN;\n      top = top + this.triggerElement.clientHeight / 2 - this.DOT_VERTICAL_MARGIN;\n      break;\n    default:\n    }\n\n    switch (rect.placementSecondary) {\n    case 'left':\n      left = targetRect.left;\n      break;\n    case 'right':\n      left = targetRect.left - this.elm.nativeElement.clientWidth + this.triggerElement.clientWidth;\n      break;\n    default:\n    }\n\n    this.renderer.setStyle(this.elm.nativeElement, 'left', `${left}px`);\n    this.renderer.setStyle(this.elm.nativeElement, 'top', `${top}px`);\n\n    if (this.leftFix) {\n      this.renderer.setStyle(this.elm.nativeElement, 'marginLeft', `${this.leftFix}px`);\n    }\n    if (this.topFix) {\n      this.renderer.setStyle(this.elm.nativeElement, 'marginTop', `${this.topFix}px`);\n    }\n  }\n\n  next() {\n    const newStep = (this.stepIndex + 1 < this.stepsCount && this.stepIndex + 1) || this.stepsCount - 1;\n    this.stepService.setCurrentIndex(newStep);\n    this.close(newStep, 'next');\n  }\n\n  prev() {\n    const newStep = (this.stepIndex - 1 > 0 && this.stepIndex - 1) || 0;\n    this.stepService.setCurrentIndex(newStep);\n    this.close(newStep, 'prev');\n  }\n\n  closeAll() {\n    localStorage.setItem(`devui_guide_${this.pageName}`, '0');\n    this.close(this.stepService.getCurrentStep(), 'close');\n  }\n\n  close(step, type?) {}\n}\n","<div class=\"devui-shining-dot\"></div>\n<div class=\"devui-shining-plus\"></div>\n<div class=\"devui-arrow\"></div>\n<div class=\"devui-guide-container\">\n  <p class=\"devui-title\">{{ title }}</p>\n  <div class=\"icon icon-close\" (click)=\"closeAll()\"></div>\n  <div class=\"devui-content\" [innerHTML]=\"content | safe: 'html'\"></div>\n  <div class=\"devui-ctrl\">\n    <div *ngIf=\"dots.length > 1 && !extraConfig?.hideStepNav\" class=\"devui-dots\">\n      <em *ngFor=\"let dot of dots; index as i\" class=\"icon icon-dot-status {{ i === stepIndex ? 'devui-active' : '' }}\"></em>\n    </div>\n    <div class=\"devui-guide-btn\">\n      <div *ngIf=\"stepIndex > 0 && !extraConfig?.hidePreStep\" class=\"devui-prev-step\" (click)=\"prev()\">{{ i18nCommonText.previous }}</div>\n      <div *ngIf=\"stepIndex + 1 < stepsCount\" (click)=\"next()\">{{ i18nCommonText.next }}</div>\n      <div *ngIf=\"stepIndex === stepsCount - 1\" (click)=\"closeAll()\">{{ i18nCommonText.finish }}</div>\n    </div>\n  </div>\n</div>\n","import { DOCUMENT } from '@angular/common';\nimport {\n  ComponentFactoryResolver,\n  ComponentRef,\n  Directive,\n  ElementRef,\n  EventEmitter,\n  Inject,\n  Input,\n  OnDestroy,\n  OnInit,\n  Output\n} from '@angular/core';\nimport { OverlayContainerRef } from 'ng-devui/overlay-container';\nimport { throttle } from 'lodash-es';\nimport { Observable, Subscription } from 'rxjs';\nimport { StepsGuideComponent } from './steps-guide.component';\nimport { StepsGuideService } from './steps-guide.service';\nimport {\n  ExtraConfig,\n  GuideOptions,\n  OperateResponse,\n  StepItem,\n  StepsGuidePositionType\n} from './steps-guide.types';\n\n@Directive({\n  selector: '[dStepsGuide]',\n})\nexport class StepsGuideDirective implements OnInit, OnDestroy {\n  // 引导页面标示，用于记录不同页面的引导状态\n  @Input() pageName: string;\n  @Input() steps: Array<StepItem> = [];\n  // 该步骤所属序号\n  @Input() stepIndex: number;\n\n  // 弹出位置 top|bottom|bottom-left|left|right\n  _dStepsGuidePosition: StepsGuidePositionType;\n  @Input() set dStepsGuidePosition(pos: StepsGuidePositionType) {\n    this._dStepsGuidePosition = pos;\n  }\n  get dStepsGuidePosition(): StepsGuidePositionType {\n    return this._dStepsGuidePosition || 'top';\n  }\n\n  /**\n   * @deprecated Use dStepsGuidePosition to replace.\n   */\n  @Input() set position(pos: StepsGuidePositionType) {\n    if (!this._dStepsGuidePosition) {\n      this.dStepsGuidePosition = pos;\n    }\n  }\n\n  // 可选，用于修正引导位置\n  @Input() leftFix = 0;\n  @Input() topFix = 0;\n  @Input() zIndex = 1100;\n  // 引导显示的目标dom,如果指定，不在使用指令所在的dom作为目标dom\n  @Input() targetElement: any;\n  @Input() scrollElement: any;\n  // 是否自动滚动页面至目标\n  @Input() scrollToTargetSwitch = true;\n  // 引导向扩展配置\n  @Input() extraConfig: ExtraConfig;\n  // 允许用户指定一个dom反馈页面变化，通过MutationObserver监听该dom所属节点树变化触发resize事件使引导弹窗自动修正位置\n  @Input() set observerDom(dom: HTMLElement) {\n    if (dom) {\n      this._observerDom = dom;\n      // 创建监听实例，并限制回调方法在500ms内只响应一次，避免多次响应dom变化造成性能负担\n      this.observer = new MutationObserver(\n        throttle(\n          this.mutationCallBack,\n          this.MUTATION_OBSERVER_TIME,\n          { 'leading': false, 'trailing': true }\n        ));\n      this.observer.observe(this._observerDom, this.MUTATION_OBSERVER_CONFIG);\n    } else {\n      this.destroyMutationObserver(true);\n    }\n  }\n  @Input() beforeChange: (currentIndex, targetIndex) => boolean | Promise<boolean> | Observable<boolean>;\n  // 点击引导操作触发，返回当前步骤和当前操作，比如上一步、下一步、关闭\n  @Output() operateChange = new EventEmitter<OperateResponse>();\n  _observerDom: any;\n  stepRef: ComponentRef<StepsGuideComponent>;\n  observer: any;\n  toggle: any;\n  currentIndex: number;\n  sub: Subscription = new Subscription();\n  // 监听dom变化的设置，监听属性变化和dom所属节点树变化\n  MUTATION_OBSERVER_CONFIG = { attributes: true, subtree: true };\n  MUTATION_OBSERVER_TIME = 500;\n  document: Document;\n\n  constructor(\n    private stepService: StepsGuideService,\n    private elm: ElementRef,\n    private componentFactoryResolver: ComponentFactoryResolver,\n    private overlayContainerRef: OverlayContainerRef,\n    @Inject(DOCUMENT) private doc: any\n  ) {\n    this.document = this.doc;\n  }\n\n  ngOnInit() {\n    // 监听当前索引变化，决定显示步骤\n    this.sub.add(this.stepService.currentIndex.subscribe(index => {\n      this.canChange(index).then((change) => {\n        if (!change) {\n          return;\n        }\n      });\n      // 防止服务中的步骤被置空或默认为空\n      const serviceSteps = this.stepService.getSteps() || [];\n      this.steps = serviceSteps.length > 0 ? serviceSteps : this.steps;\n      const state = localStorage.getItem(`devui_guide_${this.pageName}`) || '1';\n      this.toggle = Number(state);\n      this.currentIndex = index;\n      const currentStep = this.steps.length > 0 && this.steps[this.currentIndex];\n      // 当前步骤内容存在且未被屏蔽显示且为当前索引时插入操作指引弹窗\n      if (currentStep && this.toggle && this.stepIndex === this.currentIndex) {\n        const targetDom = this.targetElement || this.elm.nativeElement;\n        if (this.scrollToTargetSwitch) {\n          targetDom.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'nearest' });\n        }\n        // 如果该步骤设置了监听dom和监听实例，重启监听\n        if (this._observerDom && this.observer) {\n          this.observer.disconnect();\n          this.observer.observe(this._observerDom, this.MUTATION_OBSERVER_CONFIG);\n        }\n        setTimeout(() => {\n          this.insert({\n            triggerElement: targetDom,\n            scrollElement: this.scrollElement,\n            pageName: this.pageName,\n            title: currentStep.title,\n            content: currentStep.content,\n            stepsCount: this.steps.length,\n            stepIndex: this.stepIndex,\n            position: this.dStepsGuidePosition,\n            leftFix: this.leftFix,\n            topFix: this.topFix,\n            zIndex: this.zIndex,\n          });\n        });\n      }\n    }));\n\n    // 监听切换显示和隐藏\n    this.sub.add(this.stepService.showGuideObs.subscribe(visible => {\n      if (visible) {\n        const currentIndex = this.stepService.getCurrentStep() || 0;\n        localStorage.removeItem(`devui_guide_${this.pageName}`);\n        this.stepService.setCurrentIndex(currentIndex);\n      } else {\n        localStorage.setItem(`devui_guide_${this.pageName}`, '0');\n        this.destroyView();\n      }\n    }));\n  }\n\n  ngOnDestroy() {\n    this.sub.unsubscribe();\n    this.destroyView();\n  }\n\n  destroyView() {\n    if (this.stepRef) {\n      this.stepRef.hostView.destroy();\n    }\n    this.destroyMutationObserver();\n  }\n\n  insert(option: GuideOptions) {\n    const hasGuide = this.document.querySelector('body>.devui-step-item');\n    if (!hasGuide) {\n      this.stepRef = this.overlayContainerRef.createComponent(this.componentFactoryResolver.resolveComponentFactory(StepsGuideComponent));\n      Object.assign(this.stepRef.instance, option, { extraConfig: this.extraConfig });\n      this.stepRef.instance.close = (step, type?) => {\n        this.operateChange.emit({ clickType: type, currentIndex: step });\n        this.destroyView();\n      };\n    }\n  }\n\n  // 监听dom变化的回调方法，即dom发生变化时触发resize事件\n  mutationCallBack = () => {\n    if (typeof window === 'undefined') {\n      return;\n    }\n    const resizeEvt = this.document.createEvent('Event');\n    resizeEvt.initEvent('resize', true, true);\n    window.dispatchEvent(resizeEvt);\n  };\n\n  // 断开监听, 清空监听dom和实例\n  destroyMutationObserver(destroyAll?: boolean) {\n    if (this.observer) {\n      this.observer.disconnect();\n    }\n    if (destroyAll) {\n      this._observerDom = undefined;\n      this.observer = undefined;\n    }\n  }\n\n  canChange(index) {\n    let changeResult = Promise.resolve(true);\n    const currentIndex = this.currentIndex >= 0 ? this.currentIndex : this.stepIndex;\n    if (currentIndex === index && this.beforeChange) {\n      const result: any = this.beforeChange(currentIndex, index);\n      if (typeof result !== 'undefined') {\n        if (result.then) {\n          changeResult = result;\n        } else if (result.subscribe) {\n          changeResult = (result as Observable<boolean>).toPromise();\n        } else {\n          changeResult = Promise.resolve(result);\n        }\n      }\n    }\n    return changeResult;\n  }\n}\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { OverlayContainerRef } from 'ng-devui/overlay-container';\nimport { PositioningModule } from 'ng-devui/position';\nimport { SafePipeModule } from 'ng-devui/utils';\nimport { StepsGuideComponent } from './steps-guide.component';\nimport { StepsGuideDirective } from './steps-guide.directive';\nimport { StepsGuideService } from './steps-guide.service';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    SafePipeModule,\n    PositioningModule\n  ],\n  declarations: [StepsGuideComponent, StepsGuideDirective],\n  exports: [StepsGuideDirective],\n\n  providers: [\n    OverlayContainerRef,\n    StepsGuideService\n  ]\n})\nexport class StepsGuideModule { }\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":[],"mappings":";;;;;;;;;;;;;;;MAIa,iBAAiB;IAD9B;QAEU,oBAAe,GAAG,IAAI,aAAa,CAAM,CAAC,CAAC,CAAC;QAC5C,uBAAkB,GAAG,IAAI,eAAe,CAAC,CAAC,CAAC,CAAC;QACpD,iBAAY,GAAG,IAAI,CAAC,eAAe,CAAC,YAAY,EAAE,CAAC;QACnD,iBAAY,GAAG,IAAI,CAAC,kBAAkB,CAAC,YAAY,EAAE,CAAC;;QAG9C,UAAK,GAAG,EAAE,CAAC;QACX,gBAAW,GAAG,CAAC,CAAC;KAuBzB;;IApBC,SAAS,CAAC,OAAgB;QACxB,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;KACpC;IAED,eAAe,CAAC,KAAa;QAC3B,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;QACzB,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;KACrC;IAED,cAAc;QACZ,OAAO,IAAI,CAAC,WAAW,CAAC;KACzB;IAED,QAAQ,CAAC,KAAK;QACZ,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;KACpB;IAED,QAAQ;QACN,OAAO,IAAI,CAAC,KAAK,CAAC;KACnB;;8GA9BU,iBAAiB;kHAAjB,iBAAiB;2FAAjB,iBAAiB;kBAD7B,UAAU;;;MCWE,mBAAmB;IA6B9B,YACU,WAA8B,EAC9B,QAAmB,EACnB,eAAgC,EAChC,GAAe,EACf,IAAiB,EACC,GAAQ;QAL1B,gBAAW,GAAX,WAAW,CAAmB;QAC9B,aAAQ,GAAR,QAAQ,CAAW;QACnB,oBAAe,GAAf,eAAe,CAAiB;QAChC,QAAG,GAAH,GAAG,CAAY;QACf,SAAI,GAAJ,IAAI,CAAa;QACC,QAAG,GAAH,GAAG,CAAK;QAnBpC,aAAQ,GAAG,KAAK,CAAC;QAGjB,WAAM,GAAG,IAAI,CAAC;QAEd,SAAI,GAAqB,EAAE,CAAC;QAE5B,4BAAuB,GAAG,GAAG,CAAC;QAE9B,0BAAqB,GAAG,EAAE,CAAC;QAC3B,wBAAmB,GAAG,EAAE,CAAC;QAWvB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAC;KAC1B;IArCD,IACI,KAAK;QACP,OAAO,kBAAkB,GAAG,IAAI,CAAC,QAAQ,CAAC;KAC3C;IACD,IACI,OAAO;QACT,OAAO,OAAO,CAAC;KAChB;IAgCD,QAAQ;QACN,IAAI,CAAC,IAAI,GAAG,IAAI,KAAK,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;QACvC,IAAI,CAAC,GAAG,CAAC,aAAa,CAAC,KAAK,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;QAClD,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC,UAAU,CAAC;QACzD,MAAM,gBAAgB,GAAG,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE,CAAC,SAAS,CAAC,CAAC,IAAI;YAC7D,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,UAAU,CAAC;SACvC,CAAC,CAAC;QAEH,IAAI,CAAC,UAAU,GAAG,SAAS,CAAC,MAAM,EAAE,QAAQ,CAAC;aAC1C,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,uBAAuB,CAAC,CAAC;aAChD,SAAS,CAAC;YACT,IAAI,CAAC,cAAc,EAAE,CAAC;SACvB,CAAC,CAAC;QACL,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC;KACvC;IAED,eAAe;QACb,IAAI,CAAC,cAAc,EAAE,CAAC;QACtB,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE;YACvB,MAAM,oBAAoB,GAAG,IAAI,CAAC,eAAe,CAAC,eAAe,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;YACvF,IAAI,CAAC,aAAa,GAAG,oBAAoB,KAAK,IAAI,CAAC,QAAQ,CAAC,IAAI,GAAG,MAAM,GAAG,oBAAoB,CAAC;SAClG;QACD,MAAM,gBAAgB,GAAG,SAAS,CAAC,IAAI,CAAC,aAAa,EAAE,QAAQ,CAAC;aAC7D,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,uBAAuB,EAAE,SAAS,EAAE,EAAE,OAAO,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC,CAAC;aAC9F,SAAS,CAAC;YACT,IAAI,CAAC,cAAc,EAAE,CAAC;SACvB,CAAC,CAAC;QACL,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC;KACvC;IAED,WAAW;QACT,IAAI,IAAI,CAAC,UAAU,EAAE;YACnB,IAAI,CAAC,UAAU,CAAC,WAAW,EAAE,CAAC;SAC/B;KACF;IAED,cAAc;QACZ,MAAM,YAAY,GAAG,IAAI,CAAC,QAAQ,KAAK,MAAM,GAAG,UAAU,GAAG,IAAI,CAAC,QAAQ,KAAK,OAAO,GAAG,WAAW,GAAG,IAAI,CAAC,QAAQ,CAAC;QACrH,MAAM,IAAI,GAAG,IAAI,CAAC,eAAe,CAAC,gBAAgB,CAAC,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,YAAY,EAAE,IAAI,CAAC,CAAC;QACpH,MAAM,UAAU,GAAG,IAAI,CAAC,cAAc,CAAC,qBAAqB,EAAE,CAAC;QAC/D,IAAI,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC;QACrB,IAAI,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC;QAEnB,QAAQ,IAAI,CAAC,gBAAgB;YAC7B,KAAK,KAAK;gBACR,IAAI,GAAG,UAAU,CAAC,IAAI,GAAG,IAAI,CAAC,cAAc,CAAC,WAAW,GAAG,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,aAAa,CAAC,WAAW,GAAG,CAAC,CAAC;gBACtG,GAAG,GAAG,GAAG,GAAG,IAAI,CAAC,cAAc,CAAC,YAAY,GAAG,CAAC,GAAG,IAAI,CAAC,qBAAqB,CAAC;gBAC9E,MAAM;YACR,KAAK,QAAQ;gBACX,IAAI,GAAG,UAAU,CAAC,IAAI,GAAG,IAAI,CAAC,cAAc,CAAC,WAAW,GAAG,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,aAAa,CAAC,WAAW,GAAG,CAAC,CAAC;gBACtG,GAAG,GAAG,GAAG,GAAG,IAAI,CAAC,qBAAqB,GAAG,CAAC,CAAC;gBAC3C,MAAM;YACR,KAAK,MAAM;gBACT,IAAI,GAAG,IAAI,GAAG,IAAI,CAAC,cAAc,CAAC,WAAW,GAAG,CAAC,GAAG,IAAI,CAAC,qBAAqB,CAAC;gBAC/E,GAAG,GAAG,GAAG,GAAG,IAAI,CAAC,cAAc,CAAC,YAAY,GAAG,CAAC,GAAG,IAAI,CAAC,mBAAmB,CAAC;gBAC5E,MAAM;YACR,KAAK,OAAO;gBACV,IAAI,GAAG,IAAI,GAAG,IAAI,CAAC,cAAc,CAAC,WAAW,GAAG,CAAC,GAAG,IAAI,CAAC,qBAAqB,CAAC;gBAC/E,GAAG,GAAG,GAAG,GAAG,IAAI,CAAC,cAAc,CAAC,YAAY,GAAG,CAAC,GAAG,IAAI,CAAC,mBAAmB,CAAC;gBAC5E,MAAM;YACR,QAAQ;SACP;QAED,QAAQ,IAAI,CAAC,kBAAkB;YAC/B,KAAK,MAAM;gBACT,IAAI,GAAG,UAAU,CAAC,IAAI,CAAC;gBACvB,MAAM;YACR,KAAK,OAAO;gBACV,IAAI,GAAG,UAAU,CAAC,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,aAAa,CAAC,WAAW,GAAG,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC;gBAC9F,MAAM;YACR,QAAQ;SACP;QAED,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,MAAM,EAAE,GAAG,IAAI,IAAI,CAAC,CAAC;QACpE,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,KAAK,EAAE,GAAG,GAAG,IAAI,CAAC,CAAC;QAElE,IAAI,IAAI,CAAC,OAAO,EAAE;YAChB,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,YAAY,EAAE,GAAG,IAAI,CAAC,OAAO,IAAI,CAAC,CAAC;SACnF;QACD,IAAI,IAAI,CAAC,MAAM,EAAE;YACf,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,WAAW,EAAE,GAAG,IAAI,CAAC,MAAM,IAAI,CAAC,CAAC;SACjF;KACF;IAED,IAAI;QACF,MAAM,OAAO,GAAG,CAAC,IAAI,CAAC,SAAS,GAAG,CAAC,GAAG,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,SAAS,GAAG,CAAC,KAAK,IAAI,CAAC,UAAU,GAAG,CAAC,CAAC;QACpG,IAAI,CAAC,WAAW,CAAC,eAAe,CAAC,OAAO,CAAC,CAAC;QAC1C,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;KAC7B;IAED,IAAI;QACF,MAAM,OAAO,GAAG,CAAC,IAAI,CAAC,SAAS,GAAG,CAAC,GAAG,CAAC,IAAI,IAAI,CAAC,SAAS,GAAG,CAAC,KAAK,CAAC,CAAC;QACpE,IAAI,CAAC,WAAW,CAAC,eAAe,CAAC,OAAO,CAAC,CAAC;QAC1C,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;KAC7B;IAED,QAAQ;QACN,YAAY,CAAC,OAAO,CAAC,eAAe,IAAI,CAAC,QAAQ,EAAE,EAAE,GAAG,CAAC,CAAC;QAC1D,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,EAAE,OAAO,CAAC,CAAC;KACxD;IAED,KAAK,CAAC,IAAI,EAAE,IAAK,KAAI;;gHA7IV,mBAAmB,6JAmCpB,QAAQ;oGAnCP,mBAAmB,sICdhC,kgCAkBA;2FDJa,mBAAmB;kBAL/B,SAAS;0CAGa,KAAK;;0BAqCvB,MAAM;2BAAC,QAAQ;4CAjCd,KAAK;sBADR,WAAW;uBAAC,OAAO;gBAKhB,OAAO;sBADV,WAAW;uBAAC,eAAe;;;MEUjB,mBAAmB;IAkE9B,YACU,WAA8B,EAC9B,GAAe,EACf,wBAAkD,EAClD,mBAAwC,EACtB,GAAQ;QAJ1B,gBAAW,GAAX,WAAW,CAAmB;QAC9B,QAAG,GAAH,GAAG,CAAY;QACf,6BAAwB,GAAxB,wBAAwB,CAA0B;QAClD,wBAAmB,GAAnB,mBAAmB,CAAqB;QACtB,QAAG,GAAH,GAAG,CAAK;QApE3B,UAAK,GAAoB,EAAE,CAAC;;QAuB5B,YAAO,GAAG,CAAC,CAAC;QACZ,WAAM,GAAG,CAAC,CAAC;QACX,WAAM,GAAG,IAAI,CAAC;;QAKd,yBAAoB,GAAG,IAAI,CAAC;;QAqB3B,kBAAa,GAAG,IAAI,YAAY,EAAmB,CAAC;QAM9D,QAAG,GAAiB,IAAI,YAAY,EAAE,CAAC;;QAEvC,6BAAwB,GAAG,EAAE,UAAU,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC;QAC/D,2BAAsB,GAAG,GAAG,CAAC;;QA+F7B,qBAAgB,GAAG;YACjB,IAAI,OAAO,MAAM,KAAK,WAAW,EAAE;gBACjC,OAAO;aACR;YACD,MAAM,SAAS,GAAG,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;YACrD,SAAS,CAAC,SAAS,CAAC,QAAQ,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;YAC1C,MAAM,CAAC,aAAa,CAAC,SAAS,CAAC,CAAC;SACjC,CAAC;QA5FA,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAC;KAC1B;IAjED,IAAa,mBAAmB,CAAC,GAA2B;QAC1D,IAAI,CAAC,oBAAoB,GAAG,GAAG,CAAC;KACjC;IACD,IAAI,mBAAmB;QACrB,OAAO,IAAI,CAAC,oBAAoB,IAAI,KAAK,CAAC;KAC3C;;;;IAKD,IAAa,QAAQ,CAAC,GAA2B;QAC/C,IAAI,CAAC,IAAI,CAAC,oBAAoB,EAAE;YAC9B,IAAI,CAAC,mBAAmB,GAAG,GAAG,CAAC;SAChC;KACF;;IAcD,IAAa,WAAW,CAAC,GAAgB;QACvC,IAAI,GAAG,EAAE;YACP,IAAI,CAAC,YAAY,GAAG,GAAG,CAAC;;YAExB,IAAI,CAAC,QAAQ,GAAG,IAAI,gBAAgB,CAClC,QAAQ,CACN,IAAI,CAAC,gBAAgB,EACrB,IAAI,CAAC,sBAAsB,EAC3B,EAAE,SAAS,EAAE,KAAK,EAAE,UAAU,EAAE,IAAI,EAAE,CACvC,CAAC,CAAC;YACL,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,wBAAwB,CAAC,CAAC;SACzE;aAAM;YACL,IAAI,CAAC,uBAAuB,CAAC,IAAI,CAAC,CAAC;SACpC;KACF;IAyBD,QAAQ;;QAEN,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,SAAS,CAAC,KAAK;YACxD,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,CAAC,MAAM;gBAChC,IAAI,CAAC,MAAM,EAAE;oBACX,OAAO;iBACR;aACF,CAAC,CAAC;;YAEH,MAAM,YAAY,GAAG,IAAI,CAAC,WAAW,CAAC,QAAQ,EAAE,IAAI,EAAE,CAAC;YACvD,IAAI,CAAC,KAAK,GAAG,YAAY,CAAC,MAAM,GAAG,CAAC,GAAG,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC;YACjE,MAAM,KAAK,GAAG,YAAY,CAAC,OAAO,CAAC,eAAe,IAAI,CAAC,QAAQ,EAAE,CAAC,IAAI,GAAG,CAAC;YAC1E,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC;YAC5B,IAAI,CAAC,YAAY,GAAG,KAAK,CAAC;YAC1B,MAAM,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,IAAI,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;;YAE3E,IAAI,WAAW,IAAI,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,SAAS,KAAK,IAAI,CAAC,YAAY,EAAE;gBACtE,MAAM,SAAS,GAAG,IAAI,CAAC,aAAa,IAAI,IAAI,CAAC,GAAG,CAAC,aAAa,CAAC;gBAC/D,IAAI,IAAI,CAAC,oBAAoB,EAAE;oBAC7B,SAAS,CAAC,cAAc,CAAC,EAAE,QAAQ,EAAE,QAAQ,EAAE,KAAK,EAAE,SAAS,EAAE,MAAM,EAAE,SAAS,EAAE,CAAC,CAAC;iBACvF;;gBAED,IAAI,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,QAAQ,EAAE;oBACtC,IAAI,CAAC,QAAQ,CAAC,UAAU,EAAE,CAAC;oBAC3B,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,wBAAwB,CAAC,CAAC;iBACzE;gBACD,UAAU,CAAC;oBACT,IAAI,CAAC,MAAM,CAAC;wBACV,cAAc,EAAE,SAAS;wBACzB,aAAa,EAAE,IAAI,CAAC,aAAa;wBACjC,QAAQ,EAAE,IAAI,CAAC,QAAQ;wBACvB,KAAK,EAAE,WAAW,CAAC,KAAK;wBACxB,OAAO,EAAE,WAAW,CAAC,OAAO;wBAC5B,UAAU,EAAE,IAAI,CAAC,KAAK,CAAC,MAAM;wBAC7B,SAAS,EAAE,IAAI,CAAC,SAAS;wBACzB,QAAQ,EAAE,IAAI,CAAC,mBAAmB;wBAClC,OAAO,EAAE,IAAI,CAAC,OAAO;wBACrB,MAAM,EAAE,IAAI,CAAC,MAAM;wBACnB,MAAM,EAAE,IAAI,CAAC,MAAM;qBACpB,CAAC,CAAC;iBACJ,CAAC,CAAC;aACJ;SACF,CAAC,CAAC,CAAC;;QAGJ,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,SAAS,CAAC,OAAO;YAC1D,IAAI,OAAO,EAAE;gBACX,MAAM,YAAY,GAAG,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,IAAI,CAAC,CAAC;gBAC5D,YAAY,CAAC,UAAU,CAAC,eAAe,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC;gBACxD,IAAI,CAAC,WAAW,CAAC,eAAe,CAAC,YAAY,CAAC,CAAC;aAChD;iBAAM;gBACL,YAAY,CAAC,OAAO,CAAC,eAAe,IAAI,CAAC,QAAQ,EAAE,EAAE,GAAG,CAAC,CAAC;gBAC1D,IAAI,CAAC,WAAW,EAAE,CAAC;aACpB;SACF,CAAC,CAAC,CAAC;KACL;IAED,WAAW;QACT,IAAI,CAAC,GAAG,CAAC,WAAW,EAAE,CAAC;QACvB,IAAI,CAAC,WAAW,EAAE,CAAC;KACpB;IAED,WAAW;QACT,IAAI,IAAI,CAAC,OAAO,EAAE;YAChB,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,OAAO,EAAE,CAAC;SACjC;QACD,IAAI,CAAC,uBAAuB,EAAE,CAAC;KAChC;IAED,MAAM,CAAC,MAAoB;QACzB,MAAM,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,uBAAuB,CAAC,CAAC;QACtE,IAAI,CAAC,QAAQ,EAAE;YACb,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,mBAAmB,CAAC,eAAe,CAAC,IAAI,CAAC,wBAAwB,CAAC,uBAAuB,CAAC,mBAAmB,CAAC,CAAC,CAAC;YACpI,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,MAAM,EAAE,EAAE,WAAW,EAAE,IAAI,CAAC,WAAW,EAAE,CAAC,CAAC;YAChF,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,KAAK,GAAG,CAAC,IAAI,EAAE,IAAK;gBACxC,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,EAAE,SAAS,EAAE,IAAI,EAAE,YAAY,EAAE,IAAI,EAAE,CAAC,CAAC;gBACjE,IAAI,CAAC,WAAW,EAAE,CAAC;aACpB,CAAC;SACH;KACF;;IAaD,uBAAuB,CAAC,UAAoB;QAC1C,IAAI,IAAI,CAAC,QAAQ,EAAE;YACjB,IAAI,CAAC,QAAQ,CAAC,UAAU,EAAE,CAAC;SAC5B;QACD,IAAI,UAAU,EAAE;YACd,IAAI,CAAC,YAAY,GAAG,SAAS,CAAC;YAC9B,IAAI,CAAC,QAAQ,GAAG,SAAS,CAAC;SAC3B;KACF;IAED,SAAS,CAAC,KAAK;QACb,IAAI,YAAY,GAAG,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;QACzC,MAAM,YAAY,GAAG,IAAI,CAAC,YAAY,IAAI,CAAC,GAAG,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,SAAS,CAAC;QACjF,IAAI,YAAY,KAAK,KAAK,IAAI,IAAI,CAAC,YAAY,EAAE;YAC/C,MAAM,MAAM,GAAQ,IAAI,CAAC,YAAY,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC;YAC3D,IAAI,OAAO,MAAM,KAAK,WAAW,EAAE;gBACjC,IAAI,MAAM,CAAC,IAAI,EAAE;oBACf,YAAY,GAAG,MAAM,CAAC;iBACvB;qBAAM,IAAI,MAAM,CAAC,SAAS,EAAE;oBAC3B,YAAY,GAAI,MAA8B,CAAC,SAAS,EAAE,CAAC;iBAC5D;qBAAM;oBACL,YAAY,GAAG,OAAO,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;iBACxC;aACF;SACF;QACD,OAAO,YAAY,CAAC;KACrB;;gHAlMU,mBAAmB,uJAuEpB,QAAQ;oGAvEP,mBAAmB;2FAAnB,mBAAmB;kBAH/B,SAAS;mBAAC;oBACT,QAAQ,EAAE,eAAe;iBAC1B;;0BAwEI,MAAM;2BAAC,QAAQ;4CArET,QAAQ;sBAAhB,KAAK;gBACG,KAAK;sBAAb,KAAK;gBAEG,SAAS;sBAAjB,KAAK;gBAIO,mBAAmB;sBAA/B,KAAK;gBAUO,QAAQ;sBAApB,KAAK;gBAOG,OAAO;sBAAf,KAAK;gBACG,MAAM;sBAAd,KAAK;gBACG,MAAM;sBAAd,KAAK;gBAEG,aAAa;sBAArB,KAAK;gBACG,aAAa;sBAArB,KAAK;gBAEG,oBAAoB;sBAA5B,KAAK;gBAEG,WAAW;sBAAnB,KAAK;gBAEO,WAAW;sBAAvB,KAAK;gBAeG,YAAY;sBAApB,KAAK;gBAEI,aAAa;sBAAtB,MAAM;;;MC5DI,gBAAgB;;6GAAhB,gBAAgB;8GAAhB,gBAAgB,iBARZ,mBAAmB,EAAE,mBAAmB,aAJrD,YAAY;QACZ,cAAc;QACd,iBAAiB,aAGT,mBAAmB;8GAOlB,gBAAgB,aALhB;QACT,mBAAmB;QACnB,iBAAiB;KAClB,YAXQ;YACP,YAAY;YACZ,cAAc;YACd,iBAAiB;SAClB;2FASU,gBAAgB;kBAd5B,QAAQ;mBAAC;oBACR,OAAO,EAAE;wBACP,YAAY;wBACZ,cAAc;wBACd,iBAAiB;qBAClB;oBACD,YAAY,EAAE,CAAC,mBAAmB,EAAE,mBAAmB,CAAC;oBACxD,OAAO,EAAE,CAAC,mBAAmB,CAAC;oBAE9B,SAAS,EAAE;wBACT,mBAAmB;wBACnB,iBAAiB;qBAClB;iBACF;;;ACtBD;;;;;;"}