{"version":3,"file":"ng-devui-image-preview.mjs","sources":["../../devui/image-preview/transformable-element.ts","../../devui/image-preview/image-preview.component.ts","../../devui/image-preview/image-preview.component.html","../../devui/image-preview/image-preview.directive.ts","../../devui/image-preview/image-preview.module.ts","../../devui/image-preview/ng-devui-image-preview.ts"],"sourcesContent":["import { fromEvent, of, Subscription } from 'rxjs';\nimport { delay, tap, throttleTime } from 'rxjs/operators';\n\nexport class TransformableElement {\n  private _element: HTMLElement;\n  private _mouseDown = false;\n  private _originMouseX: number;\n  private _originMouseY: number;\n  private _originTranslateX = 0;\n  private _originTranslateY = 0;\n\n  get element(): HTMLElement {\n    return this._element;\n  }\n\n  set element(ele: HTMLElement) {\n    this._element = ele;\n    this.setElementListener();\n  }\n\n  private zoom: number;\n  private turn: number;   // turn\n  private translateX: number;  // px\n  private translateY: number;  // px\n\n  private eventSub: Subscription;\n  private zoomSub: Subscription;\n\n  MIN_SCALE = 0.2;\n  MAX_SCALE = 2.5;\n\n  constructor(element: HTMLElement, { zoom= 1, turn= 0, translateX= 0, translateY= 0 }) {\n    this.element = element;\n    this.zoom = zoom;\n    this.turn = turn;\n    this.translateX = translateX;\n    this.translateY = translateY;\n\n    this.setElementTransform();\n  }\n\n  setElementListener() {\n    if (typeof window === 'undefined') {\n      return;\n    }\n    if (this.eventSub) {\n      this.eventSub.unsubscribe();\n    }\n    this.eventSub = new Subscription();\n    this.eventSub.add(fromEvent(this._element, 'mousewheel').subscribe($event => this.mouseZoom($event)));\n    this.eventSub.add(fromEvent(window, 'mousedown').subscribe($event => this.mouseDown($event)));\n    this.eventSub.add(fromEvent(window, 'mousemove').subscribe($event => this.mouseMove($event)));\n    this.eventSub.add(fromEvent(window, 'mouseup').subscribe($event => this.mouseUp($event)));\n  }\n\n  removeElementListener() {\n    if (this.eventSub) {\n      this.eventSub.unsubscribe();\n    }\n    if (this.zoomSub) {\n      this.zoomSub.unsubscribe();\n    }\n  }\n\n  mouseZoom($event) {\n    if (typeof document === 'undefined') {\n      return;\n    }\n    this.zoomSub = of($event).pipe(\n      throttleTime(300),\n      tap((event) => {\n        const value = -event.wheelDelta || event.deltaY || event.detail;\n        if (value < 0) {\n          if (this.zoom === this.MAX_SCALE) {\n            this.element.style.cursor = 'not-allowed';\n            return;\n          }\n          this.element.style.cursor = 'zoom-in';\n          document.body.style.cursor = 'zoom-in';\n          this.zoomIn(0.2);\n        } else {\n          if (this.zoom === this.MIN_SCALE) {\n            this.element.style.cursor = 'not-allowed';\n            return;\n          }\n          this.element.style.cursor = 'zoom-out';\n          document.body.style.cursor = 'zoom-out';\n          this.zoomOut(0.2);\n        }\n      }),\n      delay(400),\n    ).subscribe(() => {\n      this.element.style.cursor = 'grab';\n      document.body.style.cursor = 'default';\n    });\n  }\n\n  mouseDown($event) {\n    if ($event.target !== this.element) {\n      return;\n    }\n\n    this._mouseDown = true;\n    this._originMouseX = $event['clientX'];\n    this._originMouseY = $event['clientY'];\n    this._originTranslateX = this.translateX;\n    this._originTranslateY = this.translateY;\n  }\n\n  mouseMove($event) {\n    if (this._mouseDown && typeof document !== 'undefined') {\n      $event.stopPropagation();\n      $event.preventDefault();\n      this.translateX = this._originTranslateX + ($event['clientX'] - this._originMouseX);\n      this.translateY = this._originTranslateY + ($event['clientY'] - this._originMouseY);\n      this.setElementTransform();\n      document.body.style.cursor = 'grabbing';\n      this.element.style.cursor = 'grabbing';\n    }\n  }\n\n  mouseUp($event) {\n    if (typeof document !== 'undefined') {\n      this._mouseDown = false;\n      document.body.style.cursor = 'default';\n      this.element.style.cursor = 'grab';\n    }\n  }\n\n  zoomOut(step = 0.25) {\n    this.zoom = Math.max(this.MIN_SCALE, this.zoom - step);\n    this.setElementTransform();\n  }\n\n  zoomIn(step = 0.25) {\n    this.zoom = Math.min(this.MAX_SCALE, this.zoom + step);\n    this.setElementTransform();\n  }\n\n  rotate() {\n    this.turn -= 0.25;\n    this.setElementTransform();\n  }\n\n  setOriginalScale() {\n    this.resetTransformProperties();\n    this.setElementTransform();\n  }\n\n  setBestScale() {\n    this.resetTransformProperties();\n    this.setElementTransform();\n  }\n\n  resetTransformProperties() {\n    this.zoom = 1;\n    this.translateX = 0;\n    this.translateY = 1;\n  }\n\n  setElementTransform(target?,\n                      zoom= this.zoom,\n                      translateX = this.translateX,\n                      translateY = this.translateY,\n                      turn = this.turn\n  ) {\n    if (!target) { target = this.element; }\n    target.style.transform = `translate(${translateX}px, ${translateY}px) scale(${zoom}) rotate(${turn}turn)`;\n  }\n}\n","import { DOCUMENT } from '@angular/common';\nimport { ChangeDetectionStrategy, Component, ElementRef, HostListener, Inject, Input, OnDestroy, OnInit } from '@angular/core';\nimport { I18nInterface, I18nService } from 'ng-devui/i18n';\nimport { Subscription } from 'rxjs';\nimport { TransformableElement } from './transformable-element';\n\n@Component({\n  selector: 'd-image-preview',\n  templateUrl: './image-preview.component.html',\n  styleUrls: ['./image-preview.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  preserveWhitespaces: false,\n})\n\nexport class DImagePreviewComponent implements OnInit, OnDestroy {\n  _data: any;\n  @Input()\n  set data(data) {\n    this._data = data;\n    this.images = data.images;\n    this.onClose = data.onClose;\n    this.targetImageIndex = this.images.indexOf(data.targetImage);\n    this.totalImageNum = this.images.length;\n  }\n  get data() {\n    return this._data;\n  }\n\n  transformableImageElementRef: TransformableElement;\n  images: HTMLElement[];\n  isOptimal = true;\n  targetImageIndex: number;\n  totalImageNum: number;\n\n  showInput = false;\n\n  onClose: () => void;\n\n  i18nText: I18nInterface['imagePreview'];\n  i18nSubscription: Subscription;\n  document: Document;\n\n  get targetImageSrc(): string {\n    // 防止targetImageIndex出现-1的情况\n    const idx = this.targetImageIndex >= 0 && this.targetImageIndex || 0;\n    return this.images[idx].getAttribute('src');\n  }\n\n  constructor(\n    private elementRef: ElementRef,\n    private i18n: I18nService,\n    @Inject(DOCUMENT) private doc: any\n  ) {\n    this.document = this.doc;\n  }\n\n  @HostListener('click', ['$event'])\n  click($event) {\n    if ($event.target.classList.contains('devui-image-preview-wrapper')) {\n      this.onClose();\n    }\n  }\n\n  @HostListener('touchstart', ['$event'])\n  touchstart($event) {\n    $event['clientX'] = $event.changedTouches[0].clientX;\n    $event['clientY'] = $event.changedTouches[0].clientY;\n    this.transformableImageElementRef.mouseDown($event);\n  }\n\n  @HostListener('touchmove', ['$event'])\n  touchmove($event) {\n    $event['clientX'] = $event.changedTouches[0].clientX;\n    $event['clientY'] = $event.changedTouches[0].clientY;\n    this.transformableImageElementRef.mouseMove($event);\n  }\n\n  @HostListener('touchend', ['$event'])\n  touchend($event) {\n    this.transformableImageElementRef.mouseDown($event);\n  }\n\n  @HostListener('window:keydown.ArrowLeft', [])\n  arrowLeft() {\n    this.pre();\n  }\n\n  @HostListener('window:keydown.ArrowRight', [])\n  arrowRight() {\n    this.next();\n  }\n\n  ngOnInit() {\n    this.addFullScreenStyle();\n    this.transformableImageElementRef = new TransformableElement(this.getImgElement(), {});\n    this.setI18nText();\n  }\n\n  setI18nText() {\n    this.i18nText = this.i18n.getI18nText().imagePreview;\n    this.i18nSubscription = this.i18n.langChange().subscribe((data) => {\n      this.i18nText = data.imagePreview;\n    });\n  }\n\n  ngOnDestroy() {\n    this.removeFullScreenStyle();\n    this.transformableImageElementRef.removeElementListener();\n    if (this.i18nSubscription) {\n      this.i18nSubscription.unsubscribe();\n    }\n  }\n\n  pre() {\n    this.targetImageIndex = (this.targetImageIndex - 1 + this.totalImageNum) % this.totalImageNum;\n  }\n\n  next() {\n    this.targetImageIndex = (this.targetImageIndex + 1) % this.totalImageNum;\n  }\n\n  zoomIn() {\n    this.transformableImageElementRef.zoomIn();\n  }\n\n  zoomOut() {\n    this.transformableImageElementRef.zoomOut();\n  }\n\n  rotate() {\n    this.transformableImageElementRef.rotate();\n  }\n\n  setScaleBest() {\n    this.transformableImageElementRef.setBestScale();\n    this.isOptimal = true;\n  }\n\n  setScaleOriginal() {\n    this.transformableImageElementRef.setOriginalScale();\n    this.isOptimal = false;\n  }\n\n  inputChange($event) {\n    if (!isNaN($event) && $event && $event >= 1 && $event <= this.totalImageNum) {\n      this.targetImageIndex = $event - 1;\n    }\n  }\n\n  private addFullScreenStyle() {\n    this.document.querySelector('body').classList.add('devui-fullscreen');\n  }\n\n  private removeFullScreenStyle() {\n    this.document.querySelector('body').classList.remove('devui-fullscreen');\n  }\n\n  private getImgElement(): HTMLElement {\n    return this.elementRef.nativeElement.querySelector('.devui-image-preview-main-image');\n  }\n}\n","<div class=\"devui-image-preview-wrapper\">\n  <button class=\"devui-image-preview-close-btn\" (click)=\"onClose()\">\n    <svg width=\"16px\" height=\"16px\" viewBox=\"0 0 16 16\" version=\"1.1\">\n      <g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\n        <polygon\n          fill=\"#293040\"\n          fill-rule=\"nonzero\"\n          points=\"8 6.58578644 12.2426407 2.34314575 13.6568542 3.75735931 9.41421356 8 13.6568542 12.2426407 12.2426407 13.6568542 8 9.41421356 3.75735931 13.6568542 2.34314575 12.2426407 6.58578644 8 2.34314575 3.75735931 3.75735931 2.34314575\"\n        ></polygon>\n      </g>\n    </svg>\n  </button>\n  <img class=\"devui-image-preview-main-image\" [class.devui-optimal-proportion]=\"isOptimal\" [attr.src]=\"targetImageSrc | safe: 'url'\" />\n\n  <!-- TODO: button参数化重构 -->\n  <button class=\"devui-fixed-arrow-left\" (click)=\"pre()\" dTooltip [position]=\"'right'\" [content]=\"i18nText.pre\">\n    <svg width=\"18px\" height=\"18px\" viewBox=\"0 0 16 16\" version=\"1.1\">\n      <g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\n        <polygon\n          fill=\"#293040\"\n          fill-rule=\"nonzero\"\n          points=\"10.7071068 12.2928932 9.29289322 13.7071068 3.58578644 8 9.29289322 2.29289322 10.7071068 3.70710678 6.41421356 8\"\n        ></polygon>\n      </g>\n    </svg>\n  </button>\n  <button class=\"devui-fixed-arrow-right\" (click)=\"next()\" dTooltip [position]=\"'left'\" [content]=\"i18nText.next\">\n    <svg width=\"18px\" height=\"18px\" viewBox=\"0 0 16 16\" version=\"1.1\">\n      <g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\n        <polygon\n          fill=\"#293040\"\n          fill-rule=\"nonzero\"\n          transform=\"translate(8.146447, 8.000000) scale(-1, 1) translate(-8.146447, -8.000000) \"\n          points=\"11.7071068 12.2928932 10.2928932 13.7071068 4.58578644 8 10.2928932 2.29289322 11.7071068 3.70710678 7.41421356 8\"\n        ></polygon>\n      </g>\n    </svg>\n  </button>\n\n  <div class=\"devui-image-preview-toolbar\">\n    <button (click)=\"zoomIn()\" dTooltip [position]=\"'top'\" [content]=\"i18nText?.zoomIn\">\n      <svg width=\"18px\" height=\"18px\" viewBox=\"0 0 16 16\">\n        <g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\n          <g fill=\"#293040\" fill-rule=\"nonzero\">\n            <path\n              d=\"M6,6 L6,4 L8,4 L8,6 L10,6 L10,8 L8,8 L8,10 L6,10 L6,8 L4,8 L4,6 L6,6 Z M12.6063847,11.1921711 L15.6568542,14.2426407 L14.2426407,15.6568542 L11.1921711,12.6063847 C10.0235906,13.4815965 8.5723351,14 7,14 C3.13400675,14 0,10.8659932 0,7 C0,3.13400675 3.13400675,0 7,0 C10.8659932,0 14,3.13400675 14,7 C14,8.5723351 13.4815965,10.0235906 12.6063847,11.1921711 L12.6063847,11.1921711 Z M7,12 C9.76142375,12 12,9.76142375 12,7 C12,4.23857625 9.76142375,2 7,2 C4.23857625,2 2,4.23857625 2,7 C2,9.76142375 4.23857625,12 7,12 Z\"\n            ></path>\n          </g>\n        </g>\n      </svg>\n    </button>\n    <button (click)=\"zoomOut()\" dTooltip [position]=\"'top'\" [content]=\"i18nText.zoomOut\">\n      <svg width=\"18px\" height=\"18px\" viewBox=\"0 0 16 16\">\n        <g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\n          <g fill=\"#293040\" fill-rule=\"nonzero\">\n            <path\n              d=\"M12.6063847,11.1921711 L15.6568542,14.2426407 L14.2426407,15.6568542 L11.1921711,12.6063847 C10.0235906,13.4815965 8.5723351,14 7,14 C3.13400675,14 0,10.8659932 0,7 C0,3.13400675 3.13400675,0 7,0 C10.8659932,0 14,3.13400675 14,7 C14,8.5723351 13.4815965,10.0235906 12.6063847,11.1921711 L12.6063847,11.1921711 Z M7,12 C9.76142375,12 12,9.76142375 12,7 C12,4.23857625 9.76142375,2 7,2 C4.23857625,2 2,4.23857625 2,7 C2,9.76142375 4.23857625,12 7,12 Z M4,6 L10,6 L10,8 L4,8 L4,6 Z\"\n            ></path>\n          </g>\n        </g>\n      </svg>\n    </button>\n    <button (click)=\"rotate()\" dTooltip [position]=\"'top'\" [content]=\"i18nText.rotate\">\n      <svg width=\"18px\" height=\"18px\" viewBox=\"0 0 16 16\" version=\"1.1\">\n        <g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\n          <path\n            d=\"M7.5,3.02242151 L7.5,4 L4.5,2 L7.5,0 L7.5,1.01640228 C7.66526181,1.00552468 7.83198572,1 8,1 C12.1421356,1 15.5,4.35786438 15.5,8.5 C15.5,12.6421356 12.1421356,16 8,16 C3.85786438,16 0.5,12.6421356 0.5,8.5 C0.5,6.9828355 0.950484514,5.5708873 1.72499011,4.39061882 L3.42173231,5.4510827 C2.83944149,6.32371289 2.5,7.37221604 2.5,8.5 C2.5,11.5375661 4.96243388,14 8,14 C11.0375661,14 13.5,11.5375661 13.5,8.5 C13.5,5.46243388 11.0375661,3 8,3 C7.83145515,3 7.66468102,3.00758131 7.5,3.02242151 Z M8,11 C6.61928813,11 5.5,9.88071187 5.5,8.5 C5.5,7.11928813 6.61928813,6 8,6 C9.38071187,6 10.5,7.11928813 10.5,8.5 C10.5,9.88071187 9.38071187,11 8,11 Z M8,10 C8.82842712,10 9.5,9.32842712 9.5,8.5 C9.5,7.67157288 8.82842712,7 8,7 C7.17157288,7 6.5,7.67157288 6.5,8.5 C6.5,9.32842712 7.17157288,10 8,10 Z\"\n            fill=\"#293040\"\n          ></path>\n        </g>\n      </svg>\n    </button>\n    <button (click)=\"pre()\" dTooltip [position]=\"'top'\" [content]=\"i18nText.pre\">\n      <svg width=\"16px\" height=\"16px\" viewBox=\"0 0 16 16\" version=\"1.1\">\n        <g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\n          <polygon\n            fill=\"#293040\"\n            fill-rule=\"nonzero\"\n            points=\"10.7071068 12.2928932 9.29289322 13.7071068 3.58578644 8 9.29289322 2.29289322 10.7071068 3.70710678 6.41421356 8\"\n          ></polygon>\n        </g>\n      </svg>\n    </button>\n    <span (click)=\"showInput = true\" class=\"devui-image-preview-index\">\n      <d-input-number\n        *ngIf=\"showInput\"\n        size=\"sm\"\n        [min]=\"1\"\n        [max]=\"totalImageNum\"\n        [autoFocus]=\"true\"\n        [ngModel]=\"targetImageIndex + 1\"\n        (keyup.enter)=\"showInput = false\"\n        (blur)=\"showInput = false\"\n        (whileValueChanging)=\"inputChange($event)\"\n        (ngModelChange)=\"inputChange($event)\"\n      >\n      </d-input-number>\n      <span *ngIf=\"!showInput\">{{ targetImageIndex + 1 + ' ' }}</span>\n      <span>{{ '/ ' + totalImageNum }}</span>\n    </span>\n    <button class=\"devui-next\" (click)=\"next()\" dTooltip [position]=\"'top'\" [content]=\"i18nText.next\">\n      <svg width=\"16px\" height=\"16px\" viewBox=\"0 0 16 16\" version=\"1.1\">\n        <g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\n          <polygon\n            fill=\"#293040\"\n            fill-rule=\"nonzero\"\n            transform=\"translate(8.146447, 8.000000) scale(-1, 1) translate(-8.146447, -8.000000) \"\n            points=\"11.7071068 12.2928932 10.2928932 13.7071068 4.58578644 8 10.2928932 2.29289322 11.7071068 3.70710678 7.41421356 8\"\n          ></polygon>\n        </g>\n      </svg>\n    </button>\n    <button (click)=\"setScaleBest()\" dTooltip [position]=\"'top'\" [content]=\"i18nText.bestScale\">\n      <svg width=\"18px\" height=\"18px\" viewBox=\"0 0 16 16\">\n        <g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\n          <path\n            d=\"M16,16 L11.429,16 L11.429,15 L14.456,15 L11.006,11.226 L11.652,10.519 L15.086,14.275 L15.086,11 L16,11 L16,16 Z M15.164,1.544 L12.009,4.994 L11.418,4.348 L14.558,0.914 L11.82,0.914 L11.82,0 L16,0 L16,4.571 L15.164,4.571 L15.164,1.544 Z M5,15 L5,16 L0,16 L0,11 L1,11 L1,14.275 L4.756,10.519 L5.463,11.226 L1.689,15 L5,15 Z M4.365,4.994 L0.914,1.544 L0.914,4.571 L3.41060513e-13,4.571 L3.41060513e-13,0 L4.571,0 L4.571,0.914 L1.578,0.914 L5.011,4.348 L4.365,4.994 Z\"\n            fill=\"#293040\"\n            fill-rule=\"nonzero\"\n          ></path>\n        </g>\n      </svg>\n    </button>\n    <button (click)=\"setScaleOriginal()\" dTooltip [position]=\"'top'\" [content]=\"i18nText.originScale\">\n      <span>1:1</span>\n    </button>\n  </div>\n</div>\n","import { Directive, ElementRef, HostBinding, HostListener, Input, OnDestroy, OnInit } from '@angular/core';\nimport { ModalService } from 'ng-devui/modal';\nimport { Subject } from 'rxjs';\nimport { DImagePreviewComponent } from './image-preview.component';\n@Directive({\n  selector: '[dImagePreview]',\n})\nexport class ImagePreviewDirective implements OnInit, OnDestroy {\n\n  constructor(\n    private elementRef: ElementRef,\n    private modalService: ModalService\n  ) { }\n\n  @Input() customSub: Subject<HTMLElement>;\n  @Input() disableDefault = false;\n  // TODO: 提供用户可定制选择器\n  @Input() zIndex: number;\n  @Input() backDropZIndex: number;\n\n  @HostBinding('class.devui-image-preview-container')\n  get defaultClasses() {\n    return !this.disableDefault;\n  }\n  @HostListener('click', ['$event'])\n  onClick($event) {\n    if (this.disableDefault) {\n      return;\n    }\n    const target = $event.target;\n    if (target && target.nodeName.toLowerCase() === 'img') {\n      this.imagePreView(target as HTMLElement);\n    }\n  }\n\n  ngOnInit(): void {\n    if (this.customSub) {\n      this.customSub.subscribe((target) => {\n        this.imagePreView(target);\n      });\n    }\n  }\n\n  ngOnDestroy(): void {\n    if (this.customSub) {\n      this.customSub.unsubscribe();\n    }\n  }\n\n  imagePreView(imageHTMLElement: HTMLElement) {\n    const modalRef = this.modalService.open({\n      id: 'devui-image-preview-modal',\n      component: DImagePreviewComponent,\n      zIndex: this.zIndex,\n      backDropZIndex: this.backDropZIndex,\n      showAnimation: false,\n      data: {\n        targetImage: imageHTMLElement,\n        images: Array.from(this.elementRef.nativeElement.querySelectorAll('img')),\n        onClose: () => {\n          modalRef.modalInstance.hide();\n        },\n      },\n    });\n  }\n\n}\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { FormsModule } from '@angular/forms';\nimport { InputNumberModule } from 'ng-devui/input-number';\nimport { ModalModule } from 'ng-devui/modal';\nimport { TooltipModule } from 'ng-devui/tooltip';\nimport { SafePipeModule } from 'ng-devui/utils';\n\nimport { DImagePreviewComponent } from './image-preview.component';\nimport { ImagePreviewDirective } from './image-preview.directive';\n\n@NgModule({\n  declarations: [DImagePreviewComponent, ImagePreviewDirective],\n  imports: [\n    CommonModule,\n    ModalModule,\n    SafePipeModule,\n    TooltipModule,\n    FormsModule,\n    InputNumberModule\n  ],\n  exports: [\n    ImagePreviewDirective\n  ],\n\n})\n\nexport class ImagePreviewModule { }\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":[],"mappings":"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"}