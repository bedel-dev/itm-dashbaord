{"version":3,"file":"ng-devui-carousel.mjs","sources":["../../devui/carousel/carousel-item.component.ts","../../devui/carousel/carousel.component.ts","../../devui/carousel/carousel.component.html","../../devui/carousel/carousel.module.ts","../../devui/carousel/ng-devui-carousel.ts"],"sourcesContent":["import { Component } from '@angular/core';\n\n@Component({\n  selector: 'd-carousel-item',\n  template: `<ng-content></ng-content>`,\n  preserveWhitespaces: false,\n})\nexport class CarouselItemComponent {}\n","import {\n  AfterContentInit,\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  Component,\n  ContentChildren,\n  ElementRef,\n  EventEmitter,\n  Input,\n  OnChanges,\n  OnDestroy,\n  OnInit,\n  Output,\n  QueryList,\n  Renderer2,\n  SimpleChanges\n} from '@angular/core';\nimport { CarouselItemComponent } from './carousel-item.component';\n\nexport type ArrowTrigger = 'hover' | 'never' | 'always';\nexport type DotTrigger = 'click' | 'hover';\nexport type DotPosition = 'bottom' | 'top';\n@Component({\n  selector: 'd-carousel',\n  exportAs: 'dCarousel',\n  templateUrl: './carousel.component.html',\n  styleUrls: ['./carousel.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  preserveWhitespaces: false,\n})\nexport class CarouselComponent implements OnInit, AfterContentInit, OnChanges, OnDestroy {\n  // 切换箭头的显示方式\n  @Input() arrowTrigger: ArrowTrigger = 'hover';\n  // 是否自动播放\n  @Input() autoplay = false;\n  // 默认自动播放间隔时间\n  @Input() autoplaySpeed = 3000;\n  // 卡片切换动画速度，单位ms\n  @Input() transitionSpeed = 500;\n  // 卡片高度\n  @Input() height = '100%';\n  // 是否显示面板指示器\n  @Input() showDots = true;\n  // 面板指示器位置\n  @Input() dotPosition: DotPosition = 'bottom';\n  // 指示器触发滚动方式\n  @Input() dotTrigger: DotTrigger = 'click';\n  // 当前激活面板索引，默认从0开始\n  @Input() activeIndex = 0;\n  // 卡片切换时，返回当前卡片索引，索引从0开始\n  @Output() activeIndexChange = new EventEmitter<number>();\n  @ContentChildren(CarouselItemComponent) items: QueryList<CarouselItemComponent>;\n\n  showArrow = false;\n  // 卡片容器\n  private itemContainer;\n  // 卡片数量\n  private itemCount;\n  // 自动调度id\n  private scheduledId;\n  // 记录当前页码\n  private currentIndex;\n  constructor(private el: ElementRef, private renderer: Renderer2, private cdr: ChangeDetectorRef) {}\n\n  ngOnInit() {\n    this.showArrow = this.arrowTrigger === 'always';\n    this.itemContainer = this.el.nativeElement.querySelector('.devui-carousel-item-container');\n  }\n\n  ngOnChanges(changes: SimpleChanges) {\n    const { arrowTrigger, activeIndex } = changes;\n    if (arrowTrigger && !arrowTrigger.isFirstChange()) {\n      this.showArrow = this.arrowTrigger === 'always';\n    }\n    if (activeIndex && activeIndex.currentValue !== this.currentIndex && !activeIndex.isFirstChange()) {\n      this.translatePosition(this.activeIndex);\n    }\n    if (!this.autoplay || !this.autoplaySpeed) {\n      this.clearScheduledTransition();\n    } else {\n      this.autoScheduleTransition();\n    }\n  }\n\n  // 切换箭头监听事件，用于处理hover方式\n  arrowMouseEvent(type) {\n    if (this.arrowTrigger !== 'hover') {\n      return;\n    }\n    if (type === 'enter') {\n      this.showArrow = true;\n    } else {\n      this.showArrow = false;\n    }\n  }\n\n  // 向前切换\n  prev() {\n    this.goTo(this.activeIndex - 1);\n  }\n\n  // 向后切换\n  next() {\n    this.goTo(this.activeIndex + 1);\n  }\n\n  // 指定跳转位置\n  goTo(index) {\n    if (index === this.activeIndex) {\n      return;\n    }\n    this.renderer.setStyle(this.itemContainer, 'transition', `left ${this.transitionSpeed}ms ease`);\n    if (index < 0 && this.activeIndex === 0) {\n      // 第一个卡片向前切换\n      this.activeIndex = this.itemCount - 1;\n      const targetEl = this.el.nativeElement.querySelectorAll('d-carousel-item')[this.activeIndex];\n      this.adjustPosition(targetEl, true);\n      this.translatePosition(-1);\n      this.adjustTransition(targetEl);\n    } else if (index >= this.itemCount && this.activeIndex === this.itemCount - 1) {\n      // 最后一个卡片向后切换\n      this.activeIndex = 0;\n      const targetEl = this.el.nativeElement.querySelectorAll('d-carousel-item')[this.activeIndex];\n      this.adjustPosition(targetEl, false);\n      this.translatePosition(this.itemCount);\n      this.adjustTransition(targetEl);\n    } else {\n      this.activeIndex = index < 0 ? 0 : index > this.itemCount - 1 ? this.itemCount - 1 : index;\n      this.translatePosition(this.activeIndex);\n    }\n    this.activeIndexChange.emit(this.activeIndex);\n    this.currentIndex = this.activeIndex;\n    this.cdr.detectChanges();\n    this.autoScheduleTransition();\n  }\n\n  // 指示器触发切换函数\n  switchStep(index, type) {\n    if (type === this.dotTrigger) {\n      this.goTo(index);\n    }\n  }\n\n  // 调整首尾翻页后的动画\n  private adjustTransition(targetEl) {\n    setTimeout(() => {\n      this.renderer.removeStyle(this.itemContainer, 'transition');\n      this.renderer.removeStyle(targetEl, 'transform');\n      this.translatePosition(this.activeIndex);\n    }, this.transitionSpeed);\n  }\n\n  // 调整首尾翻动时的位置\n  private adjustPosition(targetEl, firstToLast: boolean) {\n    const wrapperRect = this.el.nativeElement.querySelector('.devui-carousel-item-wrapper').getBoundingClientRect();\n    this.renderer.setStyle(targetEl, 'transform', `translateX(${(firstToLast ? -this.itemCount : this.itemCount) * wrapperRect.width}px)`);\n  }\n\n  // 翻页位移\n  private translatePosition(size: number) {\n    this.renderer.setStyle(this.itemContainer, 'left', `${-size * 100}%`);\n  }\n\n  // 初始化container的宽度\n  private initCarouselWidth() {\n    this.itemCount = this.items.length;\n    this.renderer.setStyle(this.itemContainer, 'width', `${this.itemCount * 100}%`);\n  }\n\n  // 自动轮播调度任务\n  private autoScheduleTransition() {\n    this.clearScheduledTransition();\n    if (this.autoplay && this.autoplaySpeed) {\n      this.scheduledId = setTimeout(() => {\n        this.next();\n      }, this.autoplaySpeed);\n    }\n  }\n\n  // 清除自动轮播任务\n  private clearScheduledTransition() {\n    if (this.scheduledId) {\n      clearTimeout(this.scheduledId);\n      this.scheduledId = null;\n    }\n  }\n\n  ngAfterContentInit() {\n    this.initCarouselWidth();\n    this.translatePosition(this.activeIndex);\n    this.renderer.setStyle(this.itemContainer, 'transition', `left ${this.transitionSpeed}ms ease`);\n    // contentChildren 变化时，触发重新设置pane\n    this.items.changes.subscribe((items) => {\n      if (items.length !== this.itemCount) {\n        this.activeIndex = 0;\n        this.initCarouselWidth();\n        this.translatePosition(this.activeIndex);\n      }\n    });\n  }\n\n  ngOnDestroy() {\n    // 组件销毁时清理掉当前的定时任务\n    this.clearScheduledTransition();\n  }\n}\n","<div\n  class=\"devui-carousel-container\"\n  [style.height]=\"height\"\n  (mouseenter)=\"arrowMouseEvent('enter')\"\n  (mouseleave)=\"arrowMouseEvent('leave')\"\n>\n  <!-- carousel arrow -->\n  <div class=\"devui-carousel-arrow\" *ngIf=\"arrowTrigger !== 'never' && showArrow\">\n    <button class=\"arrow-left\" (click)=\"prev()\">\n      <svg width=\"18px\" height=\"18px\" viewBox=\"0 0 16 16\" version=\"1.1\">\n        <g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\n          <polygon\n            fill=\"#293040\"\n            fill-rule=\"nonzero\"\n            points=\"10.7071068 12.2928932 9.29289322 13.7071068 3.58578644 8 9.29289322 2.29289322 10.7071068 3.70710678 6.41421356 8\"\n          ></polygon>\n        </g>\n      </svg>\n    </button>\n    <button class=\"arrow-right\" (click)=\"next()\">\n      <svg width=\"18px\" height=\"18px\" viewBox=\"0 0 16 16\" version=\"1.1\">\n        <g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\n          <polygon\n            fill=\"#293040\"\n            fill-rule=\"nonzero\"\n            transform=\"translate(8.146447, 8.000000) scale(-1, 1) translate(-8.146447, -8.000000) \"\n            points=\"11.7071068 12.2928932 10.2928932 13.7071068 4.58578644 8 10.2928932 2.29289322 11.7071068 3.70710678 7.41421356 8\"\n          ></polygon>\n        </g>\n      </svg>\n    </button>\n  </div>\n  <!-- carousel items -->\n  <div class=\"devui-carousel-item-wrapper\">\n    <div class=\"devui-carousel-item-container\">\n      <ng-content select=\"d-carousel-item\"></ng-content>\n    </div>\n  </div>\n  <!-- carousel dots -->\n  <ul class=\"devui-carousel-dots {{ dotPosition }}\" *ngIf=\"items?.length > 1 && showDots\">\n    <li\n      class=\"dot-item\"\n      (click)=\"switchStep(index, 'click')\"\n      (mouseenter)=\"switchStep(index, 'hover')\"\n      [ngClass]=\"{ active: activeIndex === index }\"\n      *ngFor=\"let item of items; let index = index\"\n    ></li>\n  </ul>\n</div>\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { CarouselItemComponent } from './carousel-item.component';\nimport { CarouselComponent } from './carousel.component';\n\n@NgModule({\n  declarations: [CarouselComponent, CarouselItemComponent],\n  imports: [CommonModule],\n  exports: [CarouselComponent, CarouselItemComponent],\n  providers: [],\n})\nexport class CarouselModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":[],"mappings":"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"}