{"version":3,"file":"ng-devui-form.mjs","sources":["../../devui/form/form-control.component.ts","../../devui/form/form-control.component.html","../../devui/form/form-label.component.ts","../../devui/form/form-label.component.html","../../devui/form/form-item.component.ts","../../devui/form/validator-directive/validators.ts","../../devui/form/validator-directive/validate.type.ts","../../devui/form/validator-directive/form-control-rules.directive.ts","../../devui/form/form.directive.ts","../../devui/form/form-operation.component.ts","../../devui/form/services/d-validate-sync.service.ts","../../devui/form/validator-directive/d-validate-sync.directive.ts","../../devui/form/form.module.ts","../../devui/form/ng-devui-form.ts"],"sourcesContent":["import { ChangeDetectorRef, Component, ElementRef, HostBinding, Input, OnInit, Renderer2, TemplateRef } from '@angular/core';\nimport { DFormControlStatus } from './validator-directive/validate.type';\n\n@Component({\n  selector: 'd-form-control',\n  templateUrl: './form-control.component.html',\n  styleUrls: ['./form-control.component.scss'],\n  preserveWhitespaces: false,\n})\nexport class FormControlComponent implements OnInit {\n  @Input() extraInfo: string | TemplateRef<any>;\n  get extraInfoTemplate() {\n    return this.extraInfo instanceof TemplateRef ? this.extraInfo : null;\n  }\n\n  errorMessage: string;\n  @Input() feedbackStatus: DFormControlStatus | null;\n\n  @Input() suffixTemplate: TemplateRef<any>;\n\n  @HostBinding('class.devui-form-control-has-feedback') get status() {\n    return !!this.feedbackStatus;\n  }\n\n  @HostBinding('class.devui-form-control-has-suffix') get suffix() {\n    return !!this.suffixTemplate;\n  }\n\n  /**\n   * @desc Compatible with z-index of components that include dropdown menu, will be remove.\n   *\n   */\n  @HostBinding('class.devui-control-has-open-dropdown') get dropdownOpen() {\n    return !!this.elementRef.nativeElement.querySelector('.devui-dropdown-origin-open');\n  }\n\n  constructor(private elementRef: ElementRef, renderer: Renderer2, private cdr: ChangeDetectorRef) {\n    renderer.addClass(elementRef.nativeElement, 'devui-form-controls');\n  }\n\n  ngOnInit() {}\n\n  public updateErrorMessage(message: string) {\n    this.errorMessage = message;\n    this.cdr.detectChanges();\n  }\n\n  public updateFeedbackStatus(status: DFormControlStatus | null): void {\n    this.feedbackStatus = status;\n    this.cdr.detectChanges();\n  }\n}\n","<div class=\"devui-form-control-container\">\n  <ng-content></ng-content>\n  <span *ngIf=\"suffixTemplate\" class=\"devui-form-item-suffix suffix\">\n    <ng-template [ngTemplateOutlet]=\"suffixTemplate\"></ng-template>\n  </span>\n\n  <span [attr.class]=\"'devui-form-item-icon devui-form-item-icon-' + feedbackStatus\" *ngIf=\"feedbackStatus\">\n    <svg *ngIf=\"feedbackStatus === 'error'\" width=\"14px\" height=\"14px\" viewBox=\"0 0 16 16\">\n      <g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\n        <circle cx=\"8\" cy=\"8\" r=\"8\"></circle>\n        <polygon\n          points=\"8.07106781 6.65685425 10.8994949 3.82842712 12.3137085 5.24264069 9.48528137 8.07106781 12.3137085 10.8994949 10.8994949 12.3137085 8.07106781 9.48528137 5.24264069 12.3137085 3.82842712 10.8994949 6.65685425 8.07106781 3.82842712 5.24264069 5.24264069 3.82842712\"\n        ></polygon>\n      </g>\n    </svg>\n    <svg *ngIf=\"feedbackStatus === 'success'\" width=\"14px\" height=\"14px\" viewBox=\"0 0 16 16\">\n      <g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\n        <circle cx=\"8\" cy=\"8\" r=\"8\"></circle>\n        <polygon\n          points=\"6.53553391 9.77817459 12.1923882 4.12132034 13.6066017 5.53553391 6.53553391 12.6066017 3 9.07106781 4.41421356 7.65685425 6.53553391 9.77817459\"\n        ></polygon>\n      </g>\n    </svg>\n    <svg *ngIf=\"feedbackStatus === 'pending'\" width=\"14px\" height=\"14px\" viewBox=\"0 0 16 16\">\n      <g id=\"loading\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\n        <path\n          d=\"M8,0 C12.4,0 16,3.6 16,8 C16,12.4 12.4,16 8,16 C3.6,16 0,12.4 0,8 C0,3.6 3.6,0 8,0 Z M8,1 C4.15,1 1,4.15 1,8 C1,11.85 4.15,15 8,15 C11.85,15 15,11.85 15,8 C15,4.15 11.85,1 8,1 Z\"\n          fill-rule=\"nonzero\"\n        ></path>\n        <path d=\"M8,0 C12.4,0 16,3.6 16,8 L15,8 C15,4.15 11.85,1 8,1 L8,0 Z\" fill-rule=\"nonzero\"></path>\n      </g>\n    </svg>\n  </span>\n</div>\n<div class=\"devui-form-control-inner-content\">\n  <div class=\"devui-form-message\" *ngIf=\"errorMessage\">\n    <span class=\"devui-form-message-text\">\n      <span>\n        {{ errorMessage }}\n      </span>\n    </span>\n  </div>\n  <div *ngIf=\"extraInfo\" class=\"devui-form-control-extra-info\">\n    <ng-template [ngTemplateOutlet]=\"extraInfoTemplate || defaultTemplate\"> </ng-template>\n    <ng-template #defaultTemplate>\n      {{ extraInfo }}\n    </ng-template>\n  </div>\n</div>\n","import {\n  ChangeDetectorRef,\n  Component,\n  ElementRef,\n  HostBinding,\n  Input, Renderer2\n} from '@angular/core';\nimport { DFormControlStatus } from './validator-directive/validate.type';\n\n@Component({\n  selector: 'd-form-label',\n  templateUrl: './form-label.component.html',\n  styleUrls: ['./form-label.component.scss'],\n  preserveWhitespaces: false\n})\nexport class FormLabelComponent {\n  @Input() required = false;\n  @Input() hasHelp = false;\n  @Input() helpTips = '';\n\n  feedbackStatus: DFormControlStatus | null = null;\n\n  @HostBinding('class.devui-form-label-has-feedback') get status() {\n    return this.feedbackStatus !== null;\n  }\n\n  constructor(\n    private cdr: ChangeDetectorRef,\n    elementRef: ElementRef,\n    renderer: Renderer2\n  ) {\n    renderer.addClass(elementRef.nativeElement, 'devui-form-label');\n  }\n\n  public updateFeedbackStatus(status: DFormControlStatus | null): void {\n    this.feedbackStatus = status;\n    this.cdr.detectChanges();\n  }\n}\n","<span class=\"devui-form-span\" [ngClass]=\"{ 'devui-required': required }\">\n  <ng-content></ng-content>\n</span>\n<svg\n  *ngIf=\"hasHelp\"\n  dPopover\n  [content]=\"helpTipsTemplate\"\n  [popType]=\"'info'\"\n  [position]=\"'top'\"\n  [controlled]=\"true\"\n  trigger=\"hover\"\n  class=\"devui-helping\"\n  width=\"16px\"\n  height=\"16px\"\n  viewBox=\"0 0 16 16\"\n>\n  <g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\n    <path\n      d=\"M8,1 C9.88227821,1 11.6450792,1.74560326 12.9497351,3.05025198 C14.2543924,4.35492369 15,6.11772556 15,8 C15,9.88227587 14.2543913,11.6450767 12.949734,12.949734 C11.6450767,14.2543913 9.88227587,15 8,15 C6.11772556,15 4.35492369,14.2543924 3.05024866,12.9497318 C1.74560326,11.6450792 1,9.88227821 1,8 C1,6.11772322 1.74560213,4.35492125 3.0502542,3.05024755 C4.35492125,1.74560213 6.11772322,1 8,1 Z M8,11.2634757 C7.47757297,11.2634757 7.05405405,11.6869946 7.05405405,12.2094216 C7.05405405,12.7318486 7.47757297,13.1553676 8,13.1553676 C8.52242703,13.1553676 8.94594595,12.7318486 8.94594595,12.2094216 C8.94594595,11.6869946 8.52242703,11.2634757 8,11.2634757 Z M8,3.12834054 C6.43270866,3.12834054 5.16216216,4.39888703 5.16216216,5.96617838 C5.16216216,6.27963729 5.41627082,6.53374595 5.72972973,6.53374595 C6.04318864,6.53374595 6.2972973,6.27963729 6.2972973,5.96617838 C6.2972973,5.02580486 7.05962648,4.26347568 8,4.26347568 C8.94037352,4.26347568 9.7027027,5.02580486 9.7027027,5.96617838 C9.7027027,6.9065519 8.94037352,7.66888108 8,7.66888108 C7.68654109,7.66888108 7.43243243,7.92298974 7.43243243,8.23644865 L7.43243243,8.23644865 L7.43243243,9.74996216 L7.44157671,9.85198315 C7.48963374,10.1167525 7.72136986,10.3175297 8,10.3175297 L8,10.3175297 L8.10202099,10.3083855 C8.36679036,10.2603284 8.56756757,10.0285923 8.56756757,9.74996216 L8.56756757,9.74996216 L8.56756757,8.74578378 L8.72552115,8.71042694 C9.94134023,8.38984467 10.8378378,7.28270311 10.8378378,5.96617838 C10.8378378,4.39888703 9.56729134,3.12834054 8,3.12834054 Z\"\n      fill-rule=\"nonzero\"\n    ></path>\n  </g>\n</svg>\n<svg *ngIf=\"feedbackStatus === 'error'\" class=\"devui-icon devui-icon-error\" width=\"16px\" height=\"16px\" viewBox=\"0 0 16 16\">\n  <g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\n    <circle cx=\"8\" cy=\"8\" r=\"7\"></circle>\n    <path\n      d=\"M8,0 C3.6,0 0,3.6 0,8 C0,12.4 3.6,16 8,16 C12.4,16 16,12.4 16,8 C16,3.6 12.4,0 8,0 Z M9,12.6 L7,12.6 L7,10.6 L9,10.6 L9,12.6 Z M9,9.1 L7,9.1 L6.9,3.1 L9.1,3.1 L9,9.1 Z\"\n      fill-rule=\"nonzero\"\n    ></path>\n  </g>\n</svg>\n<ng-template #helpTipsTemplate>\n  <span class=\"devui-help-tips\">{{ helpTips }}</span>\n</ng-template>\n","import { ChangeDetectorRef, Component, ContentChild, ElementRef, HostBinding, Input, OnInit, Renderer2 } from '@angular/core';\nimport { FormControlComponent } from './form-control.component';\nimport { FormLabelComponent } from './form-label.component';\nimport { DFormControlStatus } from './validator-directive/validate.type';\n\n@Component({\n  selector: 'd-form-item',\n  template: ` <ng-content></ng-content> `,\n  styleUrls: ['./form-item.component.scss'],\n  preserveWhitespaces: false,\n})\nexport class FormItemComponent implements OnInit {\n  @HostBinding('class.devui-form-has-error-msg') _hasErrorMsg = false;\n\n  /**\n   * @deprecated Use dHasFeedback to replace, No longer support for label\n   */\n  @Input() dFeedbackType: 'label' | 'control';\n\n  @Input() dHasFeedback = false;\n\n  @ContentChild(FormControlComponent) controlInstance: FormControlComponent;\n  @ContentChild(FormLabelComponent) labelInstance: FormLabelComponent;\n\n  constructor(elementRef: ElementRef, renderer: Renderer2, private cdr: ChangeDetectorRef) {\n    // FIXME: 循环依赖，打包后将不可用：FormItemComponent -> FormDirective -> DFormControlRuleDirective -> FormItemComponent\n    // @Optional() @Host() @SkipSelf() private _dForm: FormDirective,\n\n    renderer.addClass(elementRef.nativeElement, 'devui-form-item');\n  }\n\n  ngOnInit() {}\n\n  updateFeedback(status: DFormControlStatus | null, updateMessage: string): void {\n    this._hasErrorMsg = !!updateMessage;\n\n    const feedbackType = this.dFeedbackType;\n    if (feedbackType === 'label' && this.labelInstance) {\n      this.labelInstance.updateFeedbackStatus(status);\n    } else if ((feedbackType === 'control' || this.dHasFeedback) && this.controlInstance) {\n      this.controlInstance.updateFeedbackStatus(status);\n    }\n\n    if (this.controlInstance) {\n      this.controlInstance.updateErrorMessage(updateMessage);\n    }\n\n    this.cdr.detectChanges();\n  }\n}\n","import { AbstractControl, ValidationErrors } from '@angular/forms';\n\nexport class DValidators {\n\n  /* Failed if only has whitespace */\n  static whiteSpace(control: AbstractControl): ValidationErrors|null {\n    let res = null;\n    if (typeof control.value === 'string' && control.value.length !== 0 && control.value.trim().length === 0) {\n      res =  { 'whitespace': true };\n    }\n    return res;\n  }\n}\n","import { AsyncValidatorFn, ValidatorFn, Validators } from '@angular/forms';\nimport { Observable } from 'rxjs';\nimport { DValidators } from './validators';\n\n/* pristine: 抛出error包括pristine状态\n ** dirty: 抛出error需在dirty状态\n */\nexport type DValidationErrorStrategy = 'pristine' | 'dirty';\n\nexport type DFormControlStatus = 'error' | 'pending' | 'success';\n\n// DForm ValidatorFn\nexport type DValidatorFn = (value: any) => boolean | string | { [key: string]: string } | null;\n\n// DForm AsyncValidatorFn\nexport type DAsyncValidatorFn = (value: any) => Observable<boolean | string | { [key: string]: string } | null>;\n\n/* id: 自定义验证器必须具有（也可不必）\n ** validator: 自定义验证器必须传入，可支持函数与正则类型，函数必须返回true或false\n ** 其他key：必须是已注册key\n ** priority: error抛出的优先级，同时错误，值越大越优先抛出，值相同，后注册先抛出\n ** COMMENT: 我们这里将提供warning状态，warning状态不会向上传递，不会加入实际校验器中，在所有校验器校验完成后进行校验，若有错则不再进行校验，若无错，则进行校验。\n ** warning若为异步校验器，只更新当前devui-pending状态，不更新全局\n */\nexport interface DValidateRule {\n  id?: string;\n  validator?: DValidatorFn | ValidatorFn;\n  message?: string | { [key: string]: string };\n  errorStrategy?: DValidationErrorStrategy;\n  priority?: number;\n  isNgValidator?: boolean;\n  validateLevel?: 'error' | 'warning'; // 校验级别\n  [id: string]: boolean | number | string | { [key: string]: string } | RegExp | DValidatorFn | ValidatorFn | undefined; // 万能key\n}\nexport interface DAsyncValidateRule {\n  id?: string;\n  validator?: DAsyncValidatorFn | AsyncValidatorFn;\n  message?: string | { [key: string]: string };\n  errorStrategy?: DValidationErrorStrategy;\n  priority?: number;\n  isNgValidator?: boolean;\n  validateLevel?: 'error' | 'warning'; // 校验级别\n  [id: string]: boolean | number | string | { [key: string]: string } | RegExp | DAsyncValidatorFn | AsyncValidatorFn | undefined; // 万能key\n}\n\n// TODO: 还需提供一个debounceTime\nexport type DValidateRules =\n  | {\n    validators?: DValidateRule[];\n    asyncValidators?: DAsyncValidateRule[];\n    asyncDebounceTime?: number; // 异步校验器debounceTime\n    errorStrategy?: DValidationErrorStrategy; // error更新策略\n    message?: string | { [key: string]: string }; // 统一配置的message\n    updateOn?: 'change' | 'blur' | 'submit'; // model更新策略\n    messageShowType?: 'popover' | 'text' | 'none'; // 消息自动显示策略（当前仅单个表单组件下生效），自身附着popover | form-control下显示 | 不显示，\n    popPosition?:\n    | 'left'\n    | 'right'\n    | 'top'\n    | 'bottom'\n    | 'bottom-left'\n    | 'bottom-right'\n    | 'top-left'\n    | 'top-right'\n    | 'left-top'\n    | 'left-bottom'\n    | 'right-top'\n    | 'right-bottom'\n    | (\n      | 'left'\n      | 'right'\n      | 'top'\n      | 'bottom'\n      | 'bottom-left'\n      | 'bottom-right'\n      | 'top-left'\n      | 'top-right'\n      | 'left-top'\n      | 'left-bottom'\n      | 'right-top'\n      | 'right-bottom'\n    )[];\n  }\n  | DValidateRule[];\n\n\nexport interface DValidateErrorStatus {\n  errorMessage: string | { [key: string]: string } | null;\n  showError: boolean;\n  errors: { [key: string]: any };\n}\n\n\n/* TODO: 这里是否需要导出 */\nexport const ruleReservedWords = [\n  'id',\n  'validator',\n  'message',\n  'errorStrategy',\n  'priority',\n  'isNgValidator',\n  'popPosition',\n  'asyncDebounceTime',\n];\n\n// 这里要考虑如果可全局添加默认\nexport const dDefaultValidators = {\n  required: Validators.required,\n  minlength: Validators.minLength, // 实际设置时再次调用该方法传入具体值\n  maxlength: Validators.maxLength, // 实际设置时再次调用该方法传入具体值\n  min: Validators.min,\n  max: Validators.max,\n  requiredTrue: Validators.requiredTrue,\n  email: Validators.email,\n  pattern: Validators.pattern,\n  whitespace: DValidators.whiteSpace,\n};\n\n\nexport interface DPopConfig {\n  popMaxWidth?: number;\n  zIndex?: number;\n}\n","import {\n  ComponentFactoryResolver,\n  ComponentRef,\n  Directive,\n  ElementRef,\n  EventEmitter,\n  Host,\n  Input,\n  OnChanges,\n  OnDestroy,\n  OnInit,\n  Optional,\n  Output,\n  Self,\n  SimpleChanges,\n  SkipSelf\n} from '@angular/core';\nimport {\n  AbstractControl,\n  AbstractControlDirective,\n  AsyncValidatorFn,\n  ControlContainer,\n  NgControl,\n  ValidationErrors,\n  ValidatorFn\n} from '@angular/forms';\nimport { I18nInterface, I18nService } from 'ng-devui/i18n';\nimport { OverlayContainerRef } from 'ng-devui/overlay-container';\nimport { PopoverComponent } from 'ng-devui/popover';\nimport { fromEvent, merge, Observable, Subject, timer } from 'rxjs';\nimport { map, switchMap, takeUntil } from 'rxjs/operators';\nimport { FormItemComponent } from '../form-item.component';\nimport {\n  DAsyncValidateRule,\n  dDefaultValidators,\n  DFormControlStatus,\n  DPopConfig,\n  DValidateErrorStatus,\n  DValidateRule,\n  DValidateRules,\n  DValidationErrorStrategy,\n  ruleReservedWords\n} from './validate.type';\n\n@Directive()\nexport abstract class DAbstractControlRuleDirective implements OnChanges {\n  /* mode is _cd.control */\n  public readonly _cd: AbstractControlDirective; // model is _cd.control\n\n  /* parent dValidateRuleDirective */\n  private _parent: DAbstractControlRuleDirective;\n\n  /* 预置rules: originRules */\n  private _originRules: DValidateRules;\n\n  /* rules */\n  private _rules: DValidateRules;\n\n  /* 统一设置错误抛出策略 */\n  private _errorStrategy: DValidationErrorStrategy = 'dirty'; // 统一设置错误抛出策略\n\n  /* rules map */\n  private _messageOpts: { [key: string]: DValidateRule | DAsyncValidateRule };\n\n  /* 是否已经注册监听 */\n  private _registered = false;\n\n  public readonly errors: { [key: string]: any } | null;\n\n  private _errorMessage: string = null;\n\n  /* status warning */\n  private _warning: boolean;\n\n  /* 内置国际化text */\n  i18nFormText: I18nInterface['form'];\n\n  /* language key */\n  _locale: string;\n  set locale(key: string) {\n    this._locale = key;\n    this._parseErrors(this._cd.control.errors);\n    this.updateStatusAndMessageToView(this._cd.control.status);\n  }\n\n  get locale(): string {\n    return this._locale;\n  }\n\n  public get errorMessage() {\n    return this._cd && this._cd.control.invalid\n      ? this._errorMessage || (this._rules && (this._rules as { message: string }).message)\n      : null;\n  }\n\n  public set errorMessage(msg: string) {\n    if (this._cd && this._cd.control.invalid) {\n      this._errorMessage = msg;\n    } else {\n      this._errorMessage = null;\n    }\n  }\n\n  @Output() dRulesStatusChange = new EventEmitter<DValidateErrorStatus>();\n\n  constructor(cd: AbstractControlDirective, parent: DAbstractControlRuleDirective) {\n    this._cd = cd;\n    this._parent = parent;\n  }\n\n  get isReady() {\n    return this._cd.control ? !(this._cd.control.invalid || this._cd.control.pending) : true;\n  }\n\n  get pending() {\n    return this._cd.control ? this._cd.control.pending : true;\n  }\n\n  /* 包含继承自父级的rule */\n  get fullRules(): DValidateRules {\n    const keysCanInherit = ['messageShowType', 'errorStrategy', 'messageToView', 'popPosition', 'asyncDebounceTime'];\n    const resRules = { ...this._rules };\n    keysCanInherit.forEach((key) => {\n      if (this._parent && this._parent.fullRules) {\n        resRules[key] = resRules[key] !== undefined ? resRules[key] : this._parent.fullRules[key];\n      }\n    });\n    return resRules;\n  }\n\n  get asyncValidatorDebounceTime(): number {\n    const time = (this.fullRules as { asyncDebounceTime: number }).asyncDebounceTime;\n    return time === undefined ? 300 : time;\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if ('rules' in changes && !this._rules) {\n      // TODO：提供外部调用可手动更新rule方法\n      this._rules = { ...this._originRules, ...this._translateRulesToObject(changes['rules'].currentValue) };\n      this.setupOrUpdateRules();\n    }\n\n    if (!this._registered) {\n      this._registerOnStatusChange();\n    }\n  }\n\n  public updateRules(rules: DValidateRules): void {\n    this._rules = { ...this._originRules, ...this._translateRulesToObject(rules) };\n    this.setupOrUpdateRules();\n  }\n\n  public setOriginRules(rules: DValidateRules): void {\n    this._originRules = this._translateRulesToObject(rules);\n  }\n\n  public setupOrUpdateRules(): void {\n    // TODO：校验rules规则是否合法\n    this._transformRulesAndUpdateToModel();\n    this._setUpdateStrategy();\n  }\n  private _transformRulesAndUpdateToModel(): void {\n    this._messageOpts = {};\n\n    if (!Array.isArray(this._rules)) {\n      if (this._rules.validators) {\n        const validators: ValidatorFn[] = this._transformValidatorsToFnArray(this._rules.validators) as ValidatorFn[];\n        this._updateValidators(validators);\n      }\n      if (this._rules.asyncValidators) {\n        const asyncValidators: AsyncValidatorFn[] = this._transformValidatorsToFnArray(\n          this._rules.asyncValidators,\n          true\n        ) as AsyncValidatorFn[];\n        this._updateAsyncValidators(asyncValidators);\n      }\n    } else {\n      const validators: ValidatorFn[] = this._transformValidatorsToFnArray(this._rules) as ValidatorFn[];\n      this._updateValidators(validators);\n    }\n    this._updateValueAndValidity();\n  }\n\n  private _transformValidatorsToFnArray(\n    validators: DValidateRule[] | DAsyncValidateRule[],\n    async = false\n  ): ValidatorFn[] | AsyncValidatorFn[] {\n    const resultFns = [];\n    validators.forEach((validatorRule: DValidateRule) => {\n      // TODO: 提供可全局统一注册方法\n      const validatorId: string = this._autoGetIdFromRule(validatorRule);\n      let validator = null;\n\n      if (!validatorId) {\n        // TODO：抛出错误\n      }\n\n      if (validatorId in dDefaultValidators) {\n        validator = this._generateValidatorFnFromDefault(validatorId, validatorRule[validatorId]);\n      } else {\n        if (typeof validatorRule[validatorId] === 'string') {\n          validator = validatorRule.validator;\n        } else {\n          validator = validatorRule[validatorId];\n        }\n        if (!validatorRule.isNgValidator) {\n          if (!async) {\n            validator = this._transformRuleToNgValidator(validatorId, validator, validatorRule.message);\n          } else {\n            validator = this._transformRuleToNgAsyncValidator(validatorId, validator, validatorRule.message);\n          }\n        }\n      }\n\n      if (validator) {\n        if (async && this.asyncValidatorDebounceTime) {\n          const oldValidator = validator;\n          validator = (control: AbstractControl): Observable<ValidationErrors | null> => {\n            return timer(this.asyncValidatorDebounceTime).pipe(\n              switchMap(() => {\n                return oldValidator(control);\n              })\n            );\n          };\n        }\n        resultFns.push(validator);\n        this._messageOpts[validatorId] = validatorRule;\n      }\n      // else {\n      //   // TODO: 抛出错误\n      // }\n    });\n    return resultFns as AsyncValidatorFn[] | ValidatorFn[];\n  }\n\n  private _translateRulesToObject(rules: DValidateRules) {\n    if (Array.isArray(rules)) {\n      return {\n        validators: rules,\n      };\n    }\n\n    return rules;\n  }\n\n  private _findNgValidatorInDefault(validatorRule: DValidateRule) {\n    for (const key in dDefaultValidators) {\n      if (Object.prototype.hasOwnProperty.call(validatorRule, key)) {\n        return { id: key, ngValidator: this._generateValidatorFnFromDefault(key, validatorRule[key]) };\n      }\n    }\n    return null;\n  }\n\n  private _generateValidatorFnFromDefault(key, value) {\n    if (typeof value === 'boolean' && value) {\n      // boolean无需再执行函数进行传值\n      return dDefaultValidators[key];\n    } else if (typeof value !== 'boolean') {\n      return dDefaultValidators[key](value);\n    }\n    return null;\n  }\n\n  private _transformRuleToNgValidator(id, validatorFn, message) {\n    return (control: AbstractControl): ValidationErrors | null => {\n      const res = validatorFn(control.value);\n      return this._transValidatorResultToNgError(id, res, message);\n    };\n  }\n\n  private _transformRuleToNgAsyncValidator(id, validator, message) {\n    return (control: AbstractControl): Observable<ValidationErrors | null> => {\n      return (validator(control.value) as Observable<boolean>).pipe(\n        map((res) => {\n          return this._transValidatorResultToNgError(id, res, message);\n        })\n      );\n    };\n  }\n\n  private _transValidatorResultToNgError(id: string, res: boolean | string | null, message: string) {\n    let error = null;\n    if (typeof res === 'boolean' && !res) {\n      error = {};\n      error[id] = message;\n    } else if (typeof res === 'string' || (res && typeof res === 'object')) {\n      // 兼容国际化词条\n      error = {};\n      error[id] = res;\n    }\n    return error;\n  }\n\n  private _autoGetIdFromRule(rule: DValidateRule | DAsyncValidateRule) {\n    for (const key in rule) {\n      if (!(key in ruleReservedWords)) {\n        return key;\n      }\n    }\n    return rule.id || null;\n  }\n\n  // TODO: 考虑自定义函数返回多种key场景\n  get dClassError() {\n    if (this._errorStrategy === 'dirty') {\n      return this._cd.control ? this._cd.control.invalid && this._cd.control.dirty : false;\n    } else {\n      return this._cd.control ? this._cd.control.invalid : false;\n    }\n  }\n\n  get showError() {\n    return this.dClassError;\n  }\n\n  get showStatus() {\n    if (this._errorStrategy === 'dirty') {\n      return this._cd.control ? this._cd.control.dirty : false;\n    } else {\n      return true;\n    }\n  }\n\n  get dClassSuccess() {\n    // COMMENT: 暂不默认提供\n    if (this._rules['errorStrategy'] === 'dirty') {\n      return this._cd.control ? this._cd.control.valid && this._cd.control.dirty : false;\n    } else if (!this._rules['errorStrategy']) {\n      return false;\n    } else {\n      return this._cd.control ? this._cd.control.valid : false;\n    }\n  }\n\n  get dClassWarning() {\n    return this._warning ? true : false;\n  }\n\n  get invalid() {\n    return this._cd.control ? this._cd.control.invalid : false;\n  }\n\n  private _registerOnStatusChange() {\n    if (this._cd && this._cd.control) {\n      this._cd.control.statusChanges.subscribe((status) => {\n        this._parseErrors(this._cd.control.errors);\n        this._updateParent(); // update error message to parent directive\n        this.updateStatusAndMessageToView(status);\n      });\n      this._registered = true;\n    }\n  }\n\n  private _parseErrors(errors: { [key: string]: any }): void {\n    if (!errors) {\n      this._errorMessage = null;\n    } else {\n      /* if a rule did not have a message, we will try to get a message from errors by id */\n      const { resId, resRule } = this._getARuleByErrors(errors);\n      this._errorStrategy = this._getErrorStrategy(resRule);\n      this._errorMessage =\n        resRule &&\n        (resRule.message ||\n          this._getMessageFormErrorsById(errors, resId) ||\n          this._getDefaultErrorMessage(resRule, resId) ||\n          (this._rules as { message: string }).message);\n    }\n\n    this.dRulesStatusChange.emit({\n      showError: this.showError,\n      errorMessage: this._errorMessage,\n      errors: errors,\n    });\n  }\n\n  private _getDefaultErrorMessage(rule, id) {\n    return rule && rule[id] && this.i18nFormText[id] && this.i18nFormText[id](rule[id]);\n  }\n\n  private _getErrorStrategy(rule?) {\n    return (rule && rule.errorStrategy) || this._rules['errorStrategy'] || 'dirty';\n  }\n\n  private _getMessageFormErrorsById(errors: { [key: string]: any }, id: string): string | null {\n    if (errors[id] && typeof errors[id] === 'string') {\n      return errors[id];\n    } else if (errors[id] && typeof errors[id] === 'object' && (errors[id][this.locale] || errors[id]['default'])) {\n      return errors[id];\n    } else {\n      return null;\n    }\n  }\n\n  private _getARuleByErrors(errors: { [key: string]: any }) {\n    // TODO：处理errors为null\n    let resId: string;\n    let resRule = null;\n    for (const key of Object.keys(errors)) {\n      if (this._messageOpts[key]) {\n        if (resRule) {\n          const priority = resRule.priority || 0;\n          if (this._messageOpts[key].priority && this._messageOpts[key].priority > priority) {\n            resId = key;\n            resRule = this._messageOpts[key];\n          }\n        } else {\n          resId = key;\n          resRule = this._messageOpts[key];\n        }\n      }\n    }\n    return { resId: resId, resRule: resRule };\n  }\n\n  _updateParent() {\n    if (this._parent) {\n      // TODO\n    }\n  }\n\n  private _setUpdateStrategy(): void {\n    if (!Array.isArray(this._rules) && typeof this._rules === 'object' && this._rules.updateOn) {\n      (this._cd.control as any)._updateOn = this._rules.updateOn;\n    }\n  }\n\n  public _updateValueAndValidity() {\n    if (this._cd && this._cd.control) {\n      this._cd.control.updateValueAndValidity();\n    }\n  }\n\n  private _updateValidators(newValidator: ValidatorFn | ValidatorFn[] | null): void {\n    if (this._cd && this._cd.control) {\n      this._cd.control.setValidators(newValidator);\n    }\n  }\n\n  private _updateAsyncValidators(newValidator: AsyncValidatorFn | AsyncValidatorFn[] | null): void {\n    if (this._cd && this._cd.control) {\n      this._cd.control.setAsyncValidators(newValidator);\n    }\n  }\n\n  abstract updateStatusAndMessageToView(status: any): void;\n}\n\nconst dControlErrorStatusHost = {\n  '[class.devui-error]': 'dClassError',\n  '[class.devui-success]': 'dClassSuccess',\n  '[class.devui-warning]': 'dClassWarning',\n};\n\n@Directive({\n  selector: `[dValidateRules][formGroupName],[dValidateRules][formArrayName],[dValidateRules][ngModelGroup],\n          [dValidateRules][formGroup],[dValidateRules]form:not([ngNoForm]),[dValidateRules][ngForm]`,\n  /* eslint-disable-next-line @angular-eslint/no-host-metadata-property*/\n  host: dControlErrorStatusHost,\n  exportAs: 'dValidateRules',\n})\nexport class DFormGroupRuleDirective extends DAbstractControlRuleDirective implements OnInit, OnChanges, OnDestroy {\n  @Input('dValidateRules') rules: DValidateRules;\n  @Output() dRulesStatusChange: EventEmitter<any> = new EventEmitter<any>();\n\n  private destroy$ = new Subject();\n\n  constructor(@Self() cd: ControlContainer, @Optional() @Host() @SkipSelf() parentDir: DFormGroupRuleDirective, private i18n: I18nService) {\n    super(cd, parentDir);\n  }\n\n  ngOnInit(): void {\n    this.i18nFormText = this.i18n.getI18nText().form;\n    this.locale = this.i18n.getI18nText().locale;\n\n    this.i18n\n      .langChange()\n      .pipe(takeUntil(this.destroy$))\n      .subscribe((data: I18nInterface) => {\n        this.i18nFormText = data.form;\n        this.locale = data.locale;\n      });\n  }\n\n  ngOnDestroy(): void {\n    this.destroy$.next();\n    this.destroy$.complete();\n  }\n\n  setErrorMessageByChild(msg: string) {\n    if (!this.errorMessage) {\n      this.errorMessage = msg;\n    }\n  }\n\n  updateStatusAndMessageToView(status: any): void {\n    // do nothing\n  }\n}\n\n@Directive({\n  selector: '[dValidateRules][formControlName],[dValidateRules][ngModel],[dValidateRules][formControl]',\n  /* eslint-disable-next-line @angular-eslint/no-host-metadata-property*/\n  host: dControlErrorStatusHost,\n  exportAs: 'dValidateRules',\n})\nexport class DFormControlRuleDirective extends DAbstractControlRuleDirective implements OnInit, OnChanges, OnDestroy {\n  @Input('dValidateRules') rules: DValidateRules;\n  @Output() dRulesStatusChange: EventEmitter<any> = new EventEmitter<any>();\n\n  @Input('dValidatePopConfig') popConfig: DPopConfig;\n\n  popoverComponentRef: ComponentRef<PopoverComponent>;\n  private destroy$ = new Subject();\n  popMessage: string; // 最终显示的message\n\n  get showType() {\n    return (this.fullRules as { messageShowType: string }).messageShowType || 'popover';\n  }\n\n  get popPosition() {\n    return (this.fullRules as { popPosition: any }).popPosition || ['right', 'bottom'];\n  }\n\n  constructor(\n  @Self() cd: NgControl,\n          @Optional() @Host() private dFormItem: FormItemComponent,\n          @Optional() @Host() @SkipSelf() parentDir: DFormGroupRuleDirective,\n          private i18n: I18nService,\n          public triggerElementRef: ElementRef,\n          private overlayContainerRef: OverlayContainerRef,\n          private componentFactoryResolver: ComponentFactoryResolver\n  ) {\n    super(cd, parentDir);\n  }\n\n  ngOnInit(): void {\n    this.setI18nText();\n    this._registerFocusChange();\n  }\n\n  setI18nText() {\n    this.i18nFormText = this.i18n.getI18nText().form;\n    this.locale = this.i18n.getI18nText().locale;\n\n    this.i18n\n      .langChange()\n      .pipe(takeUntil(this.destroy$))\n      .subscribe((data: I18nInterface) => {\n        this.i18nFormText = data.form;\n        this.locale = data.locale;\n      });\n  }\n\n  _registerFocusChange() {\n    merge(fromEvent(this.triggerElementRef.nativeElement, 'focusin'), fromEvent(this.triggerElementRef.nativeElement, 'focusout'))\n      .pipe(takeUntil(this.destroy$))\n      .subscribe((event: Event) => {\n        if (event.type === 'focusin') {\n          this.showPopMessage();\n        }\n        if (event.type === 'focusout') {\n          this.hidePopMessage();\n        }\n      });\n  }\n\n  _updateFormContainer(status, message: string): void {\n    if (this.dFormItem) {\n      this.dFormItem.updateFeedback(status, message);\n    }\n  }\n\n  _updatePopMessage(status: DFormControlStatus, message: string): void {\n    this.popMessage = status === 'error' ? message : null; // 暂不提供除errorMessage外提示\n    if (this.popoverComponentRef) {\n      this.hidePopMessage();\n      this.showPopMessage();\n    }\n  }\n\n  updateStatusAndMessageToView(status: any): void {\n    let controlStatus = null;\n    let message = null;\n    if (this.showStatus) {\n      [controlStatus, message] = this.getFormControlStatusAndMessage(status);\n    }\n\n    /* 国际化适配 */\n    if (message && typeof message === 'object') {\n      message = message[this.locale] || message['default'] || null;\n    }\n\n    if (this.showType === 'popover') {\n      this._updatePopMessage(controlStatus, message);\n      this._updateFormContainer(controlStatus, null);\n    } else if (this.showType === 'text') {\n      this._updateFormContainer(controlStatus, message);\n    }\n  }\n\n  getFormControlStatusAndMessage(ngStatus: any) {\n    let status = null;\n    let message = null;\n    if (ngStatus === 'INVALID') {\n      status = 'error';\n      message = this.errorMessage;\n    } else if (ngStatus === 'PENDING') {\n      status = 'pending';\n    } else if (ngStatus === 'VALID') {\n      status = 'success';\n    }\n    return [status, message];\n  }\n\n  createPopover(type: 'error' | 'warning', content: string) {\n    this.popoverComponentRef = this.overlayContainerRef.createComponent(\n      this.componentFactoryResolver.resolveComponentFactory(PopoverComponent)\n    );\n    Object.assign(this.popoverComponentRef.instance, {\n      content: content,\n      triggerElementRef: this.triggerElementRef,\n      position: this.popPosition,\n      popType: type,\n      popMaxWidth: this.popConfig?.popMaxWidth || 200,\n      appendToBody: true,\n      zIndex: this.popConfig?.zIndex || 1060,\n    });\n  }\n\n  public showPopMessage() {\n    this.showPop('error', this.popMessage);\n    if (this.popMessage) {\n      this._updateFormContainer(null, null);\n    }\n  }\n\n  public hidePopMessage() {\n    this.hidePop();\n    if (this.popMessage) {\n      this._updateFormContainer(this.showError ? 'error' : null, null);\n    }\n  }\n\n  showPop(type, message) {\n    this.hidePop();\n    this.createPopover(type, message);\n  }\n\n  hidePop() {\n    if (this.popoverComponentRef) {\n      this.destroyPop();\n    }\n  }\n\n  destroyPop() {\n    if (this.popoverComponentRef) {\n      this.popoverComponentRef.destroy();\n      this.popoverComponentRef = null;\n    }\n  }\n\n  ngOnDestroy(): void {\n    this.destroyPop();\n    this.destroy$.next();\n    this.destroy$.complete();\n  }\n}\n","import { ContentChildren, Directive, EventEmitter, HostBinding, Input, Optional, Output, QueryList, Self } from '@angular/core';\nimport { AbstractControl, AbstractControlDirective, ControlContainer, NgForm, ValidationErrors } from '@angular/forms';\nimport { filter, startWith, take } from 'rxjs/operators';\nimport { DFormControlRuleDirective, DFormGroupRuleDirective } from './validator-directive/form-control-rules.directive';\n\nexport enum FormLayout {\n  Horizontal = 'horizontal',\n  Vertical = 'vertical',\n  Columns = 'columns',\n}\n\n@Directive({\n  selector: '[dForm]',\n  exportAs: 'dForm',\n})\nexport class FormDirective {\n  @Input() layout = FormLayout.Horizontal;\n  @Input() labelSize: 'sm' | '' | 'lg' = '';\n  @Input() labelAlign: 'start' | 'center' | 'end' = 'start';\n\n  /**\n   * @deprecated Use dHasFeedback to replace, No longer support for label\n   */\n  @Input() dFeedbackType: 'label' | 'control';\n\n  @Input() dHasFeedback = false;\n\n  @Output() dSubmit = new EventEmitter();\n\n  public readonly _cd: AbstractControlDirective;\n  public readonly _dValidateRuleDir: DFormGroupRuleDirective;\n  @ContentChildren(DFormControlRuleDirective, { descendants: true }) childrenCtrDirs: QueryList<DFormControlRuleDirective>;\n\n  @HostBinding('class.devui-form-horizontal')\n  get layoutHorizontal() {\n    return this.layout === FormLayout.Horizontal;\n  }\n\n  @HostBinding('class.devui-form-vertical')\n  get layoutVertical() {\n    return this.layout === FormLayout.Vertical;\n  }\n\n  @HostBinding('class.devui-form-columns')\n  get layoutColumns() {\n    return this.layout === FormLayout.Columns;\n  }\n\n  @HostBinding('class.devui-form-lg')\n  get labelSizeLg() {\n    return this.labelSize === 'lg';\n  }\n\n  @HostBinding('class.devui-form-sm')\n  get labelSizeSm() {\n    return this.labelSize === 'sm';\n  }\n\n  @HostBinding('class.devui-form-label-align-start')\n  get labelAlignStart() {\n    return this.labelAlign === 'start';\n  }\n\n  @HostBinding('class.devui-form-label-align-center')\n  get labelAlignCenter() {\n    return this.labelAlign === 'center';\n  }\n\n  @HostBinding('class.devui-form-label-align-end')\n  get labelAlignEnd() {\n    return this.labelAlign === 'end';\n  }\n\n  updateOnSubmit($event?, data?: any) {\n    this._operateAllControl(this._cd.control, (cd: AbstractControl) => {\n      cd.markAsDirty();\n      cd.updateValueAndValidity();\n    });\n\n    /* emit event should after validate */\n    this._cd.control.statusChanges\n      .pipe(\n        startWith(this._cd.control.status),\n        filter((status) => {\n          return status !== 'PENDING';\n        }),\n        take(1)\n      )\n      .subscribe(() => {\n        if (this._cd) {\n          (this._cd as NgForm).onSubmit($event); // TODO: 需触发原生form表单的submit方法\n          if (this._dValidateRuleDir) {\n            this.dSubmit.emit({\n              valid: this._dValidateRuleDir.isReady,\n              directive: this._dValidateRuleDir,\n              data: data,\n              errors: this._getAllErrors(this._cd.control)\n            });\n          } else {\n            this.dSubmit.emit({\n              valid: this._cd.valid,\n              directive: this._cd,\n              data: data,\n              errors: this._getAllErrors(this._cd.control)\n            });\n          }\n        }\n\n        if (this.childrenCtrDirs) {\n          for (const validateDir of this.childrenCtrDirs) {\n            if (validateDir.invalid && validateDir.showType === 'popover') {\n              validateDir.showPopMessage(); // TODO: 表单类组件需要实现focus方法，若无focus，将无法正常blur\n              break;\n            }\n          }\n        }\n      });\n  }\n\n  updateOnReset() {\n    if (this._cd) {\n      (this._cd as NgForm).onReset(); // TODO: 需触发原生form表单的reset方法\n    }\n    this._operateAllControl(this._cd.control, (cd: AbstractControl) => {\n      cd.markAsPristine();\n      cd.updateValueAndValidity();\n    });\n  }\n\n  private _operateAllControl(control: AbstractControl, operatorFn: (control: AbstractControl) => void) {\n    if (control) {\n      operatorFn(control);\n      const controls = (control as any).controls;\n      if (controls) {\n        for (const key of Object.keys(controls)) {\n          this._operateAllControl(controls[key], operatorFn);\n        }\n      }\n    }\n  }\n\n  private _getAllErrors(control: AbstractControl) {\n    const res: {[key: string]: ValidationErrors} = {};\n    if (control) {\n      res.errors = control.errors;\n      const controls = (control as any).controls;\n      if (controls) {\n        for (const key of Object.keys(controls)) {\n          res[key] = this._getAllErrors(controls[key]);\n        }\n      }\n    }\n\n    return res;\n  }\n\n  constructor(@Optional() @Self() cd: ControlContainer, @Optional() @Self() dValidateRuleDir: DFormGroupRuleDirective) {\n    this._cd = cd;\n    this._dValidateRuleDir = dValidateRuleDir;\n  }\n}\n","import {\n  AfterViewInit,\n  ChangeDetectionStrategy,\n  Component,\n  Directive,\n  ElementRef,\n  Host,\n  HostBinding,\n  Input,\n  OnDestroy,\n  OnInit,\n  Optional,\n  Renderer2\n} from '@angular/core';\nimport { fromEvent, Subject } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\nimport { FormDirective } from './form.directive';\n\n@Component({\n  selector: 'd-form-operation',\n  template: '<ng-content></ng-content>',\n  styles: [\n    `\n      .devui-form-horizontal :host.devui-form-operation {\n        display: block;\n        margin-left: 96px;\n      }\n      .devui-form-vertical :host.devui-form-operation {\n        display: block;\n      }\n      .devui-form-columns :host.devui-form-operation {\n        display: block;\n        padding: 8px 0;\n      }\n    `,\n  ],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  preserveWhitespaces: false,\n})\nexport class FormOperationComponent implements OnInit {\n  constructor(elementRef: ElementRef, renderer: Renderer2) {\n    renderer.addClass(elementRef.nativeElement, 'devui-form-operation');\n  }\n\n  ngOnInit() {}\n}\n\n@Directive({\n  selector: '[dFormSubmit]',\n})\nexport class DFormSubmitDirective implements AfterViewInit, OnDestroy {\n  @HostBinding('class.devui-form-submit') default = true;\n\n  _eventName = 'click';\n  @Input('dFormSubmit')\n  set eventName(eventName) {\n    if (eventName) {\n      this._eventName = eventName;\n      this.registerEvent();\n    }\n  }\n\n  @Input('dFormSubmitData') data: any;\n\n  private destroy$ = new Subject();\n\n  // TODO：这里是否需要接管如果所关联的表单校验不通过，切换到disabled状态\n\n  constructor(private elementRef: ElementRef, @Optional() @Host() private _dForm: FormDirective) {}\n\n  ngAfterViewInit() {\n    this.registerEvent();\n  }\n\n  ngOnDestroy() {\n    this.destroy$.next();\n    this.destroy$.complete();\n  }\n\n  registerEvent() {\n    this.destroy$.next();\n    fromEvent(this.elementRef.nativeElement, this._eventName)\n      .pipe(takeUntil(this.destroy$))\n      .subscribe(($event) => {\n        if (this._dForm) {\n          this._dForm.updateOnSubmit($event, this.data);\n        }\n      });\n  }\n}\n\n@Directive({\n  selector: '[dFormReset]',\n})\nexport class DFormResetDirective implements AfterViewInit, OnDestroy {\n  @HostBinding('class.devui-form-reset') default = true;\n\n  // TODO: emit now form\n  // TODO: Abstract a parent class\n  _eventName = 'click';\n  @Input('dFormReset')\n  set eventName(eventName) {\n    if (eventName) {\n      this._eventName = eventName;\n      this.registerEvent();\n    }\n  }\n\n  private destroy$ = new Subject();\n\n  constructor(private elementRef: ElementRef, @Optional() @Host() private _dForm: FormDirective) {}\n\n  ngAfterViewInit() {\n    this.registerEvent();\n  }\n\n  ngOnDestroy() {\n    this.destroy$.next();\n    this.destroy$.complete();\n  }\n\n  registerEvent() {\n    this.destroy$.next();\n    fromEvent(this.elementRef.nativeElement, this._eventName)\n      .pipe(takeUntil(this.destroy$))\n      .subscribe(() => {\n        if (this._dForm) {\n          this._dForm.updateOnReset();\n        }\n      });\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { AbstractControl } from '@angular/forms';\nimport { Subscription } from 'rxjs';\n\nfunction resolvedPromiseFunc() { return Promise.resolve(null); }\nconst resolvedPromise = resolvedPromiseFunc();\n@Injectable({ providedIn: 'root' })\nexport class DValidateSyncService {\n\n  controlsMap: Map<string, AbstractControl[]>;\n  controlsSubMap: Map<AbstractControl, Subscription>;\n\n  constructor() {\n    this.controlsMap = new Map();\n    this.controlsSubMap = new Map();\n  }\n\n  addControl(key: string, cd: AbstractControl): void {\n    if (!this.controlsMap.get(key)) {\n      this.controlsMap.set(key, []);\n    }\n    this.controlsMap.get(key).push(cd);\n    this._addControlSubscription(key, cd);\n  }\n\n  removeControl(key: string, cd: AbstractControl): void {\n    if (this.controlsMap.get(key)) {\n      const controls = this.controlsMap.get(key);\n      const index = controls.indexOf(cd);\n      if (index !== -1) {\n        controls.splice(index, 1);\n      }\n    }\n    this._removeControlSubscription(cd);\n  }\n\n  validateControlsSync(key: string, cd: AbstractControl): void {\n    const controls = this.controlsMap.get(key);\n\n    if (controls) {\n      controls.forEach(control => { // 首先清除当前周期监听，避免循环监听\n        this._removeControlSubscription(control);\n      });\n\n      controls.forEach(control => {\n        if (control !== cd) {\n          resolvedPromise.then(() => { // 在下一个视图更新周期执行\n            control.updateValueAndValidity();\n          });\n        }\n      });\n\n      controls.forEach(control => {\n        resolvedPromise.then(() => {\n          this._addControlSubscription(key, control);\n        });\n      });\n    }\n  }\n\n  _addControlSubscription(key: string, cd: AbstractControl): void {\n    this._removeControlSubscription(cd);\n    const sub = cd.valueChanges.subscribe(() => {\n      this.validateControlsSync(key, cd);\n    });\n    this.controlsSubMap.set(cd, sub);\n  }\n\n  _removeControlSubscription(cd: AbstractControl): void {\n    if (this.controlsSubMap.get(cd)) {\n      this.controlsSubMap.get(cd).unsubscribe();\n      this.controlsSubMap.delete(cd);\n    }\n  }\n}\n","import { Directive, Input, OnChanges, OnDestroy, Self } from '@angular/core';\nimport { NgControl } from '@angular/forms';\nimport { DValidateSyncService } from '../services/d-validate-sync.service';\n\n@Directive({\n  selector: `[dValidateSyncKey][formControlName],[dValidateSyncKey][ngModel],[dValidateSyncKey][formControl],\n    [dValidateSyncKey][formGroupName],[dValidateSyncKey][formArrayName],[dValidateSyncKey][ngModelGroup],\n    [dValidateSyncKey][formGroup],[dValidateSyncKey]form:not([ngNoForm]),[dValidateSyncKey][ngForm]\n  `,\n  exportAs: 'dValidateSync'\n})\n\nexport class DValidateSyncDirective implements OnChanges, OnDestroy {\n\n  private _added = false;\n\n  @Input('dValidateSyncKey') key: string;\n\n  constructor(@Self() private _cd: NgControl, private syncService: DValidateSyncService) {}\n\n  ngOnChanges() {\n    if (this.key && this._cd.control && !this._added) {\n      this.syncService.addControl(this.key, this._cd.control);\n      this._added = true;\n    }\n  }\n\n  ngOnDestroy(): void {\n    if (this.key && this._cd.control) {\n      this.syncService.removeControl(this.key, this._cd.control);\n    }\n  }\n}\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { PopoverModule } from 'ng-devui/popover';\nimport { FormControlComponent } from './form-control.component';\nimport { FormItemComponent } from './form-item.component';\nimport { FormLabelComponent } from './form-label.component';\nimport { DFormResetDirective, DFormSubmitDirective, FormOperationComponent } from './form-operation.component';\nimport { FormDirective } from './form.directive';\nimport { DValidateSyncDirective } from './validator-directive/d-validate-sync.directive';\nimport { DFormControlRuleDirective, DFormGroupRuleDirective } from './validator-directive/form-control-rules.directive';\n\n@NgModule({\n  imports: [CommonModule, ReactiveFormsModule, FormsModule, PopoverModule],\n  exports: [\n    FormItemComponent,\n    FormLabelComponent,\n    FormControlComponent,\n    FormOperationComponent,\n    FormDirective,\n    DFormGroupRuleDirective,\n    DFormControlRuleDirective,\n    DFormSubmitDirective,\n    DFormResetDirective,\n    DValidateSyncDirective\n  ],\n  declarations: [\n    FormItemComponent,\n    FormLabelComponent,\n    FormControlComponent,\n    FormOperationComponent,\n    FormDirective,\n    DFormGroupRuleDirective,\n    DFormControlRuleDirective,\n    DFormSubmitDirective,\n    DFormResetDirective,\n    DValidateSyncDirective\n  ],\n  providers: [],\n})\nexport class FormModule {\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":[],"mappings":";;;;;;;;;;;;;MASa,oBAAoB;IA2B/B,YAAoB,UAAsB,EAAE,QAAmB,EAAU,GAAsB;QAA3E,eAAU,GAAV,UAAU,CAAY;QAA+B,QAAG,GAAH,GAAG,CAAmB;QAC7F,QAAQ,CAAC,QAAQ,CAAC,UAAU,CAAC,aAAa,EAAE,qBAAqB,CAAC,CAAC;KACpE;IA3BD,IAAI,iBAAiB;QACnB,OAAO,IAAI,CAAC,SAAS,YAAY,WAAW,GAAG,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;KACtE;IAOD,IAA0D,MAAM;QAC9D,OAAO,CAAC,CAAC,IAAI,CAAC,cAAc,CAAC;KAC9B;IAED,IAAwD,MAAM;QAC5D,OAAO,CAAC,CAAC,IAAI,CAAC,cAAc,CAAC;KAC9B;;;;;IAMD,IAA0D,YAAY;QACpE,OAAO,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,aAAa,CAAC,6BAA6B,CAAC,CAAC;KACrF;IAMD,QAAQ,MAAK;IAEN,kBAAkB,CAAC,OAAe;QACvC,IAAI,CAAC,YAAY,GAAG,OAAO,CAAC;QAC5B,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;KAC1B;IAEM,oBAAoB,CAAC,MAAiC;QAC3D,IAAI,CAAC,cAAc,GAAG,MAAM,CAAC;QAC7B,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;KAC1B;;iHAzCU,oBAAoB;qGAApB,oBAAoB,oWCTjC,k9EAiDA;2FDxCa,oBAAoB;kBANhC,SAAS;+BACE,gBAAgB,uBAGL,KAAK;yJAGjB,SAAS;sBAAjB,KAAK;gBAMG,cAAc;sBAAtB,KAAK;gBAEG,cAAc;sBAAtB,KAAK;gBAEoD,MAAM;sBAA/D,WAAW;uBAAC,uCAAuC;gBAII,MAAM;sBAA7D,WAAW;uBAAC,qCAAqC;gBAQQ,YAAY;sBAArE,WAAW;uBAAC,uCAAuC;;;MEjBzC,kBAAkB;IAW7B,YACU,GAAsB,EAC9B,UAAsB,EACtB,QAAmB;QAFX,QAAG,GAAH,GAAG,CAAmB;QAXvB,aAAQ,GAAG,KAAK,CAAC;QACjB,YAAO,GAAG,KAAK,CAAC;QAChB,aAAQ,GAAG,EAAE,CAAC;QAEvB,mBAAc,GAA8B,IAAI,CAAC;QAW/C,QAAQ,CAAC,QAAQ,CAAC,UAAU,CAAC,aAAa,EAAE,kBAAkB,CAAC,CAAC;KACjE;IAVD,IAAwD,MAAM;QAC5D,OAAO,IAAI,CAAC,cAAc,KAAK,IAAI,CAAC;KACrC;IAUM,oBAAoB,CAAC,MAAiC;QAC3D,IAAI,CAAC,cAAc,GAAG,MAAM,CAAC;QAC7B,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;KAC1B;;+GAtBU,kBAAkB;mGAAlB,kBAAkB,gNCf/B,upFAmCA;2FDpBa,kBAAkB;kBAN9B,SAAS;+BACE,cAAc,uBAGH,KAAK;yJAGjB,QAAQ;sBAAhB,KAAK;gBACG,OAAO;sBAAf,KAAK;gBACG,QAAQ;sBAAhB,KAAK;gBAIkD,MAAM;sBAA7D,WAAW;uBAAC,qCAAqC;;;MEXvC,iBAAiB;IAa5B,YAAY,UAAsB,EAAE,QAAmB,EAAU,GAAsB;;;QAAtB,QAAG,GAAH,GAAG,CAAmB;QAZxC,iBAAY,GAAG,KAAK,CAAC;QAO3D,iBAAY,GAAG,KAAK,CAAC;QAS5B,QAAQ,CAAC,QAAQ,CAAC,UAAU,CAAC,aAAa,EAAE,iBAAiB,CAAC,CAAC;KAChE;IAED,QAAQ,MAAK;IAEb,cAAc,CAAC,MAAiC,EAAE,aAAqB;QACrE,IAAI,CAAC,YAAY,GAAG,CAAC,CAAC,aAAa,CAAC;QAEpC,MAAM,YAAY,GAAG,IAAI,CAAC,aAAa,CAAC;QACxC,IAAI,YAAY,KAAK,OAAO,IAAI,IAAI,CAAC,aAAa,EAAE;YAClD,IAAI,CAAC,aAAa,CAAC,oBAAoB,CAAC,MAAM,CAAC,CAAC;SACjD;aAAM,IAAI,CAAC,YAAY,KAAK,SAAS,IAAI,IAAI,CAAC,YAAY,KAAK,IAAI,CAAC,eAAe,EAAE;YACpF,IAAI,CAAC,eAAe,CAAC,oBAAoB,CAAC,MAAM,CAAC,CAAC;SACnD;QAED,IAAI,IAAI,CAAC,eAAe,EAAE;YACxB,IAAI,CAAC,eAAe,CAAC,kBAAkB,CAAC,aAAa,CAAC,CAAC;SACxD;QAED,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;KAC1B;;8GArCU,iBAAiB;kGAAjB,iBAAiB,2PAUd,oBAAoB,gFACpB,kBAAkB,gDAftB,6BAA6B;2FAI5B,iBAAiB;kBAN7B,SAAS;+BACE,aAAa,YACb,6BAA6B,uBAElB,KAAK;yJAGqB,YAAY;sBAA1D,WAAW;uBAAC,gCAAgC;gBAKpC,aAAa;sBAArB,KAAK;gBAEG,YAAY;sBAApB,KAAK;gBAE8B,eAAe;sBAAlD,YAAY;uBAAC,oBAAoB;gBACA,aAAa;sBAA9C,YAAY;uBAAC,kBAAkB;;;MCpBrB,WAAW;;IAGtB,OAAO,UAAU,CAAC,OAAwB;QACxC,IAAI,GAAG,GAAG,IAAI,CAAC;QACf,IAAI,OAAO,OAAO,CAAC,KAAK,KAAK,QAAQ,IAAI,OAAO,CAAC,KAAK,CAAC,MAAM,KAAK,CAAC,IAAI,OAAO,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,MAAM,KAAK,CAAC,EAAE;YACxG,GAAG,GAAI,EAAE,YAAY,EAAE,IAAI,EAAE,CAAC;SAC/B;QACD,OAAO,GAAG,CAAC;KACZ;;;ACkFH;MACa,iBAAiB,GAAG;IAC/B,IAAI;IACJ,WAAW;IACX,SAAS;IACT,eAAe;IACf,UAAU;IACV,eAAe;IACf,aAAa;IACb,mBAAmB;EACnB;AAEF;MACa,kBAAkB,GAAG;IAChC,QAAQ,EAAE,UAAU,CAAC,QAAQ;IAC7B,SAAS,EAAE,UAAU,CAAC,SAAS;IAC/B,SAAS,EAAE,UAAU,CAAC,SAAS;IAC/B,GAAG,EAAE,UAAU,CAAC,GAAG;IACnB,GAAG,EAAE,UAAU,CAAC,GAAG;IACnB,YAAY,EAAE,UAAU,CAAC,YAAY;IACrC,KAAK,EAAE,UAAU,CAAC,KAAK;IACvB,OAAO,EAAE,UAAU,CAAC,OAAO;IAC3B,UAAU,EAAE,WAAW,CAAC,UAAU;;;MCtEd,6BAA6B;IA4DjD,YAAY,EAA4B,EAAE,MAAqC;;QA9CvE,mBAAc,GAA6B,OAAO,CAAC;;QAMnD,gBAAW,GAAG,KAAK,CAAC;QAIpB,kBAAa,GAAW,IAAI,CAAC;QAkC3B,uBAAkB,GAAG,IAAI,YAAY,EAAwB,CAAC;QAGtE,IAAI,CAAC,GAAG,GAAG,EAAE,CAAC;QACd,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC;KACvB;IA7BD,IAAI,MAAM,CAAC,GAAW;QACpB,IAAI,CAAC,OAAO,GAAG,GAAG,CAAC;QACnB,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;QAC3C,IAAI,CAAC,4BAA4B,CAAC,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;KAC5D;IAED,IAAI,MAAM;QACR,OAAO,IAAI,CAAC,OAAO,CAAC;KACrB;IAED,IAAW,YAAY;QACrB,OAAO,IAAI,CAAC,GAAG,IAAI,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,OAAO;cACvC,IAAI,CAAC,aAAa,KAAK,IAAI,CAAC,MAAM,IAAK,IAAI,CAAC,MAA8B,CAAC,OAAO,CAAC;cACnF,IAAI,CAAC;KACV;IAED,IAAW,YAAY,CAAC,GAAW;QACjC,IAAI,IAAI,CAAC,GAAG,IAAI,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,OAAO,EAAE;YACxC,IAAI,CAAC,aAAa,GAAG,GAAG,CAAC;SAC1B;aAAM;YACL,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC;SAC3B;KACF;IASD,IAAI,OAAO;QACT,OAAO,IAAI,CAAC,GAAG,CAAC,OAAO,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,OAAO,IAAI,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,OAAO,CAAC,GAAG,IAAI,CAAC;KAC1F;IAED,IAAI,OAAO;QACT,OAAO,IAAI,CAAC,GAAG,CAAC,OAAO,GAAG,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,OAAO,GAAG,IAAI,CAAC;KAC3D;;IAGD,IAAI,SAAS;QACX,MAAM,cAAc,GAAG,CAAC,iBAAiB,EAAE,eAAe,EAAE,eAAe,EAAE,aAAa,EAAE,mBAAmB,CAAC,CAAC;QACjH,MAAM,QAAQ,qBAAQ,IAAI,CAAC,MAAM,CAAE,CAAC;QACpC,cAAc,CAAC,OAAO,CAAC,CAAC,GAAG;YACzB,IAAI,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE;gBAC1C,QAAQ,CAAC,GAAG,CAAC,GAAG,QAAQ,CAAC,GAAG,CAAC,KAAK,SAAS,GAAG,QAAQ,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC;aAC3F;SACF,CAAC,CAAC;QACH,OAAO,QAAQ,CAAC;KACjB;IAED,IAAI,0BAA0B;QAC5B,MAAM,IAAI,GAAI,IAAI,CAAC,SAA2C,CAAC,iBAAiB,CAAC;QACjF,OAAO,IAAI,KAAK,SAAS,GAAG,GAAG,GAAG,IAAI,CAAC;KACxC;IAED,WAAW,CAAC,OAAsB;QAChC,IAAI,OAAO,IAAI,OAAO,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE;;YAEtC,IAAI,CAAC,MAAM,mCAAQ,IAAI,CAAC,YAAY,GAAK,IAAI,CAAC,uBAAuB,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,YAAY,CAAC,CAAE,CAAC;YACvG,IAAI,CAAC,kBAAkB,EAAE,CAAC;SAC3B;QAED,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;YACrB,IAAI,CAAC,uBAAuB,EAAE,CAAC;SAChC;KACF;IAEM,WAAW,CAAC,KAAqB;QACtC,IAAI,CAAC,MAAM,mCAAQ,IAAI,CAAC,YAAY,GAAK,IAAI,CAAC,uBAAuB,CAAC,KAAK,CAAC,CAAE,CAAC;QAC/E,IAAI,CAAC,kBAAkB,EAAE,CAAC;KAC3B;IAEM,cAAc,CAAC,KAAqB;QACzC,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,uBAAuB,CAAC,KAAK,CAAC,CAAC;KACzD;IAEM,kBAAkB;;QAEvB,IAAI,CAAC,+BAA+B,EAAE,CAAC;QACvC,IAAI,CAAC,kBAAkB,EAAE,CAAC;KAC3B;IACO,+BAA+B;QACrC,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC;QAEvB,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE;YAC/B,IAAI,IAAI,CAAC,MAAM,CAAC,UAAU,EAAE;gBAC1B,MAAM,UAAU,GAAkB,IAAI,CAAC,6BAA6B,CAAC,IAAI,CAAC,MAAM,CAAC,UAAU,CAAkB,CAAC;gBAC9G,IAAI,CAAC,iBAAiB,CAAC,UAAU,CAAC,CAAC;aACpC;YACD,IAAI,IAAI,CAAC,MAAM,CAAC,eAAe,EAAE;gBAC/B,MAAM,eAAe,GAAuB,IAAI,CAAC,6BAA6B,CAC5E,IAAI,CAAC,MAAM,CAAC,eAAe,EAC3B,IAAI,CACiB,CAAC;gBACxB,IAAI,CAAC,sBAAsB,CAAC,eAAe,CAAC,CAAC;aAC9C;SACF;aAAM;YACL,MAAM,UAAU,GAAkB,IAAI,CAAC,6BAA6B,CAAC,IAAI,CAAC,MAAM,CAAkB,CAAC;YACnG,IAAI,CAAC,iBAAiB,CAAC,UAAU,CAAC,CAAC;SACpC;QACD,IAAI,CAAC,uBAAuB,EAAE,CAAC;KAChC;IAEO,6BAA6B,CACnC,UAAkD,EAClD,KAAK,GAAG,KAAK;QAEb,MAAM,SAAS,GAAG,EAAE,CAAC;QACrB,UAAU,CAAC,OAAO,CAAC,CAAC,aAA4B;;YAE9C,MAAM,WAAW,GAAW,IAAI,CAAC,kBAAkB,CAAC,aAAa,CAAC,CAAC;YACnE,IAAI,SAAS,GAAG,IAAI,CAAC;YAErB,IAAI,CAAC,WAAW,EAAE;;aAEjB;YAED,IAAI,WAAW,IAAI,kBAAkB,EAAE;gBACrC,SAAS,GAAG,IAAI,CAAC,+BAA+B,CAAC,WAAW,EAAE,aAAa,CAAC,WAAW,CAAC,CAAC,CAAC;aAC3F;iBAAM;gBACL,IAAI,OAAO,aAAa,CAAC,WAAW,CAAC,KAAK,QAAQ,EAAE;oBAClD,SAAS,GAAG,aAAa,CAAC,SAAS,CAAC;iBACrC;qBAAM;oBACL,SAAS,GAAG,aAAa,CAAC,WAAW,CAAC,CAAC;iBACxC;gBACD,IAAI,CAAC,aAAa,CAAC,aAAa,EAAE;oBAChC,IAAI,CAAC,KAAK,EAAE;wBACV,SAAS,GAAG,IAAI,CAAC,2BAA2B,CAAC,WAAW,EAAE,SAAS,EAAE,aAAa,CAAC,OAAO,CAAC,CAAC;qBAC7F;yBAAM;wBACL,SAAS,GAAG,IAAI,CAAC,gCAAgC,CAAC,WAAW,EAAE,SAAS,EAAE,aAAa,CAAC,OAAO,CAAC,CAAC;qBAClG;iBACF;aACF;YAED,IAAI,SAAS,EAAE;gBACb,IAAI,KAAK,IAAI,IAAI,CAAC,0BAA0B,EAAE;oBAC5C,MAAM,YAAY,GAAG,SAAS,CAAC;oBAC/B,SAAS,GAAG,CAAC,OAAwB;wBACnC,OAAO,KAAK,CAAC,IAAI,CAAC,0BAA0B,CAAC,CAAC,IAAI,CAChD,SAAS,CAAC;4BACR,OAAO,YAAY,CAAC,OAAO,CAAC,CAAC;yBAC9B,CAAC,CACH,CAAC;qBACH,CAAC;iBACH;gBACD,SAAS,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;gBAC1B,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,GAAG,aAAa,CAAC;aAChD;;;;SAIF,CAAC,CAAC;QACH,OAAO,SAA+C,CAAC;KACxD;IAEO,uBAAuB,CAAC,KAAqB;QACnD,IAAI,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE;YACxB,OAAO;gBACL,UAAU,EAAE,KAAK;aAClB,CAAC;SACH;QAED,OAAO,KAAK,CAAC;KACd;IAEO,yBAAyB,CAAC,aAA4B;QAC5D,KAAK,MAAM,GAAG,IAAI,kBAAkB,EAAE;YACpC,IAAI,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,aAAa,EAAE,GAAG,CAAC,EAAE;gBAC5D,OAAO,EAAE,EAAE,EAAE,GAAG,EAAE,WAAW,EAAE,IAAI,CAAC,+BAA+B,CAAC,GAAG,EAAE,aAAa,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC;aAChG;SACF;QACD,OAAO,IAAI,CAAC;KACb;IAEO,+BAA+B,CAAC,GAAG,EAAE,KAAK;QAChD,IAAI,OAAO,KAAK,KAAK,SAAS,IAAI,KAAK,EAAE;;YAEvC,OAAO,kBAAkB,CAAC,GAAG,CAAC,CAAC;SAChC;aAAM,IAAI,OAAO,KAAK,KAAK,SAAS,EAAE;YACrC,OAAO,kBAAkB,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,CAAC;SACvC;QACD,OAAO,IAAI,CAAC;KACb;IAEO,2BAA2B,CAAC,EAAE,EAAE,WAAW,EAAE,OAAO;QAC1D,OAAO,CAAC,OAAwB;YAC9B,MAAM,GAAG,GAAG,WAAW,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;YACvC,OAAO,IAAI,CAAC,8BAA8B,CAAC,EAAE,EAAE,GAAG,EAAE,OAAO,CAAC,CAAC;SAC9D,CAAC;KACH;IAEO,gCAAgC,CAAC,EAAE,EAAE,SAAS,EAAE,OAAO;QAC7D,OAAO,CAAC,OAAwB;YAC9B,OAAQ,SAAS,CAAC,OAAO,CAAC,KAAK,CAAyB,CAAC,IAAI,CAC3D,GAAG,CAAC,CAAC,GAAG;gBACN,OAAO,IAAI,CAAC,8BAA8B,CAAC,EAAE,EAAE,GAAG,EAAE,OAAO,CAAC,CAAC;aAC9D,CAAC,CACH,CAAC;SACH,CAAC;KACH;IAEO,8BAA8B,CAAC,EAAU,EAAE,GAA4B,EAAE,OAAe;QAC9F,IAAI,KAAK,GAAG,IAAI,CAAC;QACjB,IAAI,OAAO,GAAG,KAAK,SAAS,IAAI,CAAC,GAAG,EAAE;YACpC,KAAK,GAAG,EAAE,CAAC;YACX,KAAK,CAAC,EAAE,CAAC,GAAG,OAAO,CAAC;SACrB;aAAM,IAAI,OAAO,GAAG,KAAK,QAAQ,KAAK,GAAG,IAAI,OAAO,GAAG,KAAK,QAAQ,CAAC,EAAE;;YAEtE,KAAK,GAAG,EAAE,CAAC;YACX,KAAK,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC;SACjB;QACD,OAAO,KAAK,CAAC;KACd;IAEO,kBAAkB,CAAC,IAAwC;QACjE,KAAK,MAAM,GAAG,IAAI,IAAI,EAAE;YACtB,IAAI,EAAE,GAAG,IAAI,iBAAiB,CAAC,EAAE;gBAC/B,OAAO,GAAG,CAAC;aACZ;SACF;QACD,OAAO,IAAI,CAAC,EAAE,IAAI,IAAI,CAAC;KACxB;;IAGD,IAAI,WAAW;QACb,IAAI,IAAI,CAAC,cAAc,KAAK,OAAO,EAAE;YACnC,OAAO,IAAI,CAAC,GAAG,CAAC,OAAO,GAAG,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,OAAO,IAAI,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,KAAK,GAAG,KAAK,CAAC;SACtF;aAAM;YACL,OAAO,IAAI,CAAC,GAAG,CAAC,OAAO,GAAG,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,OAAO,GAAG,KAAK,CAAC;SAC5D;KACF;IAED,IAAI,SAAS;QACX,OAAO,IAAI,CAAC,WAAW,CAAC;KACzB;IAED,IAAI,UAAU;QACZ,IAAI,IAAI,CAAC,cAAc,KAAK,OAAO,EAAE;YACnC,OAAO,IAAI,CAAC,GAAG,CAAC,OAAO,GAAG,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,KAAK,GAAG,KAAK,CAAC;SAC1D;aAAM;YACL,OAAO,IAAI,CAAC;SACb;KACF;IAED,IAAI,aAAa;;QAEf,IAAI,IAAI,CAAC,MAAM,CAAC,eAAe,CAAC,KAAK,OAAO,EAAE;YAC5C,OAAO,IAAI,CAAC,GAAG,CAAC,OAAO,GAAG,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,KAAK,IAAI,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,KAAK,GAAG,KAAK,CAAC;SACpF;aAAM,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,eAAe,CAAC,EAAE;YACxC,OAAO,KAAK,CAAC;SACd;aAAM;YACL,OAAO,IAAI,CAAC,GAAG,CAAC,OAAO,GAAG,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,KAAK,GAAG,KAAK,CAAC;SAC1D;KACF;IAED,IAAI,aAAa;QACf,OAAO,IAAI,CAAC,QAAQ,GAAG,IAAI,GAAG,KAAK,CAAC;KACrC;IAED,IAAI,OAAO;QACT,OAAO,IAAI,CAAC,GAAG,CAAC,OAAO,GAAG,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,OAAO,GAAG,KAAK,CAAC;KAC5D;IAEO,uBAAuB;QAC7B,IAAI,IAAI,CAAC,GAAG,IAAI,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE;YAChC,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,aAAa,CAAC,SAAS,CAAC,CAAC,MAAM;gBAC9C,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;gBAC3C,IAAI,CAAC,aAAa,EAAE,CAAC;gBACrB,IAAI,CAAC,4BAA4B,CAAC,MAAM,CAAC,CAAC;aAC3C,CAAC,CAAC;YACH,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;SACzB;KACF;IAEO,YAAY,CAAC,MAA8B;QACjD,IAAI,CAAC,MAAM,EAAE;YACX,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC;SAC3B;aAAM;;YAEL,MAAM,EAAE,KAAK,EAAE,OAAO,EAAE,GAAG,IAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,CAAC;YAC1D,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,CAAC;YACtD,IAAI,CAAC,aAAa;gBAChB,OAAO;qBACN,OAAO,CAAC,OAAO;wBACd,IAAI,CAAC,yBAAyB,CAAC,MAAM,EAAE,KAAK,CAAC;wBAC7C,IAAI,CAAC,uBAAuB,CAAC,OAAO,EAAE,KAAK,CAAC;wBAC3C,IAAI,CAAC,MAA8B,CAAC,OAAO,CAAC,CAAC;SACnD;QAED,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC;YAC3B,SAAS,EAAE,IAAI,CAAC,SAAS;YACzB,YAAY,EAAE,IAAI,CAAC,aAAa;YAChC,MAAM,EAAE,MAAM;SACf,CAAC,CAAC;KACJ;IAEO,uBAAuB,CAAC,IAAI,EAAE,EAAE;QACtC,OAAO,IAAI,IAAI,IAAI,CAAC,EAAE,CAAC,IAAI,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,IAAI,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC;KACrF;IAEO,iBAAiB,CAAC,IAAK;QAC7B,OAAO,CAAC,IAAI,IAAI,IAAI,CAAC,aAAa,KAAK,IAAI,CAAC,MAAM,CAAC,eAAe,CAAC,IAAI,OAAO,CAAC;KAChF;IAEO,yBAAyB,CAAC,MAA8B,EAAE,EAAU;QAC1E,IAAI,MAAM,CAAC,EAAE,CAAC,IAAI,OAAO,MAAM,CAAC,EAAE,CAAC,KAAK,QAAQ,EAAE;YAChD,OAAO,MAAM,CAAC,EAAE,CAAC,CAAC;SACnB;aAAM,IAAI,MAAM,CAAC,EAAE,CAAC,IAAI,OAAO,MAAM,CAAC,EAAE,CAAC,KAAK,QAAQ,KAAK,MAAM,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,MAAM,CAAC,EAAE,CAAC,CAAC,SAAS,CAAC,CAAC,EAAE;YAC7G,OAAO,MAAM,CAAC,EAAE,CAAC,CAAC;SACnB;aAAM;YACL,OAAO,IAAI,CAAC;SACb;KACF;IAEO,iBAAiB,CAAC,MAA8B;;QAEtD,IAAI,KAAa,CAAC;QAClB,IAAI,OAAO,GAAG,IAAI,CAAC;QACnB,KAAK,MAAM,GAAG,IAAI,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE;YACrC,IAAI,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,EAAE;gBAC1B,IAAI,OAAO,EAAE;oBACX,MAAM,QAAQ,GAAG,OAAO,CAAC,QAAQ,IAAI,CAAC,CAAC;oBACvC,IAAI,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC,QAAQ,IAAI,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC,QAAQ,GAAG,QAAQ,EAAE;wBACjF,KAAK,GAAG,GAAG,CAAC;wBACZ,OAAO,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC;qBAClC;iBACF;qBAAM;oBACL,KAAK,GAAG,GAAG,CAAC;oBACZ,OAAO,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC;iBAClC;aACF;SACF;QACD,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC;KAC3C;IAED,aAAa;QACX,IAAI,IAAI,CAAC,OAAO,EAAE;;SAEjB;KACF;IAEO,kBAAkB;QACxB,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,OAAO,IAAI,CAAC,MAAM,KAAK,QAAQ,IAAI,IAAI,CAAC,MAAM,CAAC,QAAQ,EAAE;YACzF,IAAI,CAAC,GAAG,CAAC,OAAe,CAAC,SAAS,GAAG,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC;SAC5D;KACF;IAEM,uBAAuB;QAC5B,IAAI,IAAI,CAAC,GAAG,IAAI,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE;YAChC,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,sBAAsB,EAAE,CAAC;SAC3C;KACF;IAEO,iBAAiB,CAAC,YAAgD;QACxE,IAAI,IAAI,CAAC,GAAG,IAAI,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE;YAChC,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,aAAa,CAAC,YAAY,CAAC,CAAC;SAC9C;KACF;IAEO,sBAAsB,CAAC,YAA0D;QACvF,IAAI,IAAI,CAAC,GAAG,IAAI,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE;YAChC,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,kBAAkB,CAAC,YAAY,CAAC,CAAC;SACnD;KACF;;0HA9YmB,6BAA6B,4DA4DC,6BAA6B;8GA5D3D,6BAA6B;2FAA7B,6BAA6B;kBADlD,SAAS;mGA6D0C,6BAA6B,0BAFrE,kBAAkB;sBAA3B,MAAM;;AAyVT,MAAM,uBAAuB,GAAG;IAC9B,qBAAqB,EAAE,aAAa;IACpC,uBAAuB,EAAE,eAAe;IACxC,uBAAuB,EAAE,eAAe;CACzC,CAAC;MASW,gCAAgC,6BAA6B;IAMxE,YAAoB,EAAoB,EAAkC,SAAkC,EAAU,IAAiB;QACrI,KAAK,CAAC,EAAE,EAAE,SAAS,CAAC,CAAC;QAD+F,SAAI,GAAJ,IAAI,CAAa;QAJ7H,uBAAkB,GAAsB,IAAI,YAAY,EAAO,CAAC;QAElE,aAAQ,GAAG,IAAI,OAAO,EAAE,CAAC;KAIhC;IAED,QAAQ;QACN,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC,IAAI,CAAC;QACjD,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC,MAAM,CAAC;QAE7C,IAAI,CAAC,IAAI;aACN,UAAU,EAAE;aACZ,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;aAC9B,SAAS,CAAC,CAAC,IAAmB;YAC7B,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,IAAI,CAAC;YAC9B,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;SAC3B,CAAC,CAAC;KACN;IAED,WAAW;QACT,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC;QACrB,IAAI,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAC;KAC1B;IAED,sBAAsB,CAAC,GAAW;QAChC,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE;YACtB,IAAI,CAAC,YAAY,GAAG,GAAG,CAAC;SACzB;KACF;IAED,4BAA4B,CAAC,MAAW;;KAEvC;;oHApCU,uBAAuB,gEAMmD,uBAAuB;wGANjG,uBAAuB;2FAAvB,uBAAuB;kBAPnC,SAAS;mBAAC;oBACT,QAAQ,EAAE;oGACwF;;oBAElG,IAAI,EAAE,uBAAuB;oBAC7B,QAAQ,EAAE,gBAAgB;iBAC3B;;;8BAOc,IAAI;kCAAoE,uBAAuB;8BAAjE,QAAQ;;8BAAI,IAAI;;8BAAI,QAAQ;;yBAL9C,KAAK;sBAA7B,KAAK;uBAAC,gBAAgB;gBACb,kBAAkB;sBAA3B,MAAM;;MA2CI,kCAAkC,6BAA6B;IAkB1E,YACQ,EAAa,EACe,SAA4B,EACxB,SAAkC,EAC1D,IAAiB,EAClB,iBAA6B,EAC5B,mBAAwC,EACxC,wBAAkD;QAEhE,KAAK,CAAC,EAAE,EAAE,SAAS,CAAC,CAAC;QAPa,cAAS,GAAT,SAAS,CAAmB;QAEhD,SAAI,GAAJ,IAAI,CAAa;QAClB,sBAAiB,GAAjB,iBAAiB,CAAY;QAC5B,wBAAmB,GAAnB,mBAAmB,CAAqB;QACxC,6BAAwB,GAAxB,wBAAwB,CAA0B;QAvBxD,uBAAkB,GAAsB,IAAI,YAAY,EAAO,CAAC;QAKlE,aAAQ,GAAG,IAAI,OAAO,EAAE,CAAC;KAqBhC;IAlBD,IAAI,QAAQ;QACV,OAAQ,IAAI,CAAC,SAAyC,CAAC,eAAe,IAAI,SAAS,CAAC;KACrF;IAED,IAAI,WAAW;QACb,OAAQ,IAAI,CAAC,SAAkC,CAAC,WAAW,IAAI,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC;KACpF;IAcD,QAAQ;QACN,IAAI,CAAC,WAAW,EAAE,CAAC;QACnB,IAAI,CAAC,oBAAoB,EAAE,CAAC;KAC7B;IAED,WAAW;QACT,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC,IAAI,CAAC;QACjD,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC,MAAM,CAAC;QAE7C,IAAI,CAAC,IAAI;aACN,UAAU,EAAE;aACZ,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;aAC9B,SAAS,CAAC,CAAC,IAAmB;YAC7B,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,IAAI,CAAC;YAC9B,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;SAC3B,CAAC,CAAC;KACN;IAED,oBAAoB;QAClB,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,iBAAiB,CAAC,aAAa,EAAE,SAAS,CAAC,EAAE,SAAS,CAAC,IAAI,CAAC,iBAAiB,CAAC,aAAa,EAAE,UAAU,CAAC,CAAC;aAC3H,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;aAC9B,SAAS,CAAC,CAAC,KAAY;YACtB,IAAI,KAAK,CAAC,IAAI,KAAK,SAAS,EAAE;gBAC5B,IAAI,CAAC,cAAc,EAAE,CAAC;aACvB;YACD,IAAI,KAAK,CAAC,IAAI,KAAK,UAAU,EAAE;gBAC7B,IAAI,CAAC,cAAc,EAAE,CAAC;aACvB;SACF,CAAC,CAAC;KACN;IAED,oBAAoB,CAAC,MAAM,EAAE,OAAe;QAC1C,IAAI,IAAI,CAAC,SAAS,EAAE;YAClB,IAAI,CAAC,SAAS,CAAC,cAAc,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC;SAChD;KACF;IAED,iBAAiB,CAAC,MAA0B,EAAE,OAAe;QAC3D,IAAI,CAAC,UAAU,GAAG,MAAM,KAAK,OAAO,GAAG,OAAO,GAAG,IAAI,CAAC;QACtD,IAAI,IAAI,CAAC,mBAAmB,EAAE;YAC5B,IAAI,CAAC,cAAc,EAAE,CAAC;YACtB,IAAI,CAAC,cAAc,EAAE,CAAC;SACvB;KACF;IAED,4BAA4B,CAAC,MAAW;QACtC,IAAI,aAAa,GAAG,IAAI,CAAC;QACzB,IAAI,OAAO,GAAG,IAAI,CAAC;QACnB,IAAI,IAAI,CAAC,UAAU,EAAE;YACnB,CAAC,aAAa,EAAE,OAAO,CAAC,GAAG,IAAI,CAAC,8BAA8B,CAAC,MAAM,CAAC,CAAC;SACxE;;QAGD,IAAI,OAAO,IAAI,OAAO,OAAO,KAAK,QAAQ,EAAE;YAC1C,OAAO,GAAG,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,OAAO,CAAC,SAAS,CAAC,IAAI,IAAI,CAAC;SAC9D;QAED,IAAI,IAAI,CAAC,QAAQ,KAAK,SAAS,EAAE;YAC/B,IAAI,CAAC,iBAAiB,CAAC,aAAa,EAAE,OAAO,CAAC,CAAC;YAC/C,IAAI,CAAC,oBAAoB,CAAC,aAAa,EAAE,IAAI,CAAC,CAAC;SAChD;aAAM,IAAI,IAAI,CAAC,QAAQ,KAAK,MAAM,EAAE;YACnC,IAAI,CAAC,oBAAoB,CAAC,aAAa,EAAE,OAAO,CAAC,CAAC;SACnD;KACF;IAED,8BAA8B,CAAC,QAAa;QAC1C,IAAI,MAAM,GAAG,IAAI,CAAC;QAClB,IAAI,OAAO,GAAG,IAAI,CAAC;QACnB,IAAI,QAAQ,KAAK,SAAS,EAAE;YAC1B,MAAM,GAAG,OAAO,CAAC;YACjB,OAAO,GAAG,IAAI,CAAC,YAAY,CAAC;SAC7B;aAAM,IAAI,QAAQ,KAAK,SAAS,EAAE;YACjC,MAAM,GAAG,SAAS,CAAC;SACpB;aAAM,IAAI,QAAQ,KAAK,OAAO,EAAE;YAC/B,MAAM,GAAG,SAAS,CAAC;SACpB;QACD,OAAO,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC;KAC1B;IAED,aAAa,CAAC,IAAyB,EAAE,OAAe;;QACtD,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,mBAAmB,CAAC,eAAe,CACjE,IAAI,CAAC,wBAAwB,CAAC,uBAAuB,CAAC,gBAAgB,CAAC,CACxE,CAAC;QACF,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,mBAAmB,CAAC,QAAQ,EAAE;YAC/C,OAAO,EAAE,OAAO;YAChB,iBAAiB,EAAE,IAAI,CAAC,iBAAiB;YACzC,QAAQ,EAAE,IAAI,CAAC,WAAW;YAC1B,OAAO,EAAE,IAAI;YACb,WAAW,EAAE,CAAA,MAAA,IAAI,CAAC,SAAS,0CAAE,WAAW,KAAI,GAAG;YAC/C,YAAY,EAAE,IAAI;YAClB,MAAM,EAAE,CAAA,MAAA,IAAI,CAAC,SAAS,0CAAE,MAAM,KAAI,IAAI;SACvC,CAAC,CAAC;KACJ;IAEM,cAAc;QACnB,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC;QACvC,IAAI,IAAI,CAAC,UAAU,EAAE;YACnB,IAAI,CAAC,oBAAoB,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;SACvC;KACF;IAEM,cAAc;QACnB,IAAI,CAAC,OAAO,EAAE,CAAC;QACf,IAAI,IAAI,CAAC,UAAU,EAAE;YACnB,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,SAAS,GAAG,OAAO,GAAG,IAAI,EAAE,IAAI,CAAC,CAAC;SAClE;KACF;IAED,OAAO,CAAC,IAAI,EAAE,OAAO;QACnB,IAAI,CAAC,OAAO,EAAE,CAAC;QACf,IAAI,CAAC,aAAa,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;KACnC;IAED,OAAO;QACL,IAAI,IAAI,CAAC,mBAAmB,EAAE;YAC5B,IAAI,CAAC,UAAU,EAAE,CAAC;SACnB;KACF;IAED,UAAU;QACR,IAAI,IAAI,CAAC,mBAAmB,EAAE;YAC5B,IAAI,CAAC,mBAAmB,CAAC,OAAO,EAAE,CAAC;YACnC,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC;SACjC;KACF;IAED,WAAW;QACT,IAAI,CAAC,UAAU,EAAE,CAAC;QAClB,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC;QACrB,IAAI,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAC;KAC1B;;sHAhKU,yBAAyB,mHAqBe,uBAAuB;0GArB/D,yBAAyB;2FAAzB,yBAAyB;kBANrC,SAAS;mBAAC;oBACT,QAAQ,EAAE,2FAA2F;;oBAErG,IAAI,EAAE,uBAAuB;oBAC7B,QAAQ,EAAE,gBAAgB;iBAC3B;;;8BAoBE,IAAI;;8BACI,QAAQ;;8BAAI,IAAI;kCAC0B,uBAAuB;8BAAjE,QAAQ;;8BAAI,IAAI;;8BAAI,QAAQ;;yBApBZ,KAAK;sBAA7B,KAAK;uBAAC,gBAAgB;gBACb,kBAAkB;sBAA3B,MAAM;gBAEsB,SAAS;sBAArC,KAAK;uBAAC,oBAAoB;;;ICzfjB;AAAZ,WAAY,UAAU;IACpB,uCAAyB,CAAA;IACzB,mCAAqB,CAAA;IACrB,iCAAmB,CAAA;AACrB,CAAC,EAJW,UAAU,KAAV,UAAU,QAIrB;MAMY,aAAa;IA6IxB,YAAgC,EAAoB,EAAsB,gBAAyC;QA5I1G,WAAM,GAAG,UAAU,CAAC,UAAU,CAAC;QAC/B,cAAS,GAAqB,EAAE,CAAC;QACjC,eAAU,GAA+B,OAAO,CAAC;QAOjD,iBAAY,GAAG,KAAK,CAAC;QAEpB,YAAO,GAAG,IAAI,YAAY,EAAE,CAAC;QAkIrC,IAAI,CAAC,GAAG,GAAG,EAAE,CAAC;QACd,IAAI,CAAC,iBAAiB,GAAG,gBAAgB,CAAC;KAC3C;IA9HD,IACI,gBAAgB;QAClB,OAAO,IAAI,CAAC,MAAM,KAAK,UAAU,CAAC,UAAU,CAAC;KAC9C;IAED,IACI,cAAc;QAChB,OAAO,IAAI,CAAC,MAAM,KAAK,UAAU,CAAC,QAAQ,CAAC;KAC5C;IAED,IACI,aAAa;QACf,OAAO,IAAI,CAAC,MAAM,KAAK,UAAU,CAAC,OAAO,CAAC;KAC3C;IAED,IACI,WAAW;QACb,OAAO,IAAI,CAAC,SAAS,KAAK,IAAI,CAAC;KAChC;IAED,IACI,WAAW;QACb,OAAO,IAAI,CAAC,SAAS,KAAK,IAAI,CAAC;KAChC;IAED,IACI,eAAe;QACjB,OAAO,IAAI,CAAC,UAAU,KAAK,OAAO,CAAC;KACpC;IAED,IACI,gBAAgB;QAClB,OAAO,IAAI,CAAC,UAAU,KAAK,QAAQ,CAAC;KACrC;IAED,IACI,aAAa;QACf,OAAO,IAAI,CAAC,UAAU,KAAK,KAAK,CAAC;KAClC;IAED,cAAc,CAAC,MAAO,EAAE,IAAU;QAChC,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE,CAAC,EAAmB;YAC5D,EAAE,CAAC,WAAW,EAAE,CAAC;YACjB,EAAE,CAAC,sBAAsB,EAAE,CAAC;SAC7B,CAAC,CAAC;;QAGH,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,aAAa;aAC3B,IAAI,CACH,SAAS,CAAC,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,MAAM,CAAC,EAClC,MAAM,CAAC,CAAC,MAAM;YACZ,OAAO,MAAM,KAAK,SAAS,CAAC;SAC7B,CAAC,EACF,IAAI,CAAC,CAAC,CAAC,CACR;aACA,SAAS,CAAC;YACT,IAAI,IAAI,CAAC,GAAG,EAAE;gBACX,IAAI,CAAC,GAAc,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;gBACtC,IAAI,IAAI,CAAC,iBAAiB,EAAE;oBAC1B,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC;wBAChB,KAAK,EAAE,IAAI,CAAC,iBAAiB,CAAC,OAAO;wBACrC,SAAS,EAAE,IAAI,CAAC,iBAAiB;wBACjC,IAAI,EAAE,IAAI;wBACV,MAAM,EAAE,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC;qBAC7C,CAAC,CAAC;iBACJ;qBAAM;oBACL,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC;wBAChB,KAAK,EAAE,IAAI,CAAC,GAAG,CAAC,KAAK;wBACrB,SAAS,EAAE,IAAI,CAAC,GAAG;wBACnB,IAAI,EAAE,IAAI;wBACV,MAAM,EAAE,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC;qBAC7C,CAAC,CAAC;iBACJ;aACF;YAED,IAAI,IAAI,CAAC,eAAe,EAAE;gBACxB,KAAK,MAAM,WAAW,IAAI,IAAI,CAAC,eAAe,EAAE;oBAC9C,IAAI,WAAW,CAAC,OAAO,IAAI,WAAW,CAAC,QAAQ,KAAK,SAAS,EAAE;wBAC7D,WAAW,CAAC,cAAc,EAAE,CAAC;wBAC7B,MAAM;qBACP;iBACF;aACF;SACF,CAAC,CAAC;KACN;IAED,aAAa;QACX,IAAI,IAAI,CAAC,GAAG,EAAE;YACX,IAAI,CAAC,GAAc,CAAC,OAAO,EAAE,CAAC;SAChC;QACD,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE,CAAC,EAAmB;YAC5D,EAAE,CAAC,cAAc,EAAE,CAAC;YACpB,EAAE,CAAC,sBAAsB,EAAE,CAAC;SAC7B,CAAC,CAAC;KACJ;IAEO,kBAAkB,CAAC,OAAwB,EAAE,UAA8C;QACjG,IAAI,OAAO,EAAE;YACX,UAAU,CAAC,OAAO,CAAC,CAAC;YACpB,MAAM,QAAQ,GAAI,OAAe,CAAC,QAAQ,CAAC;YAC3C,IAAI,QAAQ,EAAE;gBACZ,KAAK,MAAM,GAAG,IAAI,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE;oBACvC,IAAI,CAAC,kBAAkB,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE,UAAU,CAAC,CAAC;iBACpD;aACF;SACF;KACF;IAEO,aAAa,CAAC,OAAwB;QAC5C,MAAM,GAAG,GAAsC,EAAE,CAAC;QAClD,IAAI,OAAO,EAAE;YACX,GAAG,CAAC,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC;YAC5B,MAAM,QAAQ,GAAI,OAAe,CAAC,QAAQ,CAAC;YAC3C,IAAI,QAAQ,EAAE;gBACZ,KAAK,MAAM,GAAG,IAAI,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE;oBACvC,GAAG,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAC;iBAC9C;aACF;SACF;QAED,OAAO,GAAG,CAAC;KACZ;;0GA3IU,aAAa;8FAAb,aAAa,osBAgBP,yBAAyB;2FAhB/B,aAAa;kBAJzB,SAAS;mBAAC;oBACT,QAAQ,EAAE,SAAS;oBACnB,QAAQ,EAAE,OAAO;iBAClB;;;8BA8Ic,QAAQ;;8BAAI,IAAI;;8BAA0B,QAAQ;;8BAAI,IAAI;;yBA5I9D,MAAM;sBAAd,KAAK;gBACG,SAAS;sBAAjB,KAAK;gBACG,UAAU;sBAAlB,KAAK;gBAKG,aAAa;sBAArB,KAAK;gBAEG,YAAY;sBAApB,KAAK;gBAEI,OAAO;sBAAhB,MAAM;gBAI4D,eAAe;sBAAjF,eAAe;uBAAC,yBAAyB,EAAE,EAAE,WAAW,EAAE,IAAI,EAAE;gBAG7D,gBAAgB;sBADnB,WAAW;uBAAC,6BAA6B;gBAMtC,cAAc;sBADjB,WAAW;uBAAC,2BAA2B;gBAMpC,aAAa;sBADhB,WAAW;uBAAC,0BAA0B;gBAMnC,WAAW;sBADd,WAAW;uBAAC,qBAAqB;gBAM9B,WAAW;sBADd,WAAW;uBAAC,qBAAqB;gBAM9B,eAAe;sBADlB,WAAW;uBAAC,oCAAoC;gBAM7C,gBAAgB;sBADnB,WAAW;uBAAC,qCAAqC;gBAM9C,aAAa;sBADhB,WAAW;uBAAC,kCAAkC;;;MC7BpC,sBAAsB;IACjC,YAAY,UAAsB,EAAE,QAAmB;QACrD,QAAQ,CAAC,QAAQ,CAAC,UAAU,CAAC,aAAa,EAAE,sBAAsB,CAAC,CAAC;KACrE;IAED,QAAQ,MAAK;;mHALF,sBAAsB;uGAAtB,sBAAsB,wDAnBvB,2BAA2B;2FAmB1B,sBAAsB;kBArBlC,SAAS;mBAAC;oBACT,QAAQ,EAAE,kBAAkB;oBAC5B,QAAQ,EAAE,2BAA2B;oBACrC,MAAM,EAAE;wBACN;;;;;;;;;;;;KAYC;qBACF;oBACD,eAAe,EAAE,uBAAuB,CAAC,MAAM;oBAC/C,mBAAmB,EAAE,KAAK;iBAC3B;;MAYY,oBAAoB;;IAkB/B,YAAoB,UAAsB,EAA8B,MAAqB;QAAzE,eAAU,GAAV,UAAU,CAAY;QAA8B,WAAM,GAAN,MAAM,CAAe;QAjBrD,YAAO,GAAG,IAAI,CAAC;QAEvD,eAAU,GAAG,OAAO,CAAC;QAWb,aAAQ,GAAG,IAAI,OAAO,EAAE,CAAC;KAIgE;IAdjG,IACI,SAAS,CAAC,SAAS;QACrB,IAAI,SAAS,EAAE;YACb,IAAI,CAAC,UAAU,GAAG,SAAS,CAAC;YAC5B,IAAI,CAAC,aAAa,EAAE,CAAC;SACtB;KACF;IAUD,eAAe;QACb,IAAI,CAAC,aAAa,EAAE,CAAC;KACtB;IAED,WAAW;QACT,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC;QACrB,IAAI,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAC;KAC1B;IAED,aAAa;QACX,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC;QACrB,SAAS,CAAC,IAAI,CAAC,UAAU,CAAC,aAAa,EAAE,IAAI,CAAC,UAAU,CAAC;aACtD,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;aAC9B,SAAS,CAAC,CAAC,MAAM;YAChB,IAAI,IAAI,CAAC,MAAM,EAAE;gBACf,IAAI,CAAC,MAAM,CAAC,cAAc,CAAC,MAAM,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;aAC/C;SACF,CAAC,CAAC;KACN;;iHAtCU,oBAAoB;qGAApB,oBAAoB;2FAApB,oBAAoB;kBAHhC,SAAS;mBAAC;oBACT,QAAQ,EAAE,eAAe;iBAC1B;;;8BAmB8C,QAAQ;;8BAAI,IAAI;;yBAjBrB,OAAO;sBAA9C,WAAW;uBAAC,yBAAyB;gBAIlC,SAAS;sBADZ,KAAK;uBAAC,aAAa;gBAQM,IAAI;sBAA7B,KAAK;uBAAC,iBAAiB;;MAgCb,mBAAmB;IAgB9B,YAAoB,UAAsB,EAA8B,MAAqB;QAAzE,eAAU,GAAV,UAAU,CAAY;QAA8B,WAAM,GAAN,MAAM,CAAe;QAftD,YAAO,GAAG,IAAI,CAAC;;;QAItD,eAAU,GAAG,OAAO,CAAC;QASb,aAAQ,GAAG,IAAI,OAAO,EAAE,CAAC;KAEgE;IAVjG,IACI,SAAS,CAAC,SAAS;QACrB,IAAI,SAAS,EAAE;YACb,IAAI,CAAC,UAAU,GAAG,SAAS,CAAC;YAC5B,IAAI,CAAC,aAAa,EAAE,CAAC;SACtB;KACF;IAMD,eAAe;QACb,IAAI,CAAC,aAAa,EAAE,CAAC;KACtB;IAED,WAAW;QACT,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC;QACrB,IAAI,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAC;KAC1B;IAED,aAAa;QACX,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC;QACrB,SAAS,CAAC,IAAI,CAAC,UAAU,CAAC,aAAa,EAAE,IAAI,CAAC,UAAU,CAAC;aACtD,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;aAC9B,SAAS,CAAC;YACT,IAAI,IAAI,CAAC,MAAM,EAAE;gBACf,IAAI,CAAC,MAAM,CAAC,aAAa,EAAE,CAAC;aAC7B;SACF,CAAC,CAAC;KACN;;gHApCU,mBAAmB;oGAAnB,mBAAmB;2FAAnB,mBAAmB;kBAH/B,SAAS;mBAAC;oBACT,QAAQ,EAAE,cAAc;iBACzB;;;8BAiB8C,QAAQ;;8BAAI,IAAI;;yBAftB,OAAO;sBAA7C,WAAW;uBAAC,wBAAwB;gBAMjC,SAAS;sBADZ,KAAK;uBAAC,YAAY;;;AChGrB,SAAS,mBAAmB,KAAK,OAAO,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,EAAE;AAChE,MAAM,eAAe,GAAG,mBAAmB,EAAE,CAAC;MAEjC,oBAAoB;IAK/B;QACE,IAAI,CAAC,WAAW,GAAG,IAAI,GAAG,EAAE,CAAC;QAC7B,IAAI,CAAC,cAAc,GAAG,IAAI,GAAG,EAAE,CAAC;KACjC;IAED,UAAU,CAAC,GAAW,EAAE,EAAmB;QACzC,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE;YAC9B,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC;SAC/B;QACD,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;QACnC,IAAI,CAAC,uBAAuB,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC;KACvC;IAED,aAAa,CAAC,GAAW,EAAE,EAAmB;QAC5C,IAAI,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE;YAC7B,MAAM,QAAQ,GAAG,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;YAC3C,MAAM,KAAK,GAAG,QAAQ,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;YACnC,IAAI,KAAK,KAAK,CAAC,CAAC,EAAE;gBAChB,QAAQ,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;aAC3B;SACF;QACD,IAAI,CAAC,0BAA0B,CAAC,EAAE,CAAC,CAAC;KACrC;IAED,oBAAoB,CAAC,GAAW,EAAE,EAAmB;QACnD,MAAM,QAAQ,GAAG,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;QAE3C,IAAI,QAAQ,EAAE;YACZ,QAAQ,CAAC,OAAO,CAAC,OAAO;gBACtB,IAAI,CAAC,0BAA0B,CAAC,OAAO,CAAC,CAAC;aAC1C,CAAC,CAAC;YAEH,QAAQ,CAAC,OAAO,CAAC,OAAO;gBACtB,IAAI,OAAO,KAAK,EAAE,EAAE;oBAClB,eAAe,CAAC,IAAI,CAAC;wBACnB,OAAO,CAAC,sBAAsB,EAAE,CAAC;qBAClC,CAAC,CAAC;iBACJ;aACF,CAAC,CAAC;YAEH,QAAQ,CAAC,OAAO,CAAC,OAAO;gBACtB,eAAe,CAAC,IAAI,CAAC;oBACnB,IAAI,CAAC,uBAAuB,CAAC,GAAG,EAAE,OAAO,CAAC,CAAC;iBAC5C,CAAC,CAAC;aACJ,CAAC,CAAC;SACJ;KACF;IAED,uBAAuB,CAAC,GAAW,EAAE,EAAmB;QACtD,IAAI,CAAC,0BAA0B,CAAC,EAAE,CAAC,CAAC;QACpC,MAAM,GAAG,GAAG,EAAE,CAAC,YAAY,CAAC,SAAS,CAAC;YACpC,IAAI,CAAC,oBAAoB,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC;SACpC,CAAC,CAAC;QACH,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,EAAE,GAAG,CAAC,CAAC;KAClC;IAED,0BAA0B,CAAC,EAAmB;QAC5C,IAAI,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE;YAC/B,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,WAAW,EAAE,CAAC;YAC1C,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;SAChC;KACF;;iHAlEU,oBAAoB;qHAApB,oBAAoB,cADP,MAAM;2FACnB,oBAAoB;kBADhC,UAAU;mBAAC,EAAE,UAAU,EAAE,MAAM,EAAE;;;MCMrB,sBAAsB;IAMjC,YAA4B,GAAc,EAAU,WAAiC;QAAzD,QAAG,GAAH,GAAG,CAAW;QAAU,gBAAW,GAAX,WAAW,CAAsB;QAJ7E,WAAM,GAAG,KAAK,CAAC;KAIkE;IAEzF,WAAW;QACT,IAAI,IAAI,CAAC,GAAG,IAAI,IAAI,CAAC,GAAG,CAAC,OAAO,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE;YAChD,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC,IAAI,CAAC,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;YACxD,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;SACpB;KACF;IAED,WAAW;QACT,IAAI,IAAI,CAAC,GAAG,IAAI,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE;YAChC,IAAI,CAAC,WAAW,CAAC,aAAa,CAAC,IAAI,CAAC,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;SAC5D;KACF;;mHAnBU,sBAAsB;uGAAtB,sBAAsB;2FAAtB,sBAAsB;kBARlC,SAAS;mBAAC;oBACT,QAAQ,EAAE;;;GAGT;oBACD,QAAQ,EAAE,eAAe;iBAC1B;;;8BAQc,IAAI;;yBAFU,GAAG;sBAA7B,KAAK;uBAAC,kBAAkB;;;MCwBd,UAAU;;uGAAV,UAAU;wGAAV,UAAU,iBAbnB,iBAAiB;QACjB,kBAAkB;QAClB,oBAAoB;QACpB,sBAAsB;QACtB,aAAa;QACb,uBAAuB;QACvB,yBAAyB;QACzB,oBAAoB;QACpB,mBAAmB;QACnB,sBAAsB,aAvBd,YAAY,EAAE,mBAAmB,EAAE,WAAW,EAAE,aAAa,aAErE,iBAAiB;QACjB,kBAAkB;QAClB,oBAAoB;QACpB,sBAAsB;QACtB,aAAa;QACb,uBAAuB;QACvB,yBAAyB;QACzB,oBAAoB;QACpB,mBAAmB;QACnB,sBAAsB;wGAgBb,UAAU,aAFV,EAAE,YAzBJ,CAAC,YAAY,EAAE,mBAAmB,EAAE,WAAW,EAAE,aAAa,CAAC;2FA2B7D,UAAU;kBA5BtB,QAAQ;mBAAC;oBACR,OAAO,EAAE,CAAC,YAAY,EAAE,mBAAmB,EAAE,WAAW,EAAE,aAAa,CAAC;oBACxE,OAAO,EAAE;wBACP,iBAAiB;wBACjB,kBAAkB;wBAClB,oBAAoB;wBACpB,sBAAsB;wBACtB,aAAa;wBACb,uBAAuB;wBACvB,yBAAyB;wBACzB,oBAAoB;wBACpB,mBAAmB;wBACnB,sBAAsB;qBACvB;oBACD,YAAY,EAAE;wBACZ,iBAAiB;wBACjB,kBAAkB;wBAClB,oBAAoB;wBACpB,sBAAsB;wBACtB,aAAa;wBACb,uBAAuB;wBACvB,yBAAyB;wBACzB,oBAAoB;wBACpB,mBAAmB;wBACnB,sBAAsB;qBACvB;oBACD,SAAS,EAAE,EAAE;iBACd;;;ACvCD;;;;;;"}