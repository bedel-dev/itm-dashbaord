{"version":3,"file":"ng-devui-tags.mjs","sources":["../../devui/tags/tag.component.ts","../../devui/tags/tag.component.html","../../devui/tags/tags.component.ts","../../devui/tags/tags.component.html","../../devui/tags/tags.module.ts","../../devui/tags/ng-devui-tags.ts"],"sourcesContent":["import { Component, EventEmitter, Input, Output, TemplateRef } from '@angular/core';\n\nexport type ITagMode = 'default' | 'checkable' | 'closeable';\n\n@Component({\n  selector: 'd-tag',\n  templateUrl: './tag.component.html',\n  styleUrls: ['./tag.component.scss'],\n  exportAs: 'Tag',\n  preserveWhitespaces: false,\n})\nexport class TagComponent {\n  /**\n   * 【必选】记录输入的标签\n   */\n  @Input() tag: string;\n\n  @Input() labelStyle = '';\n\n  @Input() customColor = '';\n\n  // @deprecated\n  @Input() deletable = false;\n\n  @Input() titleContent: string;\n\n  @Input() mode: ITagMode = 'default';\n\n  @Input() checked = false;\n\n  @Input() maxWidth;\n\n  @Input() customViewTemplate: TemplateRef<any>;\n  /**\n   * tag被删除后触发\n   */\n  @Output() tagDelete = new EventEmitter<any>();\n\n  @Output() checkedChange = new EventEmitter<boolean>();\n\n  deleteTag = false;\n\n  colorMap = {\n    'blue-w98': '#3383ff',\n    'aqua-w98': '#39afcc',\n    'olivine-w98': '#2fa898',\n    'green-w98': '#4eb15e',\n    'yellow-w98': '#b08d1a',\n    'orange-w98': '#d47f35',\n    'red-w98': '#f66f6a',\n    'pink-w98': '#f3689a',\n    'purple-w98': '#a97af8',\n  };\n\n  get isColorfulTag(): boolean {\n    return !!(this.colorMap[this.labelStyle] || (this.customColor && this.customColor !== ''));\n  }\n\n  removeTag($event, tag) {\n    this.deleteTag = true;\n    this.tagDelete.emit({ tag: tag, event: $event });\n  }\n\n  tagClick() {\n    if (this.mode === 'checkable') {\n      this.checked = !this.checked;\n      this.checkedChange.emit(this.checked);\n    }\n  }\n}\n","<span\n  class=\"devui-tag-item {{ labelStyle }}\"\n  [style.display]=\"deleteTag ? 'none' : 'block'\"\n  [ngClass]=\"{\n    'devui-colorful-tag': isColorfulTag,\n    'devui-selected-tag': checked,\n    'devui-deletable-tag': mode === 'closeable' || deletable,\n    'devui-checkable-tag': mode === 'checkable'\n  }\"\n  [ngStyle]=\"{\n    'border-color': customColor,\n    'background-color': isColorfulTag ? (checked ? customColor : '') : '',\n    color: isColorfulTag ? (checked ? '#fff' : customColor) : '',\n    cursor: this.mode === 'checkable' ? 'pointer' : ''\n  }\"\n  title=\"{{ titleContent ? titleContent : tag }}\"\n  (click)=\"tagClick()\"\n>\n  <div class=\"content-wrapper\" [ngStyle]=\"{ 'background-color': colorMap[labelStyle] || customColor }\"></div>\n  <span *ngIf=\"!customViewTemplate\" [class.devui-max-width-tag]=\"maxWidth\" [style.maxWidth]=\"maxWidth ? maxWidth : ''\">{{ tag }}</span>\n  <ng-template *ngIf=\"customViewTemplate\" [ngTemplateOutlet]=\"customViewTemplate\" [ngTemplateOutletContext]=\"{ tag: tag }\"></ng-template>\n  <a\n    class=\"remove-button\"\n    [ngClass]=\"{ 'default-button': !isColorfulTag }\"\n    *ngIf=\"mode === 'closeable' || deletable\"\n    (click)=\"removeTag($event, tag)\"\n  >\n    <svg\n      *ngIf=\"isColorfulTag\"\n      width=\"12px\"\n      height=\"12px\"\n      viewBox=\"0 0 16 16\"\n      version=\"1.1\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n    >\n      <g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\n        <polygon\n          [ngStyle]=\"{ fill: isColorfulTag ? (checked ? '#fff' : customColor) : '' }\"\n          fill=\"#293040\"\n          fill-rule=\"nonzero\"\n          points=\"8 6.58578644 12.2426407 2.34314575 13.6568542 3.75735931 9.41421356 8 13.6568542 12.2426407 12.2426407 13.6568542 8 9.41421356 3.75735931 13.6568542 2.34314575 12.2426407 6.58578644 8 2.34314575 3.75735931 3.75735931 2.34314575\"\n        ></polygon>\n      </g>\n    </svg>\n    <svg\n      *ngIf=\"!isColorfulTag\"\n      width=\"12px\"\n      height=\"12px\"\n      viewBox=\"0 0 12 12\"\n      version=\"1.1\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n    >\n      <g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\n        <path\n          d=\"M8.86785321,3.13214679 C9.02624037,3.29053395 9.02624037,3.54733027 8.86785321,3.70571743 L6.573,6 L8.86785321,8.29428257 C9.02624037,8.45266973 9.02624037,8.70946605 8.86785321,8.86785321 C8.70946605,9.02624037 8.45266973,9.02624037 8.29428257,8.86785321 L6,6.573 L3.70571743,8.86785321 C3.54733027,9.02624037 3.29053395,9.02624037 3.13214679,8.86785321 C2.97375963,8.70946605 2.97375963,8.45266973 3.13214679,8.29428257 L5.427,6 L3.13214679,3.70571743 C2.97375963,3.54733027 2.97375963,3.29053395 3.13214679,3.13214679 C3.29053395,2.97375963 3.54733027,2.97375963 3.70571743,3.13214679 L6,5.427 L8.29428257,3.13214679 C8.45266973,2.97375963 8.70946605,2.97375963 8.86785321,3.13214679 Z\"\n          fill-rule=\"nonzero\"\n        ></path>\n      </g>\n    </svg>\n  </a>\n</span>\n","import {\n  AfterViewInit,\n  ChangeDetectorRef,\n  Component,\n  ContentChild,\n  ElementRef,\n  EventEmitter,\n  Input,\n  OnChanges,\n  OnInit,\n  Output,\n  QueryList,\n  SimpleChanges,\n  TemplateRef,\n  ViewChild,\n  ViewChildren\n} from '@angular/core';\nimport { ITagMode } from './tag.component';\n\n@Component({\n  selector: 'd-tags',\n  templateUrl: './tags.component.html',\n  styleUrls: ['./tags.component.scss'],\n  exportAs: 'Tags',\n  preserveWhitespaces: false,\n})\nexport class TagsComponent implements OnInit, AfterViewInit, OnChanges {\n  /**\n   * 【必选】记录输入的标签\n   */\n  @Input() tags = [];\n  /**\n   * 【可选】使用的属性名\n   */\n  @Input() displayProperty = '';\n\n  /**\n   * @deprecated\n   */\n  @Input() deletable = false;\n  @Input() mode: ITagMode = 'default';\n  @Input() titleProperty = '';\n  @Input() hideBeyondTags = false;\n  @ContentChild(TemplateRef) customViewTemplate: TemplateRef<any>;\n  @ViewChild('tagsElement') tagsElement: ElementRef;\n  @ViewChildren('tagElement', { read: ElementRef }) viewChildren!: QueryList<ElementRef>;\n  /**\n   * tag被删除后触发\n   */\n  @Output() tagDelete = new EventEmitter<any>();\n\n  /**\n   * 多标签超出显示相关数据\n   */\n  showTags = [];\n  beyondTags = [];\n  showMore = false;\n  maxShowNumber: number;\n  tagsFatherWidth: number;\n  MORE_TAG_WIDTH = 30;\n  TAG_MARGIN = 4;\n\n  constructor(private cdr: ChangeDetectorRef) {}\n\n  ngOnInit() {\n    this.maxShowNumber = this.tags.length;\n    // TODO: 使用cloneDeep导致category-search卡顿，lodash-es报Illegal invocation非法调用错误，需调查原因，暂用循环方式替代深拷贝\n    this.tags.forEach((item) => this.showTags.push(typeof item === 'object' ? { ...item } : item));\n  }\n\n  ngAfterViewInit() {\n    if (this.hideBeyondTags) {\n      this.calculateHideTagsStatus();\n    }\n  }\n\n  ngOnChanges(changes: SimpleChanges) {\n    if(this.hideBeyondTags && changes['tags'] && !changes['tags'].firstChange) {\n      this.maxShowNumber = this.tags.length;\n      this.showTags = [...this.tags];\n      this.calculateHideTagsStatus();\n    }\n  }\n\n  calculateHideTagsStatus() {\n    this.cdr.detectChanges();\n    this.tagsFatherWidth = this.tagsElement.nativeElement.getBoundingClientRect().width;\n    let curWidth = 0;\n    this.viewChildren.forEach((element, index) => {\n      if (curWidth + element.nativeElement.offsetWidth + this.TAG_MARGIN < this.tagsFatherWidth - this.MORE_TAG_WIDTH) {\n        curWidth += element.nativeElement.offsetWidth;\n        curWidth += this.TAG_MARGIN;\n        this.maxShowNumber = index + 1;\n      }\n    });\n    if (this.maxShowNumber !== this.tags.length) {\n      this.showMore = true;\n      this.beyondTags = this.showTags.slice(this.maxShowNumber);\n      this.showTags.splice(this.maxShowNumber);\n      this.cdr.detectChanges();\n    } else {\n      this.showMore = false;\n    }\n  }\n\n  removeTag($event, tag, index) {\n    this.tagDelete.emit({ tag: tag, index: index, event: $event });\n  }\n}\n","<div class=\"devui-tags\" #tagsElement>\n  <d-tag\n    #tagElement\n    *ngFor=\"let tag of hideBeyondTags ? showTags : tags; let index = index\"\n    [tag]=\"displayProperty ? tag[displayProperty] : tag\"\n    [mode]=\"mode\"\n    [deletable]=\"deletable\"\n    [checked]=\"tag['checked']\"\n    [labelStyle]=\"tag['labelStyle']\"\n    [customColor]=\"tag['customColor']\"\n    [titleContent]=\"titleProperty ? tag[titleProperty] : displayProperty ? tag[displayProperty] : tag\"\n    [customViewTemplate]=\"customViewTemplate\"\n    (tagDelete)=\"removeTag($event, tag, index)\"\n  >\n  </d-tag>\n  <d-tag\n    *ngIf=\"hideBeyondTags && showMore\"\n    dPopover\n    [content]=\"beyondTagsTpl\"\n    [controlled]=\"true\"\n    [tag]=\"'+ ' + beyondTags.length\"\n    [mode]=\"'checkable'\"\n    [popoverStyle]=\"{ backgroundColor: 'white', color: 'black' }\"\n  ></d-tag>\n</div>\n\n<ng-template #beyondTagsTpl>\n  <div class=\"beyond-tags-wrapper\">\n    <d-tag\n      class=\"beyond-tag-style\"\n      *ngFor=\"let tag of beyondTags; let index = index\"\n      [tag]=\"displayProperty ? tag[displayProperty] : tag\"\n      [mode]=\"mode\"\n      [deletable]=\"deletable\"\n      [checked]=\"tag['checked']\"\n      [labelStyle]=\"tag['labelStyle']\"\n      [customColor]=\"tag['customColor']\"\n      [titleContent]=\"titleProperty ? tag[titleProperty] : displayProperty ? tag[displayProperty] : tag\"\n      [customViewTemplate]=\"customViewTemplate\"\n      (tagDelete)=\"removeTag($event, tag, index)\"\n    >\n    </d-tag>\n  </div>\n</ng-template>\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { FormsModule } from '@angular/forms';\nimport { PopoverModule } from 'ng-devui/popover';\nimport { TagComponent } from './tag.component';\nimport { TagsComponent } from './tags.component';\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    PopoverModule\n  ],\n  exports: [\n    TagsComponent,\n    TagComponent\n  ],\n  declarations: [\n    TagsComponent,\n    TagComponent\n  ]\n})\nexport class TagsModule { }\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":[],"mappings":"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"}